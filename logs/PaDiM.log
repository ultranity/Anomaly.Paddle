Namespace(arch='resnet18', batch_size=32, category='all', crop_size=256, data_path='D:/dataset/mvtec_anomaly_detection', eval_PRO=True, inc=False, k=100, method='sample', save_model=False, save_path='./output/sample_resnet18_100', save_pic=True, seed=521, val=True)
W0418 10:07:29.883507 23024 device_context.cc:447] Please NOTE: device: 0, GPU Compute Capability: 6.1, Driver API Version: 11.2, Runtime API Version: 10.2
W0418 10:07:29.898463 23024 device_context.cc:465] device: 0, cuDNN Version: 7.6.
Training model 0/15 for carpet
| feature extraction | train | carpet |: 100%|█████████████████████████████████████████| 9/9 [00:21<00:00,  2.37s/it] 
2022-04-18 10:07:56     Train ends, total 22.37s
2022-04-18 10:07:56     Starting eval model...
| feature extraction | test | carpet |: 100%|██████████████████████████████████████████| 4/4 [00:11<00:00,  2.77s/it] 
 29%|██████████████████████▍                                                       | 144/500 [00:26<01:06,  5.39it/s]
['carpet', 0.9931781701444623, 0.9914826533749493, 0.9652811141271532]
Training model 1/15 for grid
| feature extraction | train | grid |: 100%|███████████████████████████████████████████| 9/9 [00:10<00:00,  1.13s/it] 
2022-04-18 10:08:55     Train ends, total 11.01s
2022-04-18 10:08:55     Starting eval model...
| feature extraction | test | grid |: 100%|████████████████████████████████████████████| 3/3 [00:04<00:00,  1.49s/it] 
 79%|█████████████████████████████████████████████████████████████▎                | 393/500 [00:46<00:12,  8.53it/s]
['grid', 0.8796992481203008, 0.9388008123792013, 0.885790167080454]
Training model 2/15 for leather
| feature extraction | train | leather |: 100%|████████████████████████████████████████| 8/8 [00:14<00:00,  1.82s/it] 
2022-04-18 10:10:07     Train ends, total 15.42s
2022-04-18 10:10:07     Starting eval model...
| feature extraction | test | leather |: 100%|█████████████████████████████████████████| 4/4 [00:11<00:00,  2.76s/it] 
 40%|███████████████████████████████▎                                              | 201/500 [00:41<01:01,  4.82it/s]
['leather', 1.0, 0.9916527138429438, 0.98118993684822]
Training model 3/15 for tile
| feature extraction | train | tile |: 100%|███████████████████████████████████████████| 8/8 [00:15<00:00,  1.95s/it] 
2022-04-18 10:11:26     Train ends, total 16.53s
2022-04-18 10:11:26     Starting eval model...
| feature extraction | test | tile |: 100%|████████████████████████████████████████████| 4/4 [00:10<00:00,  2.60s/it] 
 51%|███████████████████████████████████████▉                                      | 256/500 [00:58<00:55,  4.38it/s]
['tile', 0.9588744588744589, 0.9029669045124025, 0.8134730927352972]
Training model 4/15 for wood
| feature extraction | train | wood |: 100%|███████████████████████████████████████████| 8/8 [00:18<00:00,  2.25s/it] 
2022-04-18 10:13:04     Train ends, total 18.87s
2022-04-18 10:13:04     Starting eval model...
| feature extraction | test | wood |: 100%|████████████████████████████████████████████| 3/3 [00:07<00:00,  2.46s/it] 
 26%|████████████████████▎                                                         | 130/500 [00:16<00:47,  7.87it/s]
['wood', 0.986842105263158, 0.9405420216191457, 0.9173268811729494]
Training model 5/15 for bottle
| feature extraction | train | bottle |: 100%|█████████████████████████████████████████| 7/7 [00:10<00:00,  1.45s/it] 
2022-04-18 10:13:46     Train ends, total 11.05s
2022-04-18 10:13:46     Starting eval model...
| feature extraction | test | bottle |: 100%|██████████████████████████████████████████| 3/3 [00:05<00:00,  1.92s/it] 
 44%|██████████████████████████████████▍                                           | 221/500 [00:31<00:40,  6.95it/s]
['bottle', 0.9968253968253968, 0.9843018234792479, 0.9566680556320795]
Training model 6/15 for cable
| feature extraction | train | cable |: 100%|██████████████████████████████████████████| 7/7 [00:16<00:00,  2.40s/it] 
2022-04-18 10:14:47     Train ends, total 17.76s
2022-04-18 10:14:47     Starting eval model...
| feature extraction | test | cable |: 100%|███████████████████████████████████████████| 5/5 [00:13<00:00,  2.69s/it] 
 59%|██████████████████████████████████████████████▎                               | 297/500 [01:07<00:46,  4.38it/s]
['cable', 0.8191529235382309, 0.9535264963890476, 0.8647581144597942]
Training model 7/15 for capsule
| feature extraction | train | capsule |: 100%|████████████████████████████████████████| 7/7 [00:16<00:00,  2.41s/it] 
2022-04-18 10:16:39     Train ends, total 17.75s
2022-04-18 10:16:39     Starting eval model...
| feature extraction | test | capsule |: 100%|█████████████████████████████████████████| 5/5 [00:11<00:00,  2.30s/it] 
 54%|██████████████████████████████████████████                                    | 270/500 [00:51<00:43,  5.24it/s]
['capsule', 0.9042680494615077, 0.9874354506801001, 0.9401186599576898]
Training model 8/15 for hazelnut
| feature extraction | train | hazelnut |: 100%|█████████████████████████████████████| 13/13 [00:26<00:00,  2.06s/it] 
2022-04-18 10:18:21     Train ends, total 27.87s
2022-04-18 10:18:21     Starting eval model...
| feature extraction | test | hazelnut |: 100%|████████████████████████████████████████| 4/4 [00:09<00:00,  2.36s/it] 
 37%|████████████████████████████▌                                                 | 183/500 [00:31<00:54,  5.81it/s]
['hazelnut', 0.8757142857142857, 0.9803030749036927, 0.9208755648134804]
Training model 9/15 for metal_nut
| feature extraction | train | metal_nut |: 100%|██████████████████████████████████████| 7/7 [00:08<00:00,  1.18s/it] 
2022-04-18 10:19:20     Train ends, total 9.26s
2022-04-18 10:19:20     Starting eval model...
| feature extraction | test | metal_nut |: 100%|███████████████████████████████████████| 4/4 [00:06<00:00,  1.74s/it]
 27%|████████████████████▉                                                         | 134/500 [00:30<01:23,  4.41it/s]
['metal_nut', 0.9804496578690126, 0.9714911438210897, 0.9121096743547964]
Training model 10/15 for pill
| feature extraction | train | pill |: 100%|███████████████████████████████████████████| 9/9 [00:13<00:00,  1.46s/it] 
2022-04-18 10:20:20     Train ends, total 14.01s
2022-04-18 10:20:20     Starting eval model...
| feature extraction | test | pill |: 100%|████████████████████████████████████████████| 6/6 [00:11<00:00,  1.88s/it] 
 49%|██████████████████████████████████████▌                                       | 247/500 [01:02<01:04,  3.93it/s]
['pill', 0.8780687397708674, 0.957839391689739, 0.9369093220926706]
Training model 11/15 for screw
| feature extraction | train | screw |: 100%|████████████████████████████████████████| 10/10 [00:11<00:00,  1.16s/it] 
2022-04-18 10:22:01     Train ends, total 13.08s
2022-04-18 10:22:01     Starting eval model...
| feature extraction | test | screw |: 100%|███████████████████████████████████████████| 5/5 [00:09<00:00,  1.93s/it] 
 31%|████████████████████████▏                                                     | 155/500 [00:31<01:11,  4.85it/s]
['screw', 0.7866366058618569, 0.9820253879330884, 0.9322074838015111]
Training model 12/15 for toothbrush
| feature extraction | train | toothbrush |: 100%|█████████████████████████████████████| 2/2 [00:04<00:00,  2.13s/it] 
2022-04-18 10:23:00     Train ends, total 4.99s
2022-04-18 10:23:00     Starting eval model...
| feature extraction | test | toothbrush |: 100%|██████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it] 
 41%|████████████████████████████████▏                                             | 206/500 [00:13<00:19, 14.88it/s]
['toothbrush', 0.8972222222222223, 0.9887191808239801, 0.9412869567618066]
Training model 13/15 for transistor
| feature extraction | train | transistor |: 100%|█████████████████████████████████████| 7/7 [00:15<00:00,  2.18s/it] 
2022-04-18 10:23:37     Train ends, total 16.06s
2022-04-18 10:23:37     Starting eval model...
| feature extraction | test | transistor |: 100%|██████████████████████████████████████| 4/4 [00:07<00:00,  1.97s/it] 
 76%|███████████████████████████████████████████████████████████▎                  | 380/500 [00:59<00:18,  6.41it/s]
['transistor', 0.95625, 0.9706047868114279, 0.9238743616759229]
Training model 14/15 for zipper
| feature extraction | train | zipper |: 100%|█████████████████████████████████████████| 8/8 [00:13<00:00,  1.75s/it] 
2022-04-18 10:25:08     Train ends, total 15.00s
2022-04-18 10:25:08     Starting eval model...
| feature extraction | test | zipper |: 100%|██████████████████████████████████████████| 5/5 [00:09<00:00,  1.98s/it] 
 39%|██████████████████████████████▍                                               | 195/500 [00:43<01:08,  4.46it/s]
['zipper', 0.8823529411764706, 0.9863405471091197, 0.9573124399705791]
Evaluation result saved at./output/sample_resnet18_100\all.csv:
            Image_AUROC  Pixel_AUROC  PRO_score
category
carpet         0.993178     0.991483   0.965281
grid           0.879699     0.938801   0.885790
leather        1.000000     0.991653   0.981190
tile           0.958874     0.902967   0.813473
wood           0.986842     0.940542   0.917327
bottle         0.996825     0.984302   0.956668
cable          0.819153     0.953526   0.864758
capsule        0.904268     0.987435   0.940119
hazelnut       0.875714     0.980303   0.920876
metal_nut      0.980450     0.971491   0.912110
pill           0.878069     0.957839   0.936909
screw          0.786637     0.982025   0.932207
toothbrush     0.897222     0.988719   0.941287
transistor     0.956250     0.970605   0.923874
zipper         0.882353     0.986341   0.957312
=========Mean Performance========
Image_AUROC    0.919702
Pixel_AUROC    0.968535
PRO_score      0.923279