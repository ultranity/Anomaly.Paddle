/home/aistudio/Anomaly.Paddle
Namespace(arch='resnet18', batch_size=32, category='textures', cpu=False, crop_size=256, data_path='/home/aistudio/data', debug=False, einsum=False, eval=True, eval_PRO=True, eval_threthold_step=500, inc=False, k=10, load_projection=None, method='coreset', non_partial_AUC=False, num_workers=0, save_model=True, save_model_subfolder=True, save_path='./output/coreset_resnet18_10', save_pic=True, seed=521, test_batch_size=1)
W0422 18:20:30.218997  7396 device_context.cc:447] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
W0422 18:20:30.223659  7396 device_context.cc:465] device: 0, cuDNN Version: 7.6.
model resnet18, nParams 2787264
Training model 1/5 for carpet
| feature extraction | train | carpet |:   0%|            | 0/9 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
| feature extraction | train | carpet |: 100%|████| 9/9 [00:15<00:00,  1.73s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [28672, 384].
2022-04-22 18:22:33	Train ends, total 118.73s
Saving model...
2022-04-22 18:22:33	Save model in ./output/coreset_resnet18_10/carpet.pdparams
2022-04-22 18:22:33	Starting eval model...
| feature extraction | test | carpet |: 100%|█| 117/117 [00:38<00:00,  3.04it/s]
max_score:3.2409136295318604 min_score:0.7035042643547058
F1 image:0.9828571428571428 threshold:3.2409136295318604
F1 pixel:0.5584764361267536 threshold:3.2409136295318604
 26%|██████████▋                              | 131/500 [00:20<00:57,  6.39it/s]['carpet', 0.9955858747993579, 0.9901991232207019, 0.959082125912792]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:2349: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
  if isinstance(obj, collections.Iterator):
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:2366: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
  return list(data) if isinstance(data, collections.MappingView) else data
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 2/5 for grid

| feature extraction | train | grid |:   0%|              | 0/9 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:

| feature extraction | train | grid |:  11%|▋     | 1/9 [00:00<00:05,  1.52it/s]
| feature extraction | train | grid |:  22%|█▎    | 2/9 [00:01<00:04,  1.54it/s]
| feature extraction | train | grid |:  33%|██    | 3/9 [00:01<00:03,  1.55it/s]
| feature extraction | train | grid |:  44%|██▋   | 4/9 [00:02<00:03,  1.57it/s]
| feature extraction | train | grid |:  56%|███▎  | 5/9 [00:03<00:02,  1.56it/s]
| feature extraction | train | grid |:  67%|████  | 6/9 [00:03<00:01,  1.56it/s]
| feature extraction | train | grid |:  78%|████▋ | 7/9 [00:04<00:01,  1.58it/s]
| feature extraction | train | grid |:  89%|█████▎| 8/9 [00:05<00:00,  1.58it/s]
| feature extraction | train | grid |: 100%|██████| 9/9 [00:05<00:00,  1.71it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [27033, 384].
2022-04-22 18:25:17	Train ends, total 98.82s
Saving model...
2022-04-22 18:25:17	Save model in ./output/coreset_resnet18_10/grid.pdparams
2022-04-22 18:25:17	Starting eval model...

| feature extraction | test | grid |:   0%|              | 0/78 [00:00<?, ?it/s]
| feature extraction | test | grid |:   1%|      | 1/78 [00:00<00:26,  2.87it/s]
| feature extraction | test | grid |:   3%|▏     | 2/78 [00:00<00:25,  2.97it/s]
| feature extraction | test | grid |:   4%|▏     | 3/78 [00:00<00:24,  3.03it/s]
| feature extraction | test | grid |:   5%|▎     | 4/78 [00:01<00:23,  3.09it/s]
| feature extraction | test | grid |:   6%|▍     | 5/78 [00:01<00:23,  3.12it/s]
| feature extraction | test | grid |:   8%|▍     | 6/78 [00:01<00:22,  3.15it/s]
| feature extraction | test | grid |:   9%|▌     | 7/78 [00:02<00:22,  3.17it/s]
| feature extraction | test | grid |:  10%|▌     | 8/78 [00:02<00:21,  3.18it/s]
| feature extraction | test | grid |:  12%|▋     | 9/78 [00:02<00:21,  3.19it/s]
| feature extraction | test | grid |:  13%|▋    | 10/78 [00:03<00:21,  3.20it/s]
| feature extraction | test | grid |:  14%|▋    | 11/78 [00:03<00:20,  3.21it/s]
| feature extraction | test | grid |:  15%|▊    | 12/78 [00:03<00:20,  3.22it/s]
| feature extraction | test | grid |:  17%|▊    | 13/78 [00:04<00:20,  3.22it/s]
| feature extraction | test | grid |:  18%|▉    | 14/78 [00:04<00:19,  3.22it/s]
| feature extraction | test | grid |:  19%|▉    | 15/78 [00:04<00:19,  3.22it/s]
| feature extraction | test | grid |:  21%|█    | 16/78 [00:05<00:19,  3.22it/s]
| feature extraction | test | grid |:  22%|█    | 17/78 [00:05<00:18,  3.22it/s]
| feature extraction | test | grid |:  23%|█▏   | 18/78 [00:05<00:18,  3.22it/s]
| feature extraction | test | grid |:  24%|█▏   | 19/78 [00:05<00:18,  3.22it/s]
| feature extraction | test | grid |:  26%|█▎   | 20/78 [00:06<00:17,  3.22it/s]
| feature extraction | test | grid |:  27%|█▎   | 21/78 [00:06<00:17,  3.22it/s]
| feature extraction | test | grid |:  28%|█▍   | 22/78 [00:06<00:17,  3.22it/s]
| feature extraction | test | grid |:  29%|█▍   | 23/78 [00:07<00:17,  3.22it/s]
| feature extraction | test | grid |:  31%|█▌   | 24/78 [00:07<00:16,  3.22it/s]
| feature extraction | test | grid |:  32%|█▌   | 25/78 [00:07<00:16,  3.21it/s]
| feature extraction | test | grid |:  33%|█▋   | 26/78 [00:08<00:16,  3.21it/s]
| feature extraction | test | grid |:  35%|█▋   | 27/78 [00:08<00:15,  3.21it/s]
| feature extraction | test | grid |:  36%|█▊   | 28/78 [00:08<00:15,  3.20it/s]
| feature extraction | test | grid |:  37%|█▊   | 29/78 [00:09<00:15,  3.20it/s]
| feature extraction | test | grid |:  38%|█▉   | 30/78 [00:09<00:14,  3.21it/s]
| feature extraction | test | grid |:  40%|█▉   | 31/78 [00:09<00:14,  3.21it/s]
| feature extraction | test | grid |:  41%|██   | 32/78 [00:09<00:14,  3.21it/s]
| feature extraction | test | grid |:  42%|██   | 33/78 [00:10<00:14,  3.21it/s]
| feature extraction | test | grid |:  44%|██▏  | 34/78 [00:10<00:13,  3.21it/s]
| feature extraction | test | grid |:  45%|██▏  | 35/78 [00:10<00:13,  3.21it/s]
| feature extraction | test | grid |:  46%|██▎  | 36/78 [00:11<00:13,  3.22it/s]
| feature extraction | test | grid |:  47%|██▎  | 37/78 [00:11<00:12,  3.22it/s]
| feature extraction | test | grid |:  49%|██▍  | 38/78 [00:11<00:12,  3.22it/s]
| feature extraction | test | grid |:  50%|██▌  | 39/78 [00:12<00:12,  3.22it/s]
| feature extraction | test | grid |:  51%|██▌  | 40/78 [00:12<00:11,  3.21it/s]
| feature extraction | test | grid |:  53%|██▋  | 41/78 [00:12<00:11,  3.21it/s]
| feature extraction | test | grid |:  54%|██▋  | 42/78 [00:13<00:11,  3.17it/s]
| feature extraction | test | grid |:  55%|██▊  | 43/78 [00:13<00:11,  3.18it/s]
| feature extraction | test | grid |:  56%|██▊  | 44/78 [00:13<00:10,  3.18it/s]
| feature extraction | test | grid |:  58%|██▉  | 45/78 [00:14<00:10,  3.19it/s]
| feature extraction | test | grid |:  59%|██▉  | 46/78 [00:14<00:10,  3.20it/s]
| feature extraction | test | grid |:  60%|███  | 47/78 [00:14<00:09,  3.20it/s]
| feature extraction | test | grid |:  62%|███  | 48/78 [00:14<00:09,  3.20it/s]
| feature extraction | test | grid |:  63%|███▏ | 49/78 [00:15<00:09,  3.20it/s]
| feature extraction | test | grid |:  64%|███▏ | 50/78 [00:15<00:08,  3.20it/s]
| feature extraction | test | grid |:  65%|███▎ | 51/78 [00:15<00:08,  3.20it/s]
| feature extraction | test | grid |:  67%|███▎ | 52/78 [00:16<00:08,  3.21it/s]
| feature extraction | test | grid |:  68%|███▍ | 53/78 [00:16<00:07,  3.20it/s]
| feature extraction | test | grid |:  69%|███▍ | 54/78 [00:16<00:07,  3.17it/s]
| feature extraction | test | grid |:  71%|███▌ | 55/78 [00:17<00:07,  3.17it/s]
| feature extraction | test | grid |:  72%|███▌ | 56/78 [00:17<00:06,  3.18it/s]
| feature extraction | test | grid |:  73%|███▋ | 57/78 [00:17<00:06,  3.20it/s]
| feature extraction | test | grid |:  74%|███▋ | 58/78 [00:18<00:06,  3.19it/s]
| feature extraction | test | grid |:  76%|███▊ | 59/78 [00:18<00:05,  3.19it/s]
| feature extraction | test | grid |:  77%|███▊ | 60/78 [00:18<00:05,  3.19it/s]
| feature extraction | test | grid |:  78%|███▉ | 61/78 [00:19<00:05,  3.20it/s]
| feature extraction | test | grid |:  79%|███▉ | 62/78 [00:19<00:05,  3.20it/s]
| feature extraction | test | grid |:  81%|████ | 63/78 [00:19<00:04,  3.20it/s]
| feature extraction | test | grid |:  82%|████ | 64/78 [00:20<00:04,  3.18it/s]
| feature extraction | test | grid |:  83%|████▏| 65/78 [00:20<00:04,  3.19it/s]
| feature extraction | test | grid |:  85%|████▏| 66/78 [00:20<00:03,  3.20it/s]
| feature extraction | test | grid |:  86%|████▎| 67/78 [00:20<00:03,  3.21it/s]
| feature extraction | test | grid |:  87%|████▎| 68/78 [00:21<00:03,  3.21it/s]
| feature extraction | test | grid |:  88%|████▍| 69/78 [00:21<00:02,  3.21it/s]
| feature extraction | test | grid |:  90%|████▍| 70/78 [00:21<00:02,  3.21it/s]
| feature extraction | test | grid |:  91%|████▌| 71/78 [00:22<00:02,  3.22it/s]
| feature extraction | test | grid |:  92%|████▌| 72/78 [00:22<00:01,  3.22it/s]
| feature extraction | test | grid |:  94%|████▋| 73/78 [00:22<00:01,  3.21it/s]
| feature extraction | test | grid |:  95%|████▋| 74/78 [00:23<00:01,  3.21it/s]
| feature extraction | test | grid |:  96%|████▊| 75/78 [00:23<00:00,  3.22it/s]
| feature extraction | test | grid |:  97%|████▊| 76/78 [00:23<00:00,  3.23it/s]
| feature extraction | test | grid |:  99%|████▉| 77/78 [00:24<00:00,  3.23it/s]
| feature extraction | test | grid |: 100%|█████| 78/78 [00:24<00:00,  3.20it/s]
max_score:2.675908327102661 min_score:0.5877041220664978
F1 image:0.954954954954955 threshold:2.675908327102661
F1 pixel:0.31341884009599646 threshold:2.675908327102661

  0%|                                                   | 0/500 [00:00<?, ?it/s]
  0%|                                           | 1/500 [00:00<00:56,  8.84it/s]
  0%|▏                                          | 2/500 [00:00<00:56,  8.81it/s]
  1%|▎                                          | 3/500 [00:00<00:56,  8.80it/s]
  1%|▎                                          | 4/500 [00:00<00:56,  8.79it/s]
  1%|▍                                          | 5/500 [00:00<00:56,  8.73it/s]
  1%|▌                                          | 6/500 [00:00<00:56,  8.72it/s]
  1%|▌                                          | 7/500 [00:00<00:56,  8.73it/s]
  2%|▋                                          | 8/500 [00:00<00:56,  8.73it/s]
  2%|▊                                          | 9/500 [00:01<00:56,  8.72it/s]
  2%|▊                                         | 10/500 [00:01<00:56,  8.69it/s]
  2%|▉                                         | 11/500 [00:01<00:56,  8.70it/s]
  2%|█                                         | 12/500 [00:01<00:56,  8.71it/s]
  3%|█                                         | 13/500 [00:01<00:55,  8.70it/s]
  3%|█▏                                        | 14/500 [00:01<00:55,  8.69it/s]
  3%|█▎                                        | 15/500 [00:01<00:55,  8.71it/s]
  3%|█▎                                        | 16/500 [00:01<00:55,  8.72it/s]
  3%|█▍                                        | 17/500 [00:01<00:55,  8.70it/s]
  4%|█▌                                        | 18/500 [00:02<00:55,  8.67it/s]
  4%|█▌                                        | 19/500 [00:02<00:55,  8.67it/s]
  4%|█▋                                        | 20/500 [00:02<00:55,  8.67it/s]
  4%|█▊                                        | 21/500 [00:02<00:55,  8.69it/s]
  4%|█▊                                        | 22/500 [00:02<00:55,  8.67it/s]
  5%|█▉                                        | 23/500 [00:02<00:55,  8.66it/s]
  5%|██                                        | 24/500 [00:02<00:55,  8.65it/s]
  5%|██                                        | 25/500 [00:02<00:54,  8.65it/s]
  5%|██▏                                       | 26/500 [00:02<00:54,  8.64it/s]
  5%|██▎                                       | 27/500 [00:03<00:54,  8.66it/s]
  6%|██▎                                       | 28/500 [00:03<00:54,  8.68it/s]
  6%|██▍                                       | 29/500 [00:03<00:54,  8.70it/s]
  6%|██▌                                       | 30/500 [00:03<00:53,  8.71it/s]
  6%|██▌                                       | 31/500 [00:03<00:53,  8.71it/s]
  6%|██▋                                       | 32/500 [00:03<00:53,  8.72it/s]
  7%|██▊                                       | 33/500 [00:03<00:53,  8.72it/s]
  7%|██▊                                       | 34/500 [00:03<00:53,  8.72it/s]
  7%|██▉                                       | 35/500 [00:04<00:53,  8.73it/s]
  7%|███                                       | 36/500 [00:04<00:53,  8.72it/s]
  7%|███                                       | 37/500 [00:04<00:53,  8.70it/s]
  8%|███▏                                      | 38/500 [00:04<00:53,  8.68it/s]
  8%|███▎                                      | 39/500 [00:04<00:53,  8.66it/s]
  8%|███▎                                      | 40/500 [00:04<00:52,  8.70it/s]
  8%|███▍                                      | 41/500 [00:04<00:52,  8.72it/s]
  8%|███▌                                      | 42/500 [00:04<00:52,  8.67it/s]
  9%|███▌                                      | 43/500 [00:04<00:52,  8.67it/s]
  9%|███▋                                      | 44/500 [00:05<00:52,  8.64it/s]
  9%|███▊                                      | 45/500 [00:05<00:53,  8.58it/s]
  9%|███▊                                      | 46/500 [00:05<00:53,  8.55it/s]
  9%|███▉                                      | 47/500 [00:05<00:52,  8.56it/s]
 10%|████                                      | 48/500 [00:05<00:52,  8.57it/s]
 10%|████                                      | 49/500 [00:05<00:52,  8.51it/s]
 10%|████▏                                     | 50/500 [00:05<00:54,  8.32it/s]
 10%|████▎                                     | 51/500 [00:05<00:53,  8.41it/s]
 10%|████▎                                     | 52/500 [00:06<00:52,  8.48it/s]
 11%|████▍                                     | 53/500 [00:06<00:52,  8.55it/s]
 11%|████▌                                     | 54/500 [00:06<00:51,  8.61it/s]
 11%|████▌                                     | 55/500 [00:06<00:52,  8.49it/s]
 11%|████▋                                     | 56/500 [00:06<00:54,  8.14it/s]
 11%|████▊                                     | 57/500 [00:06<01:03,  6.94it/s]
 12%|████▊                                     | 58/500 [00:06<01:10,  6.29it/s]
 12%|████▉                                     | 59/500 [00:07<01:08,  6.42it/s]
 12%|█████                                     | 60/500 [00:07<01:07,  6.52it/s]
 12%|█████                                     | 61/500 [00:07<01:03,  6.92it/s]
 12%|█████▏                                    | 62/500 [00:07<01:10,  6.23it/s]
 13%|█████▎                                    | 63/500 [00:07<01:13,  5.94it/s]
 13%|█████▍                                    | 64/500 [00:07<01:08,  6.37it/s]
 13%|█████▍                                    | 65/500 [00:07<01:03,  6.80it/s]
 13%|█████▌                                    | 66/500 [00:08<01:01,  7.11it/s]
 13%|█████▋                                    | 67/500 [00:08<00:57,  7.50it/s]
 14%|█████▋                                    | 68/500 [00:08<00:55,  7.79it/s]
 14%|█████▊                                    | 69/500 [00:08<00:53,  7.99it/s]
 14%|█████▉                                    | 70/500 [00:08<00:53,  8.10it/s]
 14%|█████▉                                    | 71/500 [00:08<00:52,  8.23it/s]
 14%|██████                                    | 72/500 [00:08<00:51,  8.27it/s]
 15%|██████▏                                   | 73/500 [00:08<00:51,  8.30it/s]
 15%|██████▏                                   | 74/500 [00:09<00:51,  8.32it/s]
 15%|██████▎                                   | 75/500 [00:09<00:50,  8.34it/s]
 15%|██████▍                                   | 76/500 [00:09<00:50,  8.37it/s]
 15%|██████▍                                   | 77/500 [00:09<00:50,  8.38it/s]
 16%|██████▌                                   | 78/500 [00:09<00:50,  8.38it/s]
 16%|██████▋                                   | 79/500 [00:09<00:50,  8.40it/s]
 16%|██████▋                                   | 80/500 [00:09<00:49,  8.40it/s]
 16%|██████▊                                   | 81/500 [00:09<00:49,  8.39it/s]
 16%|██████▉                                   | 82/500 [00:09<00:50,  8.25it/s]
 17%|██████▉                                   | 83/500 [00:10<00:50,  8.31it/s]
 17%|███████                                   | 84/500 [00:10<00:49,  8.36it/s]
 17%|███████▏                                  | 85/500 [00:10<00:49,  8.40it/s]
 17%|███████▏                                  | 86/500 [00:10<00:49,  8.37it/s]
 17%|███████▎                                  | 87/500 [00:10<00:49,  8.34it/s]
 18%|███████▍                                  | 88/500 [00:10<00:49,  8.35it/s]
 18%|███████▍                                  | 89/500 [00:10<00:49,  8.38it/s]
 18%|███████▌                                  | 90/500 [00:10<00:48,  8.37it/s]
 18%|███████▋                                  | 91/500 [00:11<00:48,  8.38it/s]
 18%|███████▋                                  | 92/500 [00:11<00:48,  8.38it/s]
 19%|███████▊                                  | 93/500 [00:11<00:48,  8.39it/s]
 19%|███████▉                                  | 94/500 [00:11<00:48,  8.39it/s]
 19%|███████▉                                  | 95/500 [00:11<00:48,  8.40it/s]
 19%|████████                                  | 96/500 [00:11<00:48,  8.39it/s]
 19%|████████▏                                 | 97/500 [00:11<00:48,  8.39it/s]
 20%|████████▏                                 | 98/500 [00:11<00:47,  8.40it/s]
 20%|████████▎                                 | 99/500 [00:11<00:47,  8.41it/s]
 20%|████████▏                                | 100/500 [00:12<00:47,  8.40it/s]
 20%|████████▎                                | 101/500 [00:12<00:47,  8.45it/s]
 20%|████████▎                                | 102/500 [00:12<00:47,  8.42it/s]
 21%|████████▍                                | 103/500 [00:12<00:47,  8.43it/s]
 21%|████████▌                                | 104/500 [00:12<00:47,  8.41it/s]
 21%|████████▌                                | 105/500 [00:12<00:46,  8.42it/s]
 21%|████████▋                                | 106/500 [00:12<00:46,  8.41it/s]
 21%|████████▊                                | 107/500 [00:12<00:46,  8.42it/s]
 22%|████████▊                                | 108/500 [00:13<00:46,  8.38it/s]
 22%|████████▉                                | 109/500 [00:13<00:46,  8.38it/s]
 22%|█████████                                | 110/500 [00:13<00:46,  8.37it/s]
 22%|█████████                                | 111/500 [00:13<00:46,  8.39it/s]
 22%|█████████▏                               | 112/500 [00:13<00:46,  8.39it/s]
 23%|█████████▎                               | 113/500 [00:13<00:46,  8.39it/s]
 23%|█████████▎                               | 114/500 [00:13<00:46,  8.38it/s]
 23%|█████████▍                               | 115/500 [00:13<00:45,  8.41it/s]
 23%|█████████▌                               | 116/500 [00:14<00:45,  8.41it/s]
 23%|█████████▌                               | 117/500 [00:14<00:45,  8.42it/s]
 24%|█████████▋                               | 118/500 [00:14<00:45,  8.41it/s]
 24%|█████████▊                               | 119/500 [00:14<00:45,  8.43it/s]
 24%|█████████▊                               | 120/500 [00:14<00:45,  8.39it/s]
 24%|█████████▉                               | 121/500 [00:14<00:45,  8.39it/s]
 24%|██████████                               | 122/500 [00:14<00:45,  8.38it/s]
 25%|██████████                               | 123/500 [00:14<00:44,  8.39it/s]
 25%|██████████▏                              | 124/500 [00:14<00:44,  8.37it/s]
 25%|██████████▎                              | 125/500 [00:15<00:44,  8.40it/s]
 25%|██████████▎                              | 126/500 [00:15<00:44,  8.40it/s]
 25%|██████████▍                              | 127/500 [00:15<00:44,  8.44it/s]
 26%|██████████▍                              | 128/500 [00:15<00:44,  8.45it/s]
 26%|██████████▌                              | 129/500 [00:15<00:43,  8.43it/s]
 26%|██████████▋                              | 130/500 [00:15<00:44,  8.40it/s]
 26%|██████████▋                              | 131/500 [00:15<00:43,  8.39it/s]
 26%|██████████▊                              | 132/500 [00:15<00:43,  8.40it/s]
 27%|██████████▉                              | 133/500 [00:16<00:43,  8.43it/s]
 27%|██████████▉                              | 134/500 [00:16<00:43,  8.43it/s]
 27%|███████████                              | 135/500 [00:16<00:43,  8.44it/s]
 27%|███████████▏                             | 136/500 [00:16<00:43,  8.42it/s]
 27%|███████████▏                             | 137/500 [00:16<00:43,  8.42it/s]
 28%|███████████▎                             | 138/500 [00:16<00:42,  8.43it/s]
 28%|███████████▍                             | 139/500 [00:16<00:42,  8.44it/s]
 28%|███████████▍                             | 140/500 [00:16<00:42,  8.45it/s]
 28%|███████████▌                             | 141/500 [00:16<00:42,  8.48it/s]
 28%|███████████▋                             | 142/500 [00:17<00:42,  8.45it/s]
 29%|███████████▋                             | 143/500 [00:17<00:42,  8.48it/s]
 29%|███████████▊                             | 144/500 [00:17<00:41,  8.49it/s]
 29%|███████████▉                             | 145/500 [00:17<00:41,  8.50it/s]
 29%|███████████▉                             | 146/500 [00:17<00:41,  8.48it/s]
 29%|████████████                             | 147/500 [00:17<00:41,  8.50it/s]
 30%|████████████▏                            | 148/500 [00:17<00:41,  8.51it/s]
 30%|████████████▏                            | 149/500 [00:17<00:41,  8.52it/s]
 30%|████████████▎                            | 150/500 [00:18<00:41,  8.52it/s]
 30%|████████████▍                            | 151/500 [00:18<00:40,  8.53it/s]
 30%|████████████▍                            | 152/500 [00:18<00:40,  8.54it/s]
 31%|████████████▌                            | 153/500 [00:18<00:40,  8.52it/s]
 31%|████████████▋                            | 154/500 [00:18<00:40,  8.53it/s]
 31%|████████████▋                            | 155/500 [00:18<00:40,  8.52it/s]
 31%|████████████▊                            | 156/500 [00:18<00:40,  8.52it/s]
 31%|████████████▊                            | 157/500 [00:18<00:40,  8.47it/s]
 32%|████████████▉                            | 158/500 [00:18<00:40,  8.45it/s]
 32%|█████████████                            | 159/500 [00:19<00:40,  8.42it/s]
 32%|█████████████                            | 160/500 [00:19<00:40,  8.39it/s]
 32%|█████████████▏                           | 161/500 [00:19<00:40,  8.37it/s]
 32%|█████████████▎                           | 162/500 [00:19<00:40,  8.36it/s]
 33%|█████████████▎                           | 163/500 [00:19<00:40,  8.32it/s]
 33%|█████████████▍                           | 164/500 [00:19<00:40,  8.29it/s]
 33%|█████████████▌                           | 165/500 [00:19<00:40,  8.27it/s]
 33%|█████████████▌                           | 166/500 [00:19<00:40,  8.27it/s]
 33%|█████████████▋                           | 167/500 [00:20<00:40,  8.27it/s]
 34%|█████████████▊                           | 168/500 [00:20<00:40,  8.28it/s]
 34%|█████████████▊                           | 169/500 [00:20<00:39,  8.31it/s]
 34%|█████████████▉                           | 170/500 [00:20<00:39,  8.31it/s]
 34%|██████████████                           | 171/500 [00:20<00:39,  8.33it/s]
 34%|██████████████                           | 172/500 [00:20<00:39,  8.35it/s]
 35%|██████████████▏                          | 173/500 [00:20<00:39,  8.34it/s]
 35%|██████████████▎                          | 174/500 [00:20<00:38,  8.37it/s]
 35%|██████████████▎                          | 175/500 [00:21<00:38,  8.36it/s]
 35%|██████████████▍                          | 176/500 [00:21<00:38,  8.38it/s]
 35%|██████████████▌                          | 177/500 [00:21<00:38,  8.39it/s]
 36%|██████████████▌                          | 178/500 [00:21<00:38,  8.42it/s]
 36%|██████████████▋                          | 179/500 [00:21<00:38,  8.41it/s]
 36%|██████████████▊                          | 180/500 [00:21<00:38,  8.41it/s]
 36%|██████████████▊                          | 181/500 [00:21<00:37,  8.41it/s]
 36%|██████████████▉                          | 182/500 [00:21<00:37,  8.40it/s]
 37%|███████████████                          | 183/500 [00:21<00:37,  8.40it/s]
 37%|███████████████                          | 184/500 [00:22<00:37,  8.39it/s]
 37%|███████████████▏                         | 185/500 [00:22<00:37,  8.40it/s]
 37%|███████████████▎                         | 186/500 [00:22<00:37,  8.39it/s]
 37%|███████████████▎                         | 187/500 [00:22<00:37,  8.41it/s]
 38%|███████████████▍                         | 188/500 [00:22<00:37,  8.43it/s]
 38%|███████████████▍                         | 189/500 [00:22<00:36,  8.41it/s]
 38%|███████████████▌                         | 190/500 [00:22<00:36,  8.41it/s]
 38%|███████████████▋                         | 191/500 [00:22<00:36,  8.43it/s]
 38%|███████████████▋                         | 192/500 [00:23<00:36,  8.42it/s]
 39%|███████████████▊                         | 193/500 [00:23<00:36,  8.41it/s]
 39%|███████████████▉                         | 194/500 [00:23<00:36,  8.42it/s]
 39%|███████████████▉                         | 195/500 [00:23<00:36,  8.44it/s]
 39%|████████████████                         | 196/500 [00:23<00:35,  8.47it/s]
 39%|████████████████▏                        | 197/500 [00:23<00:35,  8.46it/s]
 40%|████████████████▏                        | 198/500 [00:23<00:35,  8.49it/s]
 40%|████████████████▎                        | 199/500 [00:23<00:35,  8.51it/s]
 40%|████████████████▍                        | 200/500 [00:23<00:35,  8.52it/s]
 40%|████████████████▍                        | 201/500 [00:24<00:35,  8.52it/s]
 40%|████████████████▌                        | 202/500 [00:24<00:34,  8.53it/s]
 41%|████████████████▋                        | 203/500 [00:24<00:34,  8.50it/s]
 41%|████████████████▋                        | 204/500 [00:24<00:34,  8.52it/s]
 41%|████████████████▊                        | 205/500 [00:24<00:34,  8.53it/s]
 41%|████████████████▉                        | 206/500 [00:24<00:34,  8.55it/s]
 41%|████████████████▉                        | 207/500 [00:24<00:34,  8.54it/s]
 42%|█████████████████                        | 208/500 [00:24<00:34,  8.48it/s]
 42%|█████████████████▏                       | 209/500 [00:25<00:34,  8.46it/s]
 42%|█████████████████▏                       | 210/500 [00:25<00:35,  8.26it/s]
 42%|█████████████████▎                       | 211/500 [00:25<00:34,  8.34it/s]
 42%|█████████████████▍                       | 212/500 [00:25<00:34,  8.42it/s]
 43%|█████████████████▍                       | 213/500 [00:25<00:34,  8.44it/s]
 43%|█████████████████▌                       | 214/500 [00:25<00:33,  8.43it/s]
 43%|█████████████████▋                       | 215/500 [00:25<00:33,  8.46it/s]
 43%|█████████████████▋                       | 216/500 [00:25<00:33,  8.49it/s]
 43%|█████████████████▊                       | 217/500 [00:25<00:33,  8.52it/s]
 44%|█████████████████▉                       | 218/500 [00:26<00:33,  8.52it/s]
 44%|█████████████████▉                       | 219/500 [00:26<00:32,  8.53it/s]
 44%|██████████████████                       | 220/500 [00:26<00:32,  8.54it/s]
 44%|██████████████████                       | 221/500 [00:26<00:32,  8.54it/s]
 44%|██████████████████▏                      | 222/500 [00:26<00:32,  8.55it/s]
 45%|██████████████████▎                      | 223/500 [00:26<00:32,  8.53it/s]
 45%|██████████████████▎                      | 224/500 [00:26<00:32,  8.54it/s]
 45%|██████████████████▍                      | 225/500 [00:26<00:32,  8.53it/s]
 45%|██████████████████▌                      | 226/500 [00:27<00:32,  8.50it/s]
 45%|██████████████████▌                      | 227/500 [00:27<00:32,  8.52it/s]
 46%|██████████████████▋                      | 228/500 [00:27<00:31,  8.54it/s]
 46%|██████████████████▊                      | 229/500 [00:27<00:31,  8.56it/s]
 46%|██████████████████▊                      | 230/500 [00:27<00:31,  8.55it/s]
 46%|██████████████████▉                      | 231/500 [00:27<00:31,  8.55it/s]
 46%|███████████████████                      | 232/500 [00:27<00:31,  8.55it/s]
 47%|███████████████████                      | 233/500 [00:27<00:31,  8.45it/s]
 47%|███████████████████▏                     | 234/500 [00:27<00:31,  8.35it/s]
 47%|███████████████████▎                     | 235/500 [00:28<00:32,  8.28it/s]
 47%|███████████████████▎                     | 236/500 [00:28<00:32,  8.08it/s]
 47%|███████████████████▍                     | 237/500 [00:28<00:32,  8.09it/s]
 48%|███████████████████▌                     | 238/500 [00:28<00:33,  7.80it/s]
 48%|███████████████████▌                     | 239/500 [00:28<00:33,  7.89it/s]
 48%|███████████████████▋                     | 240/500 [00:28<00:32,  8.04it/s]
 48%|███████████████████▊                     | 241/500 [00:28<00:31,  8.14it/s]
 48%|███████████████████▊                     | 242/500 [00:28<00:31,  8.18it/s]
 49%|███████████████████▉                     | 243/500 [00:29<00:31,  8.25it/s]
 49%|████████████████████                     | 244/500 [00:29<00:30,  8.27it/s]
 49%|████████████████████                     | 245/500 [00:29<00:30,  8.31it/s]
 49%|████████████████████▏                    | 246/500 [00:29<00:30,  8.29it/s]
 49%|████████████████████▎                    | 247/500 [00:29<00:30,  8.31it/s]
 50%|████████████████████▎                    | 248/500 [00:29<00:30,  8.30it/s]
 50%|████████████████████▍                    | 249/500 [00:29<00:30,  8.31it/s]
 50%|████████████████████▌                    | 250/500 [00:29<00:30,  8.29it/s]
 50%|████████████████████▌                    | 251/500 [00:30<00:29,  8.31it/s]
 50%|████████████████████▋                    | 252/500 [00:30<00:29,  8.31it/s]
 51%|████████████████████▋                    | 253/500 [00:30<00:29,  8.33it/s]
 51%|████████████████████▊                    | 254/500 [00:30<00:29,  8.32it/s]
 51%|████████████████████▉                    | 255/500 [00:30<00:29,  8.33it/s]
 51%|████████████████████▉                    | 256/500 [00:30<00:29,  8.32it/s]
 51%|█████████████████████                    | 257/500 [00:30<00:29,  8.34it/s]
 52%|█████████████████████▏                   | 258/500 [00:30<00:29,  8.32it/s]
 52%|█████████████████████▏                   | 259/500 [00:31<00:28,  8.35it/s]
 52%|█████████████████████▎                   | 260/500 [00:31<00:28,  8.31it/s]
 52%|█████████████████████▍                   | 261/500 [00:31<00:28,  8.33it/s]
 52%|█████████████████████▍                   | 262/500 [00:31<00:28,  8.28it/s]
 53%|█████████████████████▌                   | 263/500 [00:31<00:28,  8.29it/s]
 53%|█████████████████████▋                   | 264/500 [00:31<00:28,  8.25it/s]
 53%|█████████████████████▋                   | 265/500 [00:31<00:28,  8.26it/s]
 53%|█████████████████████▊                   | 266/500 [00:31<00:28,  8.23it/s]
 53%|█████████████████████▉                   | 267/500 [00:32<00:28,  8.27it/s]
 54%|█████████████████████▉                   | 268/500 [00:32<00:28,  8.28it/s]
 54%|██████████████████████                   | 269/500 [00:32<00:27,  8.30it/s]
 54%|██████████████████████▏                  | 270/500 [00:32<00:27,  8.30it/s]
 54%|██████████████████████▏                  | 271/500 [00:32<00:27,  8.32it/s]
 54%|██████████████████████▎                  | 272/500 [00:32<00:27,  8.30it/s]
 55%|██████████████████████▍                  | 273/500 [00:32<00:27,  8.33it/s]
 55%|██████████████████████▍                  | 274/500 [00:32<00:27,  8.31it/s]
 55%|██████████████████████▌                  | 275/500 [00:32<00:26,  8.34it/s]
 55%|██████████████████████▋                  | 276/500 [00:33<00:26,  8.37it/s]
 55%|██████████████████████▋                  | 277/500 [00:33<00:26,  8.40it/s]
 56%|██████████████████████▊                  | 278/500 [00:33<00:26,  8.40it/s]
 56%|██████████████████████▉                  | 279/500 [00:33<00:26,  8.44it/s]
 56%|██████████████████████▉                  | 280/500 [00:33<00:26,  8.43it/s]
 56%|███████████████████████                  | 281/500 [00:33<00:25,  8.45it/s]
 56%|███████████████████████                  | 282/500 [00:33<00:25,  8.43it/s]
 57%|███████████████████████▏                 | 283/500 [00:33<00:25,  8.45it/s]
 57%|███████████████████████▎                 | 284/500 [00:34<00:25,  8.44it/s]
 57%|███████████████████████▎                 | 285/500 [00:34<00:25,  8.45it/s]
 57%|███████████████████████▍                 | 286/500 [00:34<00:25,  8.43it/s]
 57%|███████████████████████▌                 | 287/500 [00:34<00:25,  8.43it/s]
 58%|███████████████████████▌                 | 288/500 [00:34<00:25,  8.42it/s]
 58%|███████████████████████▋                 | 289/500 [00:34<00:24,  8.45it/s]
 58%|███████████████████████▊                 | 290/500 [00:34<00:24,  8.41it/s]
 58%|███████████████████████▊                 | 291/500 [00:34<00:24,  8.42it/s]
 58%|███████████████████████▉                 | 292/500 [00:34<00:24,  8.42it/s]
 59%|████████████████████████                 | 293/500 [00:35<00:24,  8.44it/s]
 59%|████████████████████████                 | 294/500 [00:35<00:24,  8.40it/s]
 59%|████████████████████████▏                | 295/500 [00:35<00:24,  8.43it/s]
 59%|████████████████████████▎                | 296/500 [00:35<00:24,  8.42it/s]
 59%|████████████████████████▎                | 297/500 [00:35<00:24,  8.44it/s]
 60%|████████████████████████▍                | 298/500 [00:35<00:24,  8.41it/s]
 60%|████████████████████████▌                | 299/500 [00:35<00:23,  8.40it/s]
 60%|████████████████████████▌                | 300/500 [00:35<00:23,  8.40it/s]
 60%|████████████████████████▋                | 301/500 [00:36<00:23,  8.42it/s]
 60%|████████████████████████▊                | 302/500 [00:36<00:23,  8.43it/s]
 61%|████████████████████████▊                | 303/500 [00:36<00:23,  8.46it/s]
 61%|████████████████████████▉                | 304/500 [00:36<00:23,  8.45it/s]
 61%|█████████████████████████                | 305/500 [00:36<00:22,  8.50it/s]
 61%|█████████████████████████                | 306/500 [00:36<00:22,  8.51it/s]
 61%|█████████████████████████▏               | 307/500 [00:36<00:22,  8.54it/s]
 62%|█████████████████████████▎               | 308/500 [00:36<00:22,  8.51it/s]
 62%|█████████████████████████▎               | 309/500 [00:36<00:22,  8.52it/s]
 62%|█████████████████████████▍               | 310/500 [00:37<00:22,  8.49it/s]
 62%|█████████████████████████▌               | 311/500 [00:37<00:22,  8.49it/s]
 62%|█████████████████████████▌               | 312/500 [00:37<00:22,  8.49it/s]
 63%|█████████████████████████▋               | 313/500 [00:37<00:21,  8.51it/s]
 63%|█████████████████████████▋               | 314/500 [00:37<00:21,  8.49it/s]
 63%|█████████████████████████▊               | 315/500 [00:37<00:21,  8.51it/s]
 63%|█████████████████████████▉               | 316/500 [00:37<00:21,  8.49it/s]
 63%|█████████████████████████▉               | 317/500 [00:37<00:21,  8.50it/s]
 64%|██████████████████████████               | 318/500 [00:38<00:21,  8.50it/s]
 64%|██████████████████████████▏              | 319/500 [00:38<00:21,  8.52it/s]
 64%|██████████████████████████▏              | 320/500 [00:38<00:21,  8.51it/s]
 64%|██████████████████████████▎              | 321/500 [00:38<00:21,  8.50it/s]
 64%|██████████████████████████▍              | 322/500 [00:38<00:21,  8.46it/s]
 65%|██████████████████████████▍              | 323/500 [00:38<00:20,  8.50it/s]
 65%|██████████████████████████▌              | 324/500 [00:38<00:20,  8.46it/s]
 65%|██████████████████████████▋              | 325/500 [00:38<00:20,  8.42it/s]
 65%|██████████████████████████▋              | 326/500 [00:38<00:20,  8.41it/s]
 65%|██████████████████████████▊              | 327/500 [00:39<00:20,  8.41it/s]
 66%|██████████████████████████▉              | 328/500 [00:39<00:20,  8.40it/s]
 66%|██████████████████████████▉              | 329/500 [00:39<00:20,  8.43it/s]
 66%|███████████████████████████              | 330/500 [00:39<00:20,  8.42it/s]
 66%|███████████████████████████▏             | 331/500 [00:39<00:20,  8.42it/s]
 66%|███████████████████████████▏             | 332/500 [00:39<00:19,  8.42it/s]
 67%|███████████████████████████▎             | 333/500 [00:39<00:19,  8.43it/s]
 67%|███████████████████████████▍             | 334/500 [00:39<00:19,  8.41it/s]
 67%|███████████████████████████▍             | 335/500 [00:40<00:19,  8.42it/s]
 67%|███████████████████████████▌             | 336/500 [00:40<00:19,  8.40it/s]
 67%|███████████████████████████▋             | 337/500 [00:40<00:19,  8.42it/s]
 68%|███████████████████████████▋             | 338/500 [00:40<00:19,  8.40it/s]
 68%|███████████████████████████▊             | 339/500 [00:40<00:20,  8.02it/s]
 68%|███████████████████████████▉             | 340/500 [00:40<00:19,  8.13it/s]
 68%|███████████████████████████▉             | 341/500 [00:40<00:19,  8.22it/s]
 68%|████████████████████████████             | 342/500 [00:40<00:19,  8.26it/s]
 69%|████████████████████████████▏            | 343/500 [00:41<00:18,  8.30it/s]
 69%|████████████████████████████▏            | 344/500 [00:41<00:18,  8.33it/s]
 69%|████████████████████████████▎            | 345/500 [00:41<00:18,  8.36it/s]
 69%|████████████████████████████▎            | 346/500 [00:41<00:18,  8.35it/s]
 69%|████████████████████████████▍            | 347/500 [00:41<00:18,  8.37it/s]
 70%|████████████████████████████▌            | 348/500 [00:41<00:18,  8.33it/s]
 70%|████████████████████████████▌            | 349/500 [00:41<00:18,  8.34it/s]['grid', 0.9699248120300752, 0.9792290222280859, 0.9215438271394459]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 3/5 for leather


| feature extraction | train | leather |:   0%|           | 0/8 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:


| feature extraction | train | leather |:  12%|▍  | 1/8 [00:01<00:09,  1.37s/it]

| feature extraction | train | leather |:  25%|▊  | 2/8 [00:02<00:08,  1.35s/it]

| feature extraction | train | leather |:  38%|█▏ | 3/8 [00:04<00:06,  1.35s/it]

| feature extraction | train | leather |:  50%|█▌ | 4/8 [00:05<00:05,  1.36s/it]

| feature extraction | train | leather |:  62%|█▉ | 5/8 [00:06<00:04,  1.38s/it]

| feature extraction | train | leather |:  75%|██▎| 6/8 [00:08<00:02,  1.38s/it]

| feature extraction | train | leather |:  88%|██▋| 7/8 [00:09<00:01,  1.35s/it]

| feature extraction | train | leather |: 100%|███| 8/8 [00:10<00:00,  1.29s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [25088, 384].
2022-04-22 18:27:59	Train ends, total 93.17s
Saving model...
2022-04-22 18:27:59	Save model in ./output/coreset_resnet18_10/leather.pdparams
2022-04-22 18:27:59	Starting eval model...


| feature extraction | test | leather |:   0%|          | 0/124 [00:00<?, ?it/s]

| feature extraction | test | leather |:   1%|  | 1/124 [00:00<00:59,  2.06it/s]

| feature extraction | test | leather |:   2%|  | 2/124 [00:00<00:52,  2.31it/s]

| feature extraction | test | leather |:   2%|  | 3/124 [00:01<00:47,  2.56it/s]

| feature extraction | test | leather |:   3%|  | 4/124 [00:01<00:43,  2.77it/s]

| feature extraction | test | leather |:   4%|  | 5/124 [00:01<00:40,  2.93it/s]

| feature extraction | test | leather |:   5%|  | 6/124 [00:01<00:38,  3.06it/s]

| feature extraction | test | leather |:   6%|  | 7/124 [00:02<00:37,  3.15it/s]

| feature extraction | test | leather |:   6%|▏ | 8/124 [00:02<00:36,  3.22it/s]

| feature extraction | test | leather |:   7%|▏ | 9/124 [00:02<00:35,  3.27it/s]

| feature extraction | test | leather |:   8%| | 10/124 [00:03<00:34,  3.31it/s]

| feature extraction | test | leather |:   9%| | 11/124 [00:03<00:33,  3.33it/s]

| feature extraction | test | leather |:  10%| | 12/124 [00:03<00:33,  3.35it/s]

| feature extraction | test | leather |:  10%| | 13/124 [00:04<00:32,  3.36it/s]

| feature extraction | test | leather |:  11%| | 14/124 [00:04<00:32,  3.37it/s]

| feature extraction | test | leather |:  12%| | 15/124 [00:04<00:32,  3.38it/s]

| feature extraction | test | leather |:  13%|▏| 16/124 [00:04<00:31,  3.39it/s]

| feature extraction | test | leather |:  14%|▏| 17/124 [00:05<00:31,  3.40it/s]

| feature extraction | test | leather |:  15%|▏| 18/124 [00:05<00:31,  3.40it/s]

| feature extraction | test | leather |:  15%|▏| 19/124 [00:05<00:30,  3.39it/s]

| feature extraction | test | leather |:  16%|▏| 20/124 [00:06<00:30,  3.39it/s]

| feature extraction | test | leather |:  17%|▏| 21/124 [00:06<00:30,  3.40it/s]

| feature extraction | test | leather |:  18%|▏| 22/124 [00:06<00:30,  3.40it/s]

| feature extraction | test | leather |:  19%|▏| 23/124 [00:06<00:29,  3.40it/s]

| feature extraction | test | leather |:  19%|▏| 24/124 [00:07<00:29,  3.40it/s]

| feature extraction | test | leather |:  20%|▏| 25/124 [00:07<00:29,  3.40it/s]

| feature extraction | test | leather |:  21%|▏| 26/124 [00:07<00:28,  3.40it/s]

| feature extraction | test | leather |:  22%|▏| 27/124 [00:08<00:28,  3.40it/s]

| feature extraction | test | leather |:  23%|▏| 28/124 [00:08<00:28,  3.40it/s]

| feature extraction | test | leather |:  23%|▏| 29/124 [00:08<00:27,  3.40it/s]

| feature extraction | test | leather |:  24%|▏| 30/124 [00:09<00:27,  3.40it/s]

| feature extraction | test | leather |:  25%|▎| 31/124 [00:09<00:27,  3.40it/s]

| feature extraction | test | leather |:  26%|▎| 32/124 [00:09<00:27,  3.40it/s]

| feature extraction | test | leather |:  27%|▎| 33/124 [00:09<00:26,  3.40it/s]

| feature extraction | test | leather |:  27%|▎| 34/124 [00:10<00:26,  3.40it/s]

| feature extraction | test | leather |:  28%|▎| 35/124 [00:10<00:26,  3.40it/s]

| feature extraction | test | leather |:  29%|▎| 36/124 [00:10<00:25,  3.40it/s]

| feature extraction | test | leather |:  30%|▎| 37/124 [00:11<00:25,  3.40it/s]

| feature extraction | test | leather |:  31%|▎| 38/124 [00:11<00:25,  3.39it/s]

| feature extraction | test | leather |:  31%|▎| 39/124 [00:11<00:25,  3.40it/s]

| feature extraction | test | leather |:  32%|▎| 40/124 [00:11<00:24,  3.39it/s]

| feature extraction | test | leather |:  33%|▎| 41/124 [00:12<00:24,  3.40it/s]

| feature extraction | test | leather |:  34%|▎| 42/124 [00:12<00:24,  3.40it/s]

| feature extraction | test | leather |:  35%|▎| 43/124 [00:12<00:23,  3.40it/s]

| feature extraction | test | leather |:  35%|▎| 44/124 [00:13<00:23,  3.40it/s]

| feature extraction | test | leather |:  36%|▎| 45/124 [00:13<00:23,  3.40it/s]

| feature extraction | test | leather |:  37%|▎| 46/124 [00:13<00:22,  3.40it/s]

| feature extraction | test | leather |:  38%|▍| 47/124 [00:14<00:22,  3.40it/s]

| feature extraction | test | leather |:  39%|▍| 48/124 [00:14<00:22,  3.40it/s]

| feature extraction | test | leather |:  40%|▍| 49/124 [00:14<00:22,  3.40it/s]

| feature extraction | test | leather |:  40%|▍| 50/124 [00:14<00:21,  3.40it/s]

| feature extraction | test | leather |:  41%|▍| 51/124 [00:15<00:21,  3.40it/s]

| feature extraction | test | leather |:  42%|▍| 52/124 [00:15<00:21,  3.40it/s]

| feature extraction | test | leather |:  43%|▍| 53/124 [00:15<00:20,  3.40it/s]

| feature extraction | test | leather |:  44%|▍| 54/124 [00:16<00:20,  3.40it/s]

| feature extraction | test | leather |:  44%|▍| 55/124 [00:16<00:20,  3.40it/s]

| feature extraction | test | leather |:  45%|▍| 56/124 [00:16<00:20,  3.40it/s]

| feature extraction | test | leather |:  46%|▍| 57/124 [00:16<00:19,  3.40it/s]

| feature extraction | test | leather |:  47%|▍| 58/124 [00:17<00:19,  3.40it/s]

| feature extraction | test | leather |:  48%|▍| 59/124 [00:17<00:19,  3.40it/s]

| feature extraction | test | leather |:  48%|▍| 60/124 [00:17<00:18,  3.40it/s]

| feature extraction | test | leather |:  49%|▍| 61/124 [00:18<00:18,  3.40it/s]

| feature extraction | test | leather |:  50%|▌| 62/124 [00:18<00:18,  3.39it/s]

| feature extraction | test | leather |:  51%|▌| 63/124 [00:18<00:18,  3.30it/s]

| feature extraction | test | leather |:  52%|▌| 64/124 [00:19<00:18,  3.33it/s]

| feature extraction | test | leather |:  52%|▌| 65/124 [00:19<00:18,  3.24it/s]

| feature extraction | test | leather |:  53%|▌| 66/124 [00:19<00:17,  3.28it/s]

| feature extraction | test | leather |:  54%|▌| 67/124 [00:19<00:17,  3.32it/s]

| feature extraction | test | leather |:  55%|▌| 68/124 [00:20<00:16,  3.34it/s]

| feature extraction | test | leather |:  56%|▌| 69/124 [00:20<00:16,  3.36it/s]

| feature extraction | test | leather |:  56%|▌| 70/124 [00:20<00:16,  3.37it/s]

| feature extraction | test | leather |:  57%|▌| 71/124 [00:21<00:15,  3.38it/s]

| feature extraction | test | leather |:  58%|▌| 72/124 [00:21<00:15,  3.38it/s]

| feature extraction | test | leather |:  59%|▌| 73/124 [00:21<00:15,  3.38it/s]

| feature extraction | test | leather |:  60%|▌| 74/124 [00:22<00:14,  3.39it/s]

| feature extraction | test | leather |:  60%|▌| 75/124 [00:22<00:14,  3.39it/s]

| feature extraction | test | leather |:  61%|▌| 76/124 [00:22<00:14,  3.39it/s]

| feature extraction | test | leather |:  62%|▌| 77/124 [00:22<00:13,  3.39it/s]

| feature extraction | test | leather |:  63%|▋| 78/124 [00:23<00:13,  3.39it/s]

| feature extraction | test | leather |:  64%|▋| 79/124 [00:23<00:13,  3.40it/s]

| feature extraction | test | leather |:  65%|▋| 80/124 [00:23<00:12,  3.40it/s]

| feature extraction | test | leather |:  65%|▋| 81/124 [00:24<00:12,  3.40it/s]

| feature extraction | test | leather |:  66%|▋| 82/124 [00:24<00:12,  3.40it/s]

| feature extraction | test | leather |:  67%|▋| 83/124 [00:24<00:12,  3.41it/s]

| feature extraction | test | leather |:  68%|▋| 84/124 [00:24<00:11,  3.36it/s]

| feature extraction | test | leather |:  69%|▋| 85/124 [00:25<00:11,  3.38it/s]

| feature extraction | test | leather |:  69%|▋| 86/124 [00:25<00:11,  3.39it/s]

| feature extraction | test | leather |:  70%|▋| 87/124 [00:25<00:10,  3.39it/s]

| feature extraction | test | leather |:  71%|▋| 88/124 [00:26<00:10,  3.39it/s]

| feature extraction | test | leather |:  72%|▋| 89/124 [00:26<00:10,  3.39it/s]

| feature extraction | test | leather |:  73%|▋| 90/124 [00:26<00:10,  3.39it/s]

| feature extraction | test | leather |:  73%|▋| 91/124 [00:27<00:09,  3.40it/s]

| feature extraction | test | leather |:  74%|▋| 92/124 [00:27<00:09,  3.40it/s]

| feature extraction | test | leather |:  75%|▊| 93/124 [00:27<00:09,  3.40it/s]

| feature extraction | test | leather |:  76%|▊| 94/124 [00:27<00:08,  3.40it/s]

| feature extraction | test | leather |:  77%|▊| 95/124 [00:28<00:08,  3.40it/s]

| feature extraction | test | leather |:  77%|▊| 96/124 [00:28<00:08,  3.40it/s]

| feature extraction | test | leather |:  78%|▊| 97/124 [00:28<00:07,  3.40it/s]

| feature extraction | test | leather |:  79%|▊| 98/124 [00:29<00:07,  3.40it/s]

| feature extraction | test | leather |:  80%|▊| 99/124 [00:29<00:07,  3.40it/s]

| feature extraction | test | leather |:  81%|▊| 100/124 [00:29<00:07,  3.40it/s]

| feature extraction | test | leather |:  81%|▊| 101/124 [00:29<00:06,  3.40it/s]

| feature extraction | test | leather |:  82%|▊| 102/124 [00:30<00:06,  3.40it/s]

| feature extraction | test | leather |:  83%|▊| 103/124 [00:30<00:06,  3.40it/s]

| feature extraction | test | leather |:  84%|▊| 104/124 [00:30<00:05,  3.39it/s]

| feature extraction | test | leather |:  85%|▊| 105/124 [00:31<00:05,  3.40it/s]

| feature extraction | test | leather |:  85%|▊| 106/124 [00:31<00:05,  3.40it/s]

| feature extraction | test | leather |:  86%|▊| 107/124 [00:31<00:05,  3.40it/s]

| feature extraction | test | leather |:  87%|▊| 108/124 [00:32<00:04,  3.40it/s]

| feature extraction | test | leather |:  88%|▉| 109/124 [00:32<00:04,  3.40it/s]

| feature extraction | test | leather |:  89%|▉| 110/124 [00:32<00:04,  3.40it/s]

| feature extraction | test | leather |:  90%|▉| 111/124 [00:32<00:03,  3.40it/s]

| feature extraction | test | leather |:  90%|▉| 112/124 [00:33<00:03,  3.40it/s]

| feature extraction | test | leather |:  91%|▉| 113/124 [00:33<00:03,  3.39it/s]

| feature extraction | test | leather |:  92%|▉| 114/124 [00:33<00:02,  3.39it/s]

| feature extraction | test | leather |:  93%|▉| 115/124 [00:34<00:02,  3.39it/s]

| feature extraction | test | leather |:  94%|▉| 116/124 [00:34<00:02,  3.39it/s]

| feature extraction | test | leather |:  94%|▉| 117/124 [00:34<00:02,  3.39it/s]

| feature extraction | test | leather |:  95%|▉| 118/124 [00:35<00:01,  3.39it/s]

| feature extraction | test | leather |:  96%|▉| 119/124 [00:35<00:01,  3.39it/s]

| feature extraction | test | leather |:  97%|▉| 120/124 [00:35<00:01,  3.39it/s]

| feature extraction | test | leather |:  98%|▉| 121/124 [00:35<00:00,  3.40it/s]

| feature extraction | test | leather |:  98%|▉| 122/124 [00:36<00:00,  3.41it/s]

| feature extraction | test | leather |:  99%|▉| 123/124 [00:36<00:00,  3.42it/s]

| feature extraction | test | leather |: 100%|█| 124/124 [00:36<00:00,  3.37it/s]
max_score:5.091420650482178 min_score:0.665397584438324
F1 image:1.0 threshold:5.091420650482178
F1 pixel:0.34365947341692477 threshold:5.091420650482178


  0%|                                                   | 0/500 [00:00<?, ?it/s]

  0%|                                           | 1/500 [00:00<01:15,  6.62it/s]

  0%|▏                                          | 2/500 [00:00<01:15,  6.62it/s]

  1%|▎                                          | 3/500 [00:00<01:15,  6.60it/s]

  1%|▎                                          | 4/500 [00:00<01:14,  6.63it/s]

  1%|▍                                          | 5/500 [00:00<01:14,  6.63it/s]

  1%|▌                                          | 6/500 [00:00<01:14,  6.63it/s]

  1%|▌                                          | 7/500 [00:01<01:14,  6.63it/s]

  2%|▋                                          | 8/500 [00:01<01:14,  6.63it/s]

  2%|▊                                          | 9/500 [00:01<01:14,  6.62it/s]

  2%|▊                                         | 10/500 [00:01<01:13,  6.64it/s]

  2%|▉                                         | 11/500 [00:01<01:13,  6.63it/s]

  2%|█                                         | 12/500 [00:01<01:13,  6.63it/s]

  3%|█                                         | 13/500 [00:01<01:13,  6.64it/s]

  3%|█▏                                        | 14/500 [00:02<01:13,  6.64it/s]

  3%|█▎                                        | 15/500 [00:02<01:13,  6.63it/s]

  3%|█▎                                        | 16/500 [00:02<01:13,  6.61it/s]

  3%|█▍                                        | 17/500 [00:02<01:12,  6.62it/s]

  4%|█▌                                        | 18/500 [00:02<01:12,  6.62it/s]

  4%|█▌                                        | 19/500 [00:02<01:12,  6.63it/s]

  4%|█▋                                        | 20/500 [00:03<01:12,  6.64it/s]

  4%|█▊                                        | 21/500 [00:03<01:12,  6.64it/s]

  4%|█▊                                        | 22/500 [00:03<01:11,  6.65it/s]

  5%|█▉                                        | 23/500 [00:03<01:11,  6.65it/s]

  5%|██                                        | 24/500 [00:03<01:11,  6.64it/s]

  5%|██                                        | 25/500 [00:03<01:11,  6.64it/s]

  5%|██▏                                       | 26/500 [00:03<01:11,  6.64it/s]

  5%|██▎                                       | 27/500 [00:04<01:11,  6.64it/s]

  6%|██▎                                       | 28/500 [00:04<01:10,  6.65it/s]

  6%|██▍                                       | 29/500 [00:04<01:11,  6.61it/s]

  6%|██▌                                       | 30/500 [00:04<01:11,  6.61it/s]

  6%|██▌                                       | 31/500 [00:04<01:11,  6.58it/s]

  6%|██▋                                       | 32/500 [00:04<01:11,  6.55it/s]

  7%|██▊                                       | 33/500 [00:04<01:11,  6.57it/s]

  7%|██▊                                       | 34/500 [00:05<01:10,  6.57it/s]

  7%|██▉                                       | 35/500 [00:05<01:10,  6.57it/s]

  7%|███                                       | 36/500 [00:05<01:10,  6.57it/s]

  7%|███                                       | 37/500 [00:05<01:10,  6.58it/s]

  8%|███▏                                      | 38/500 [00:05<01:10,  6.58it/s]

  8%|███▎                                      | 39/500 [00:05<01:10,  6.58it/s]

  8%|███▎                                      | 40/500 [00:06<01:09,  6.58it/s]

  8%|███▍                                      | 41/500 [00:06<01:09,  6.58it/s]

  8%|███▌                                      | 42/500 [00:06<01:09,  6.57it/s]

  9%|███▌                                      | 43/500 [00:06<01:09,  6.58it/s]

  9%|███▋                                      | 44/500 [00:06<01:09,  6.59it/s]

  9%|███▊                                      | 45/500 [00:06<01:09,  6.58it/s]

  9%|███▊                                      | 46/500 [00:06<01:09,  6.58it/s]

  9%|███▉                                      | 47/500 [00:07<01:08,  6.58it/s]

 10%|████                                      | 48/500 [00:07<01:08,  6.58it/s]

 10%|████                                      | 49/500 [00:07<01:08,  6.58it/s]

 10%|████▏                                     | 50/500 [00:07<01:08,  6.58it/s]

 10%|████▎                                     | 51/500 [00:07<01:08,  6.56it/s]

 10%|████▎                                     | 52/500 [00:07<01:08,  6.58it/s]

 11%|████▍                                     | 53/500 [00:08<01:07,  6.60it/s]

 11%|████▌                                     | 54/500 [00:08<01:07,  6.62it/s]

 11%|████▌                                     | 55/500 [00:08<01:07,  6.64it/s]

 11%|████▋                                     | 56/500 [00:08<01:06,  6.64it/s]

 11%|████▊                                     | 57/500 [00:08<01:06,  6.64it/s]

 12%|████▊                                     | 58/500 [00:08<01:06,  6.65it/s]

 12%|████▉                                     | 59/500 [00:08<01:06,  6.65it/s]

 12%|█████                                     | 60/500 [00:09<01:06,  6.65it/s]

 12%|█████                                     | 61/500 [00:09<01:06,  6.64it/s]

 12%|█████▏                                    | 62/500 [00:09<01:05,  6.65it/s]

 13%|█████▎                                    | 63/500 [00:09<01:05,  6.64it/s]

 13%|█████▍                                    | 64/500 [00:09<01:05,  6.63it/s]

 13%|█████▍                                    | 65/500 [00:09<01:05,  6.61it/s]

 13%|█████▌                                    | 66/500 [00:09<01:05,  6.62it/s]

 13%|█████▋                                    | 67/500 [00:10<01:05,  6.62it/s]

 14%|█████▋                                    | 68/500 [00:10<01:05,  6.62it/s]

 14%|█████▊                                    | 69/500 [00:10<01:05,  6.61it/s]

 14%|█████▉                                    | 70/500 [00:10<01:05,  6.61it/s]

 14%|█████▉                                    | 71/500 [00:10<01:04,  6.62it/s]

 14%|██████                                    | 72/500 [00:10<01:04,  6.63it/s]

 15%|██████▏                                   | 73/500 [00:11<01:04,  6.64it/s]

 15%|██████▏                                   | 74/500 [00:11<01:04,  6.64it/s]

 15%|██████▎                                   | 75/500 [00:11<01:03,  6.64it/s]

 15%|██████▍                                   | 76/500 [00:11<01:03,  6.65it/s]

 15%|██████▍                                   | 77/500 [00:11<01:03,  6.64it/s]

 16%|██████▌                                   | 78/500 [00:11<01:03,  6.65it/s]

 16%|██████▋                                   | 79/500 [00:11<01:03,  6.65it/s]

 16%|██████▋                                   | 80/500 [00:12<01:03,  6.65it/s]

 16%|██████▊                                   | 81/500 [00:12<01:03,  6.64it/s]

 16%|██████▉                                   | 82/500 [00:12<01:03,  6.57it/s]

 17%|██████▉                                   | 83/500 [00:12<01:03,  6.58it/s]

 17%|███████                                   | 84/500 [00:12<01:03,  6.58it/s]

 17%|███████▏                                  | 85/500 [00:12<01:03,  6.59it/s]

 17%|███████▏                                  | 86/500 [00:13<01:02,  6.59it/s]

 17%|███████▎                                  | 87/500 [00:13<01:02,  6.58it/s]

 18%|███████▍                                  | 88/500 [00:13<01:02,  6.61it/s]

 18%|███████▍                                  | 89/500 [00:13<01:02,  6.62it/s]

 18%|███████▌                                  | 90/500 [00:13<01:03,  6.48it/s]

 18%|███████▋                                  | 91/500 [00:13<01:02,  6.53it/s]

 18%|███████▋                                  | 92/500 [00:13<01:01,  6.58it/s]

 19%|███████▊                                  | 93/500 [00:14<01:01,  6.61it/s]

 19%|███████▉                                  | 94/500 [00:14<01:01,  6.57it/s]

 19%|███████▉                                  | 95/500 [00:14<01:01,  6.60it/s]

 19%|████████                                  | 96/500 [00:14<01:01,  6.62it/s]

 19%|████████▏                                 | 97/500 [00:14<01:00,  6.62it/s]

 20%|████████▏                                 | 98/500 [00:14<01:00,  6.64it/s]

 20%|████████▎                                 | 99/500 [00:14<01:00,  6.65it/s]

 20%|████████▏                                | 100/500 [00:15<01:00,  6.66it/s]

 20%|████████▎                                | 101/500 [00:15<00:59,  6.65it/s]

 20%|████████▎                                | 102/500 [00:15<00:59,  6.66it/s]

 21%|████████▍                                | 103/500 [00:15<00:59,  6.66it/s]

 21%|████████▌                                | 104/500 [00:15<00:59,  6.65it/s]

 21%|████████▌                                | 105/500 [00:15<00:59,  6.64it/s]

 21%|████████▋                                | 106/500 [00:16<00:59,  6.64it/s]

 21%|████████▊                                | 107/500 [00:16<00:59,  6.66it/s]

 22%|████████▊                                | 108/500 [00:16<00:58,  6.65it/s]

 22%|████████▉                                | 109/500 [00:16<00:58,  6.65it/s]

 22%|█████████                                | 110/500 [00:16<00:58,  6.66it/s]

 22%|█████████                                | 111/500 [00:16<00:58,  6.66it/s]

 22%|█████████▏                               | 112/500 [00:16<00:58,  6.66it/s]

 23%|█████████▎                               | 113/500 [00:17<00:58,  6.57it/s]

 23%|█████████▎                               | 114/500 [00:17<00:58,  6.60it/s]

 23%|█████████▍                               | 115/500 [00:17<00:58,  6.61it/s]

 23%|█████████▌                               | 116/500 [00:17<00:57,  6.62it/s]

 23%|█████████▌                               | 117/500 [00:17<00:57,  6.63it/s]

 24%|█████████▋                               | 118/500 [00:17<00:57,  6.63it/s]

 24%|█████████▊                               | 119/500 [00:17<00:57,  6.64it/s]

 24%|█████████▊                               | 120/500 [00:18<00:57,  6.65it/s]

 24%|█████████▉                               | 121/500 [00:18<00:56,  6.65it/s]

 24%|██████████                               | 122/500 [00:18<00:56,  6.65it/s]

 25%|██████████                               | 123/500 [00:18<00:56,  6.62it/s]

 25%|██████████▏                              | 124/500 [00:18<00:57,  6.56it/s]

 25%|██████████▎                              | 125/500 [00:18<00:59,  6.31it/s]

 25%|██████████▎                              | 126/500 [00:19<00:59,  6.29it/s]

 25%|██████████▍                              | 127/500 [00:19<01:01,  6.11it/s]

 26%|██████████▍                              | 128/500 [00:19<01:02,  6.00it/s]

 26%|██████████▌                              | 129/500 [00:19<01:00,  6.08it/s]

 26%|██████████▋                              | 130/500 [00:19<00:59,  6.23it/s]

 26%|██████████▋                              | 131/500 [00:19<00:58,  6.35it/s]

 26%|██████████▊                              | 132/500 [00:20<00:57,  6.43it/s]

 27%|██████████▉                              | 133/500 [00:20<00:57,  6.42it/s]

 27%|██████████▉                              | 134/500 [00:20<00:56,  6.46it/s]

 27%|███████████                              | 135/500 [00:20<00:56,  6.47it/s]

 27%|███████████▏                             | 136/500 [00:20<00:55,  6.52it/s]

 27%|███████████▏                             | 137/500 [00:20<00:55,  6.55it/s]

 28%|███████████▎                             | 138/500 [00:20<00:55,  6.52it/s]

 28%|███████████▍                             | 139/500 [00:21<00:55,  6.51it/s]

 28%|███████████▍                             | 140/500 [00:21<00:55,  6.54it/s]

 28%|███████████▌                             | 141/500 [00:21<00:58,  6.14it/s]

 28%|███████████▋                             | 142/500 [00:21<00:58,  6.10it/s]

 29%|███████████▋                             | 143/500 [00:21<00:57,  6.17it/s]

 29%|███████████▊                             | 144/500 [00:21<00:58,  6.10it/s]

 29%|███████████▉                             | 145/500 [00:22<00:57,  6.22it/s]

 29%|███████████▉                             | 146/500 [00:22<00:55,  6.34it/s]

 29%|████████████                             | 147/500 [00:22<00:54,  6.43it/s]

 30%|████████████▏                            | 148/500 [00:22<00:56,  6.26it/s]

 30%|████████████▏                            | 149/500 [00:22<00:56,  6.18it/s]

 30%|████████████▎                            | 150/500 [00:22<00:56,  6.18it/s]

 30%|████████████▍                            | 151/500 [00:23<00:56,  6.22it/s]

 30%|████████████▍                            | 152/500 [00:23<00:54,  6.33it/s]

 31%|████████████▌                            | 153/500 [00:23<00:54,  6.41it/s]

 31%|████████████▋                            | 154/500 [00:23<00:53,  6.46it/s]

 31%|████████████▋                            | 155/500 [00:23<00:53,  6.50it/s]

 31%|████████████▊                            | 156/500 [00:23<00:52,  6.53it/s]

 31%|████████████▊                            | 157/500 [00:23<00:52,  6.55it/s]

 32%|████████████▉                            | 158/500 [00:24<00:52,  6.57it/s]

 32%|█████████████                            | 159/500 [00:24<00:51,  6.57it/s]

 32%|█████████████                            | 160/500 [00:24<00:51,  6.58it/s]

 32%|█████████████▏                           | 161/500 [00:24<00:51,  6.59it/s]

 32%|█████████████▎                           | 162/500 [00:24<00:51,  6.58it/s]

 33%|█████████████▎                           | 163/500 [00:24<00:50,  6.61it/s]

 33%|█████████████▍                           | 164/500 [00:25<00:50,  6.64it/s]

 33%|█████████████▌                           | 165/500 [00:25<00:50,  6.65it/s]

 33%|█████████████▌                           | 166/500 [00:25<00:50,  6.66it/s]

 33%|█████████████▋                           | 167/500 [00:25<00:49,  6.66it/s]

 34%|█████████████▊                           | 168/500 [00:25<00:49,  6.67it/s]

 34%|█████████████▊                           | 169/500 [00:25<00:49,  6.67it/s]

 34%|█████████████▉                           | 170/500 [00:25<00:49,  6.67it/s]

 34%|██████████████                           | 171/500 [00:26<00:49,  6.67it/s]

 34%|██████████████                           | 172/500 [00:26<00:49,  6.67it/s]

 35%|██████████████▏                          | 173/500 [00:26<00:49,  6.67it/s]

 35%|██████████████▎                          | 174/500 [00:26<00:48,  6.66it/s]

 35%|██████████████▎                          | 175/500 [00:26<00:48,  6.67it/s]

 35%|██████████████▍                          | 176/500 [00:26<00:48,  6.67it/s]

 35%|██████████████▌                          | 177/500 [00:26<00:48,  6.68it/s]

 36%|██████████████▌                          | 178/500 [00:27<00:48,  6.67it/s]

 36%|██████████████▋                          | 179/500 [00:27<00:48,  6.66it/s]

 36%|██████████████▊                          | 180/500 [00:27<00:48,  6.66it/s]

 36%|██████████████▊                          | 181/500 [00:27<00:47,  6.66it/s]

 36%|██████████████▉                          | 182/500 [00:27<00:47,  6.66it/s]

 37%|███████████████                          | 183/500 [00:27<00:47,  6.67it/s]

 37%|███████████████                          | 184/500 [00:28<00:47,  6.66it/s]

 37%|███████████████▏                         | 185/500 [00:28<00:47,  6.66it/s]

 37%|███████████████▎                         | 186/500 [00:28<00:47,  6.66it/s]

 37%|███████████████▎                         | 187/500 [00:28<00:47,  6.66it/s]

 38%|███████████████▍                         | 188/500 [00:28<00:46,  6.66it/s]

 38%|███████████████▍                         | 189/500 [00:28<00:46,  6.64it/s]

 38%|███████████████▌                         | 190/500 [00:28<00:46,  6.64it/s]['leather', 1.0, 0.9898424966588343, 0.9691352135674535]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 4/5 for tile



| feature extraction | train | tile |:   0%|              | 0/8 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:



| feature extraction | train | tile |:  12%|▊     | 1/8 [00:01<00:08,  1.19s/it]


| feature extraction | train | tile |:  25%|█▌    | 2/8 [00:02<00:07,  1.19s/it]


| feature extraction | train | tile |:  38%|██▎   | 3/8 [00:03<00:05,  1.19s/it]


| feature extraction | train | tile |:  50%|███   | 4/8 [00:04<00:04,  1.18s/it]


| feature extraction | train | tile |:  62%|███▊  | 5/8 [00:05<00:03,  1.18s/it]


| feature extraction | train | tile |:  75%|████▌ | 6/8 [00:07<00:02,  1.18s/it]


| feature extraction | train | tile |:  88%|█████▎| 7/8 [00:08<00:01,  1.18s/it]


| feature extraction | train | tile |: 100%|██████| 8/8 [00:08<00:00,  1.06s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [23552, 384].
2022-04-22 18:30:33	Train ends, total 82.18s
Saving model...
2022-04-22 18:30:33	Save model in ./output/coreset_resnet18_10/tile.pdparams
2022-04-22 18:30:33	Starting eval model...



| feature extraction | test | tile |:   0%|             | 0/117 [00:00<?, ?it/s]


| feature extraction | test | tile |:   1%|     | 1/117 [00:00<00:37,  3.06it/s]


| feature extraction | test | tile |:   2%|     | 2/117 [00:00<00:35,  3.20it/s]


| feature extraction | test | tile |:   3%|▏    | 3/117 [00:00<00:34,  3.31it/s]


| feature extraction | test | tile |:   3%|▏    | 4/117 [00:01<00:33,  3.38it/s]


| feature extraction | test | tile |:   4%|▏    | 5/117 [00:01<00:32,  3.44it/s]


| feature extraction | test | tile |:   5%|▎    | 6/117 [00:01<00:31,  3.48it/s]


| feature extraction | test | tile |:   6%|▎    | 7/117 [00:02<00:31,  3.51it/s]


| feature extraction | test | tile |:   7%|▎    | 8/117 [00:02<00:30,  3.53it/s]


| feature extraction | test | tile |:   8%|▍    | 9/117 [00:02<00:30,  3.55it/s]


| feature extraction | test | tile |:   9%|▎   | 10/117 [00:02<00:30,  3.56it/s]


| feature extraction | test | tile |:   9%|▍   | 11/117 [00:03<00:29,  3.57it/s]


| feature extraction | test | tile |:  10%|▍   | 12/117 [00:03<00:29,  3.57it/s]


| feature extraction | test | tile |:  11%|▍   | 13/117 [00:03<00:29,  3.57it/s]


| feature extraction | test | tile |:  12%|▍   | 14/117 [00:03<00:28,  3.57it/s]


| feature extraction | test | tile |:  13%|▌   | 15/117 [00:04<00:28,  3.57it/s]


| feature extraction | test | tile |:  14%|▌   | 16/117 [00:04<00:28,  3.57it/s]


| feature extraction | test | tile |:  15%|▌   | 17/117 [00:04<00:28,  3.57it/s]


| feature extraction | test | tile |:  15%|▌   | 18/117 [00:05<00:27,  3.57it/s]


| feature extraction | test | tile |:  16%|▋   | 19/117 [00:05<00:27,  3.56it/s]


| feature extraction | test | tile |:  17%|▋   | 20/117 [00:05<00:27,  3.56it/s]


| feature extraction | test | tile |:  18%|▋   | 21/117 [00:05<00:26,  3.56it/s]


| feature extraction | test | tile |:  19%|▊   | 22/117 [00:06<00:26,  3.56it/s]


| feature extraction | test | tile |:  20%|▊   | 23/117 [00:06<00:26,  3.56it/s]


| feature extraction | test | tile |:  21%|▊   | 24/117 [00:06<00:26,  3.56it/s]


| feature extraction | test | tile |:  21%|▊   | 25/117 [00:07<00:25,  3.55it/s]


| feature extraction | test | tile |:  22%|▉   | 26/117 [00:07<00:25,  3.54it/s]


| feature extraction | test | tile |:  23%|▉   | 27/117 [00:07<00:25,  3.56it/s]


| feature extraction | test | tile |:  24%|▉   | 28/117 [00:07<00:24,  3.56it/s]


| feature extraction | test | tile |:  25%|▉   | 29/117 [00:08<00:24,  3.57it/s]


| feature extraction | test | tile |:  26%|█   | 30/117 [00:08<00:24,  3.58it/s]


| feature extraction | test | tile |:  26%|█   | 31/117 [00:08<00:24,  3.58it/s]


| feature extraction | test | tile |:  27%|█   | 32/117 [00:09<00:23,  3.58it/s]


| feature extraction | test | tile |:  28%|█▏  | 33/117 [00:09<00:23,  3.59it/s]


| feature extraction | test | tile |:  29%|█▏  | 34/117 [00:09<00:23,  3.59it/s]


| feature extraction | test | tile |:  30%|█▏  | 35/117 [00:09<00:22,  3.58it/s]


| feature extraction | test | tile |:  31%|█▏  | 36/117 [00:10<00:22,  3.58it/s]


| feature extraction | test | tile |:  32%|█▎  | 37/117 [00:10<00:22,  3.58it/s]


| feature extraction | test | tile |:  32%|█▎  | 38/117 [00:10<00:22,  3.58it/s]


| feature extraction | test | tile |:  33%|█▎  | 39/117 [00:10<00:21,  3.59it/s]


| feature extraction | test | tile |:  34%|█▎  | 40/117 [00:11<00:21,  3.59it/s]


| feature extraction | test | tile |:  35%|█▍  | 41/117 [00:11<00:21,  3.59it/s]


| feature extraction | test | tile |:  36%|█▍  | 42/117 [00:11<00:20,  3.59it/s]


| feature extraction | test | tile |:  37%|█▍  | 43/117 [00:12<00:20,  3.59it/s]


| feature extraction | test | tile |:  38%|█▌  | 44/117 [00:12<00:20,  3.58it/s]


| feature extraction | test | tile |:  38%|█▌  | 45/117 [00:12<00:20,  3.51it/s]


| feature extraction | test | tile |:  39%|█▌  | 46/117 [00:12<00:20,  3.53it/s]


| feature extraction | test | tile |:  40%|█▌  | 47/117 [00:13<00:19,  3.55it/s]


| feature extraction | test | tile |:  41%|█▋  | 48/117 [00:13<00:19,  3.56it/s]


| feature extraction | test | tile |:  42%|█▋  | 49/117 [00:13<00:19,  3.57it/s]


| feature extraction | test | tile |:  43%|█▋  | 50/117 [00:14<00:18,  3.58it/s]


| feature extraction | test | tile |:  44%|█▋  | 51/117 [00:14<00:18,  3.58it/s]


| feature extraction | test | tile |:  44%|█▊  | 52/117 [00:14<00:18,  3.59it/s]


| feature extraction | test | tile |:  45%|█▊  | 53/117 [00:14<00:17,  3.59it/s]


| feature extraction | test | tile |:  46%|█▊  | 54/117 [00:15<00:17,  3.59it/s]


| feature extraction | test | tile |:  47%|█▉  | 55/117 [00:15<00:17,  3.59it/s]


| feature extraction | test | tile |:  48%|█▉  | 56/117 [00:15<00:16,  3.60it/s]


| feature extraction | test | tile |:  49%|█▉  | 57/117 [00:15<00:16,  3.60it/s]


| feature extraction | test | tile |:  50%|█▉  | 58/117 [00:16<00:16,  3.60it/s]


| feature extraction | test | tile |:  50%|██  | 59/117 [00:16<00:16,  3.60it/s]


| feature extraction | test | tile |:  51%|██  | 60/117 [00:16<00:15,  3.60it/s]


| feature extraction | test | tile |:  52%|██  | 61/117 [00:17<00:15,  3.60it/s]


| feature extraction | test | tile |:  53%|██  | 62/117 [00:17<00:15,  3.60it/s]


| feature extraction | test | tile |:  54%|██▏ | 63/117 [00:17<00:15,  3.60it/s]


| feature extraction | test | tile |:  55%|██▏ | 64/117 [00:17<00:14,  3.60it/s]


| feature extraction | test | tile |:  56%|██▏ | 65/117 [00:18<00:14,  3.59it/s]


| feature extraction | test | tile |:  56%|██▎ | 66/117 [00:18<00:14,  3.59it/s]


| feature extraction | test | tile |:  57%|██▎ | 67/117 [00:18<00:13,  3.58it/s]


| feature extraction | test | tile |:  58%|██▎ | 68/117 [00:19<00:13,  3.58it/s]


| feature extraction | test | tile |:  59%|██▎ | 69/117 [00:19<00:13,  3.58it/s]


| feature extraction | test | tile |:  60%|██▍ | 70/117 [00:19<00:13,  3.58it/s]


| feature extraction | test | tile |:  61%|██▍ | 71/117 [00:19<00:12,  3.58it/s]


| feature extraction | test | tile |:  62%|██▍ | 72/117 [00:20<00:12,  3.58it/s]


| feature extraction | test | tile |:  62%|██▍ | 73/117 [00:20<00:12,  3.58it/s]


| feature extraction | test | tile |:  63%|██▌ | 74/117 [00:20<00:12,  3.58it/s]


| feature extraction | test | tile |:  64%|██▌ | 75/117 [00:21<00:11,  3.58it/s]


| feature extraction | test | tile |:  65%|██▌ | 76/117 [00:21<00:11,  3.58it/s]


| feature extraction | test | tile |:  66%|██▋ | 77/117 [00:21<00:11,  3.59it/s]


| feature extraction | test | tile |:  67%|██▋ | 78/117 [00:21<00:10,  3.59it/s]


| feature extraction | test | tile |:  68%|██▋ | 79/117 [00:22<00:10,  3.59it/s]


| feature extraction | test | tile |:  68%|██▋ | 80/117 [00:22<00:10,  3.56it/s]


| feature extraction | test | tile |:  69%|██▊ | 81/117 [00:22<00:10,  3.57it/s]


| feature extraction | test | tile |:  70%|██▊ | 82/117 [00:22<00:09,  3.57it/s]


| feature extraction | test | tile |:  71%|██▊ | 83/117 [00:23<00:09,  3.58it/s]


| feature extraction | test | tile |:  72%|██▊ | 84/117 [00:23<00:09,  3.58it/s]


| feature extraction | test | tile |:  73%|██▉ | 85/117 [00:23<00:08,  3.58it/s]


| feature extraction | test | tile |:  74%|██▉ | 86/117 [00:24<00:08,  3.58it/s]


| feature extraction | test | tile |:  74%|██▉ | 87/117 [00:24<00:08,  3.58it/s]


| feature extraction | test | tile |:  75%|███ | 88/117 [00:24<00:08,  3.58it/s]


| feature extraction | test | tile |:  76%|███ | 89/117 [00:24<00:07,  3.58it/s]


| feature extraction | test | tile |:  77%|███ | 90/117 [00:25<00:07,  3.58it/s]


| feature extraction | test | tile |:  78%|███ | 91/117 [00:25<00:07,  3.58it/s]


| feature extraction | test | tile |:  79%|███▏| 92/117 [00:25<00:06,  3.58it/s]


| feature extraction | test | tile |:  79%|███▏| 93/117 [00:26<00:06,  3.58it/s]


| feature extraction | test | tile |:  80%|███▏| 94/117 [00:26<00:06,  3.58it/s]


| feature extraction | test | tile |:  81%|███▏| 95/117 [00:26<00:06,  3.58it/s]


| feature extraction | test | tile |:  82%|███▎| 96/117 [00:26<00:05,  3.58it/s]


| feature extraction | test | tile |:  83%|███▎| 97/117 [00:27<00:05,  3.58it/s]


| feature extraction | test | tile |:  84%|███▎| 98/117 [00:27<00:05,  3.59it/s]


| feature extraction | test | tile |:  85%|███▍| 99/117 [00:27<00:05,  3.59it/s]


| feature extraction | test | tile |:  85%|██▌| 100/117 [00:27<00:04,  3.59it/s]


| feature extraction | test | tile |:  86%|██▌| 101/117 [00:28<00:04,  3.59it/s]


| feature extraction | test | tile |:  87%|██▌| 102/117 [00:28<00:04,  3.58it/s]


| feature extraction | test | tile |:  88%|██▋| 103/117 [00:28<00:03,  3.58it/s]


| feature extraction | test | tile |:  89%|██▋| 104/117 [00:29<00:03,  3.58it/s]


| feature extraction | test | tile |:  90%|██▋| 105/117 [00:29<00:03,  3.58it/s]


| feature extraction | test | tile |:  91%|██▋| 106/117 [00:29<00:03,  3.58it/s]


| feature extraction | test | tile |:  91%|██▋| 107/117 [00:29<00:02,  3.52it/s]


| feature extraction | test | tile |:  92%|██▊| 108/117 [00:30<00:02,  3.49it/s]


| feature extraction | test | tile |:  93%|██▊| 109/117 [00:30<00:02,  3.51it/s]


| feature extraction | test | tile |:  94%|██▊| 110/117 [00:30<00:01,  3.53it/s]


| feature extraction | test | tile |:  95%|██▊| 111/117 [00:31<00:01,  3.54it/s]


| feature extraction | test | tile |:  96%|██▊| 112/117 [00:31<00:01,  3.55it/s]


| feature extraction | test | tile |:  97%|██▉| 113/117 [00:31<00:01,  3.56it/s]


| feature extraction | test | tile |:  97%|██▉| 114/117 [00:31<00:00,  3.57it/s]


| feature extraction | test | tile |:  98%|██▉| 115/117 [00:32<00:00,  3.59it/s]


| feature extraction | test | tile |:  99%|██▉| 116/117 [00:32<00:00,  3.61it/s]


| feature extraction | test | tile |: 100%|███| 117/117 [00:32<00:00,  3.57it/s]
max_score:3.825455665588379 min_score:0.3916596472263336
F1 image:0.9704142011834319 threshold:3.825455665588379
F1 pixel:0.554450916182978 threshold:3.825455665588379



  0%|                                                   | 0/500 [00:00<?, ?it/s]


  0%|                                           | 1/500 [00:00<01:55,  4.31it/s]


  0%|▏                                          | 2/500 [00:00<01:54,  4.36it/s]


  1%|▎                                          | 3/500 [00:00<01:54,  4.34it/s]


  1%|▎                                          | 4/500 [00:00<01:53,  4.38it/s]


  1%|▍                                          | 5/500 [00:01<01:51,  4.45it/s]


  1%|▌                                          | 6/500 [00:01<01:48,  4.54it/s]


  1%|▌                                          | 7/500 [00:01<01:48,  4.56it/s]


  2%|▋                                          | 8/500 [00:01<01:47,  4.56it/s]


  2%|▊                                          | 9/500 [00:01<01:46,  4.59it/s]


  2%|▊                                         | 10/500 [00:02<01:46,  4.61it/s]


  2%|▉                                         | 11/500 [00:02<01:48,  4.51it/s]


  2%|█                                         | 12/500 [00:02<01:48,  4.51it/s]


  3%|█                                         | 13/500 [00:02<01:48,  4.51it/s]


  3%|█▏                                        | 14/500 [00:03<01:48,  4.49it/s]


  3%|█▎                                        | 15/500 [00:03<01:48,  4.48it/s]


  3%|█▎                                        | 16/500 [00:03<01:47,  4.49it/s]


  3%|█▍                                        | 17/500 [00:03<01:47,  4.48it/s]


  4%|█▌                                        | 18/500 [00:03<01:45,  4.55it/s]


  4%|█▌                                        | 19/500 [00:04<01:45,  4.58it/s]


  4%|█▋                                        | 20/500 [00:04<01:44,  4.59it/s]


  4%|█▊                                        | 21/500 [00:04<01:44,  4.58it/s]


  4%|█▊                                        | 22/500 [00:04<01:43,  4.64it/s]


  5%|█▉                                        | 23/500 [00:05<01:42,  4.67it/s]


  5%|██                                        | 24/500 [00:05<01:40,  4.73it/s]


  5%|██                                        | 25/500 [00:05<01:39,  4.76it/s]


  5%|██▏                                       | 26/500 [00:05<01:39,  4.77it/s]


  5%|██▎                                       | 27/500 [00:05<01:39,  4.77it/s]


  6%|██▎                                       | 28/500 [00:06<01:41,  4.64it/s]


  6%|██▍                                       | 29/500 [00:06<01:42,  4.60it/s]


  6%|██▌                                       | 30/500 [00:06<01:40,  4.66it/s]


  6%|██▌                                       | 31/500 [00:06<01:40,  4.65it/s]


  6%|██▋                                       | 32/500 [00:06<01:40,  4.68it/s]


  7%|██▊                                       | 33/500 [00:07<01:40,  4.66it/s]


  7%|██▊                                       | 34/500 [00:07<01:38,  4.71it/s]


  7%|██▉                                       | 35/500 [00:07<01:37,  4.75it/s]


  7%|███                                       | 36/500 [00:07<01:38,  4.69it/s]


  7%|███                                       | 37/500 [00:08<01:39,  4.65it/s]


  8%|███▏                                      | 38/500 [00:08<01:38,  4.68it/s]


  8%|███▎                                      | 39/500 [00:08<01:39,  4.65it/s]


  8%|███▎                                      | 40/500 [00:08<01:38,  4.68it/s]


  8%|███▍                                      | 41/500 [00:08<01:37,  4.72it/s]


  8%|███▌                                      | 42/500 [00:09<01:36,  4.76it/s]


  9%|███▌                                      | 43/500 [00:09<01:36,  4.73it/s]


  9%|███▋                                      | 44/500 [00:09<01:35,  4.77it/s]


  9%|███▊                                      | 45/500 [00:09<01:35,  4.78it/s]


  9%|███▊                                      | 46/500 [00:09<01:35,  4.77it/s]


  9%|███▉                                      | 47/500 [00:10<01:34,  4.79it/s]


 10%|████                                      | 48/500 [00:10<01:34,  4.79it/s]


 10%|████                                      | 49/500 [00:10<01:34,  4.79it/s]


 10%|████▏                                     | 50/500 [00:10<01:35,  4.73it/s]


 10%|████▎                                     | 51/500 [00:10<01:35,  4.72it/s]


 10%|████▎                                     | 52/500 [00:11<01:35,  4.71it/s]


 11%|████▍                                     | 53/500 [00:11<01:34,  4.73it/s]


 11%|████▌                                     | 54/500 [00:11<01:35,  4.67it/s]


 11%|████▌                                     | 55/500 [00:11<01:35,  4.68it/s]


 11%|████▋                                     | 56/500 [00:12<01:35,  4.64it/s]


 11%|████▊                                     | 57/500 [00:12<01:36,  4.59it/s]


 12%|████▊                                     | 58/500 [00:12<01:36,  4.60it/s]


 12%|████▉                                     | 59/500 [00:12<01:35,  4.61it/s]


 12%|█████                                     | 60/500 [00:12<01:34,  4.66it/s]


 12%|█████                                     | 61/500 [00:13<01:34,  4.64it/s]


 12%|█████▏                                    | 62/500 [00:13<01:35,  4.61it/s]


 13%|█████▎                                    | 63/500 [00:13<01:35,  4.56it/s]


 13%|█████▍                                    | 64/500 [00:13<01:36,  4.54it/s]


 13%|█████▍                                    | 65/500 [00:14<01:36,  4.50it/s]


 13%|█████▌                                    | 66/500 [00:14<01:35,  4.53it/s]


 13%|█████▋                                    | 67/500 [00:14<01:35,  4.55it/s]


 14%|█████▋                                    | 68/500 [00:14<01:34,  4.59it/s]


 14%|█████▊                                    | 69/500 [00:14<01:32,  4.66it/s]


 14%|█████▉                                    | 70/500 [00:15<01:31,  4.71it/s]


 14%|█████▉                                    | 71/500 [00:15<01:31,  4.69it/s]


 14%|██████                                    | 72/500 [00:15<01:32,  4.64it/s]


 15%|██████▏                                   | 73/500 [00:15<01:32,  4.62it/s]


 15%|██████▏                                   | 74/500 [00:15<01:34,  4.51it/s]


 15%|██████▎                                   | 75/500 [00:16<01:33,  4.54it/s]


 15%|██████▍                                   | 76/500 [00:16<01:33,  4.55it/s]


 15%|██████▍                                   | 77/500 [00:16<01:34,  4.49it/s]


 16%|██████▌                                   | 78/500 [00:16<01:32,  4.57it/s]


 16%|██████▋                                   | 79/500 [00:17<01:32,  4.57it/s]


 16%|██████▋                                   | 80/500 [00:17<01:30,  4.62it/s]


 16%|██████▊                                   | 81/500 [00:17<01:30,  4.64it/s]


 16%|██████▉                                   | 82/500 [00:17<01:29,  4.65it/s]


 17%|██████▉                                   | 83/500 [00:17<01:29,  4.67it/s]


 17%|███████                                   | 84/500 [00:18<01:29,  4.64it/s]


 17%|███████▏                                  | 85/500 [00:18<01:30,  4.60it/s]


 17%|███████▏                                  | 86/500 [00:18<01:29,  4.65it/s]


 17%|███████▎                                  | 87/500 [00:18<01:31,  4.50it/s]


 18%|███████▍                                  | 88/500 [00:19<01:30,  4.54it/s]


 18%|███████▍                                  | 89/500 [00:19<01:29,  4.60it/s]


 18%|███████▌                                  | 90/500 [00:19<01:28,  4.65it/s]


 18%|███████▋                                  | 91/500 [00:19<01:28,  4.62it/s]


 18%|███████▋                                  | 92/500 [00:19<01:27,  4.64it/s]


 19%|███████▊                                  | 93/500 [00:20<01:27,  4.65it/s]


 19%|███████▉                                  | 94/500 [00:20<01:26,  4.69it/s]


 19%|███████▉                                  | 95/500 [00:20<01:25,  4.72it/s]


 19%|████████                                  | 96/500 [00:20<01:25,  4.75it/s]


 19%|████████▏                                 | 97/500 [00:20<01:25,  4.74it/s]


 20%|████████▏                                 | 98/500 [00:21<01:25,  4.71it/s]


 20%|████████▎                                 | 99/500 [00:21<01:25,  4.67it/s]


 20%|████████▏                                | 100/500 [00:21<01:25,  4.69it/s]


 20%|████████▎                                | 101/500 [00:21<01:25,  4.68it/s]


 20%|████████▎                                | 102/500 [00:22<01:25,  4.68it/s]


 21%|████████▍                                | 103/500 [00:22<01:25,  4.62it/s]


 21%|████████▌                                | 104/500 [00:22<01:24,  4.67it/s]


 21%|████████▌                                | 105/500 [00:22<01:26,  4.56it/s]


 21%|████████▋                                | 106/500 [00:22<01:24,  4.64it/s]


 21%|████████▊                                | 107/500 [00:23<01:24,  4.62it/s]


 22%|████████▊                                | 108/500 [00:23<01:23,  4.69it/s]


 22%|████████▉                                | 109/500 [00:23<01:23,  4.69it/s]


 22%|█████████                                | 110/500 [00:23<01:22,  4.73it/s]


 22%|█████████                                | 111/500 [00:23<01:22,  4.74it/s]


 22%|█████████▏                               | 112/500 [00:24<01:22,  4.69it/s]


 23%|█████████▎                               | 113/500 [00:24<01:25,  4.50it/s]


 23%|█████████▎                               | 114/500 [00:24<01:24,  4.56it/s]


 23%|█████████▍                               | 115/500 [00:24<01:24,  4.54it/s]


 23%|█████████▌                               | 116/500 [00:25<01:25,  4.51it/s]


 23%|█████████▌                               | 117/500 [00:25<01:25,  4.50it/s]


 24%|█████████▋                               | 118/500 [00:25<01:23,  4.55it/s]


 24%|█████████▊                               | 119/500 [00:25<01:23,  4.57it/s]


 24%|█████████▊                               | 120/500 [00:25<01:21,  4.64it/s]


 24%|█████████▉                               | 121/500 [00:26<01:20,  4.69it/s]


 24%|██████████                               | 122/500 [00:26<01:19,  4.74it/s]


 25%|██████████                               | 123/500 [00:26<01:19,  4.77it/s]


 25%|██████████▏                              | 124/500 [00:26<01:18,  4.79it/s]


 25%|██████████▎                              | 125/500 [00:26<01:18,  4.79it/s]


 25%|██████████▎                              | 126/500 [00:27<01:17,  4.80it/s]


 25%|██████████▍                              | 127/500 [00:27<01:18,  4.77it/s]


 26%|██████████▍                              | 128/500 [00:27<01:18,  4.74it/s]


 26%|██████████▌                              | 129/500 [00:27<01:18,  4.74it/s]


 26%|██████████▋                              | 130/500 [00:28<01:17,  4.78it/s]


 26%|██████████▋                              | 131/500 [00:28<01:16,  4.79it/s]


 26%|██████████▊                              | 132/500 [00:28<01:16,  4.82it/s]


 27%|██████████▉                              | 133/500 [00:28<01:16,  4.78it/s]


 27%|██████████▉                              | 134/500 [00:28<01:16,  4.79it/s]


 27%|███████████                              | 135/500 [00:29<01:16,  4.78it/s]


 27%|███████████▏                             | 136/500 [00:29<01:15,  4.80it/s]


 27%|███████████▏                             | 137/500 [00:29<01:17,  4.69it/s]


 28%|███████████▎                             | 138/500 [00:29<01:19,  4.57it/s]


 28%|███████████▍                             | 139/500 [00:29<01:19,  4.56it/s]


 28%|███████████▍                             | 140/500 [00:30<01:19,  4.54it/s]


 28%|███████████▌                             | 141/500 [00:30<01:19,  4.50it/s]


 28%|███████████▋                             | 142/500 [00:30<01:19,  4.49it/s]


 29%|███████████▋                             | 143/500 [00:30<01:19,  4.48it/s]


 29%|███████████▊                             | 144/500 [00:31<01:21,  4.36it/s]


 29%|███████████▉                             | 145/500 [00:31<01:26,  4.10it/s]


 29%|███████████▉                             | 146/500 [00:31<01:23,  4.22it/s]


 29%|████████████                             | 147/500 [00:31<01:21,  4.33it/s]


 30%|████████████▏                            | 148/500 [00:32<01:19,  4.44it/s]


 30%|████████████▏                            | 149/500 [00:32<01:19,  4.42it/s]


 30%|████████████▎                            | 150/500 [00:32<01:19,  4.39it/s]


 30%|████████████▍                            | 151/500 [00:32<01:18,  4.47it/s]


 30%|████████████▍                            | 152/500 [00:32<01:16,  4.54it/s]


 31%|████████████▌                            | 153/500 [00:33<01:17,  4.49it/s]


 31%|████████████▋                            | 154/500 [00:33<01:15,  4.57it/s]


 31%|████████████▋                            | 155/500 [00:33<01:15,  4.58it/s]


 31%|████████████▊                            | 156/500 [00:33<01:14,  4.65it/s]


 31%|████████████▊                            | 157/500 [00:33<01:13,  4.68it/s]


 32%|████████████▉                            | 158/500 [00:34<01:12,  4.71it/s]


 32%|█████████████                            | 159/500 [00:34<01:13,  4.64it/s]


 32%|█████████████                            | 160/500 [00:34<01:13,  4.65it/s]


 32%|█████████████▏                           | 161/500 [00:34<01:12,  4.66it/s]


 32%|█████████████▎                           | 162/500 [00:35<01:12,  4.69it/s]


 33%|█████████████▎                           | 163/500 [00:35<01:11,  4.70it/s]


 33%|█████████████▍                           | 164/500 [00:35<01:10,  4.76it/s]


 33%|█████████████▌                           | 165/500 [00:35<01:09,  4.79it/s]


 33%|█████████████▌                           | 166/500 [00:35<01:09,  4.79it/s]


 33%|█████████████▋                           | 167/500 [00:36<01:10,  4.75it/s]


 34%|█████████████▊                           | 168/500 [00:36<01:09,  4.75it/s]


 34%|█████████████▊                           | 169/500 [00:36<01:09,  4.77it/s]


 34%|█████████████▉                           | 170/500 [00:36<01:09,  4.75it/s]


 34%|██████████████                           | 171/500 [00:36<01:11,  4.63it/s]


 34%|██████████████                           | 172/500 [00:37<01:12,  4.55it/s]


 35%|██████████████▏                          | 173/500 [00:37<01:12,  4.48it/s]


 35%|██████████████▎                          | 174/500 [00:37<01:11,  4.57it/s]


 35%|██████████████▎                          | 175/500 [00:37<01:10,  4.64it/s]


 35%|██████████████▍                          | 176/500 [00:38<01:10,  4.60it/s]


 35%|██████████████▌                          | 177/500 [00:38<01:09,  4.62it/s]


 36%|██████████████▌                          | 178/500 [00:38<01:08,  4.70it/s]


 36%|██████████████▋                          | 179/500 [00:38<01:08,  4.70it/s]


 36%|██████████████▊                          | 180/500 [00:38<01:07,  4.73it/s]


 36%|██████████████▊                          | 181/500 [00:39<01:06,  4.77it/s]


 36%|██████████████▉                          | 182/500 [00:39<01:06,  4.80it/s]


 37%|███████████████                          | 183/500 [00:39<01:05,  4.82it/s]


 37%|███████████████                          | 184/500 [00:39<01:05,  4.79it/s]


 37%|███████████████▏                         | 185/500 [00:39<01:05,  4.80it/s]


 37%|███████████████▎                         | 186/500 [00:40<01:05,  4.79it/s]


 37%|███████████████▎                         | 187/500 [00:40<01:06,  4.71it/s]


 38%|███████████████▍                         | 188/500 [00:40<01:06,  4.70it/s]


 38%|███████████████▍                         | 189/500 [00:40<01:07,  4.63it/s]


 38%|███████████████▌                         | 190/500 [00:40<01:06,  4.66it/s]


 38%|███████████████▋                         | 191/500 [00:41<01:05,  4.69it/s]


 38%|███████████████▋                         | 192/500 [00:41<01:06,  4.65it/s]


 39%|███████████████▊                         | 193/500 [00:41<01:05,  4.66it/s]


 39%|███████████████▉                         | 194/500 [00:41<01:05,  4.66it/s]


 39%|███████████████▉                         | 195/500 [00:42<01:05,  4.64it/s]


 39%|████████████████                         | 196/500 [00:42<01:05,  4.65it/s]


 39%|████████████████▏                        | 197/500 [00:42<01:04,  4.69it/s]


 40%|████████████████▏                        | 198/500 [00:42<01:04,  4.67it/s]


 40%|████████████████▎                        | 199/500 [00:42<01:04,  4.70it/s]


 40%|████████████████▍                        | 200/500 [00:43<01:03,  4.72it/s]


 40%|████████████████▍                        | 201/500 [00:43<01:02,  4.75it/s]


 40%|████████████████▌                        | 202/500 [00:43<01:03,  4.72it/s]


 41%|████████████████▋                        | 203/500 [00:43<01:02,  4.74it/s]


 41%|████████████████▋                        | 204/500 [00:43<01:02,  4.73it/s]


 41%|████████████████▊                        | 205/500 [00:44<01:02,  4.74it/s]


 41%|████████████████▉                        | 206/500 [00:44<01:01,  4.75it/s]


 41%|████████████████▉                        | 207/500 [00:44<01:01,  4.77it/s]


 42%|█████████████████                        | 208/500 [00:44<01:01,  4.71it/s]


 42%|█████████████████▏                       | 209/500 [00:45<01:01,  4.72it/s]


 42%|█████████████████▏                       | 210/500 [00:45<01:01,  4.71it/s]


 42%|█████████████████▎                       | 211/500 [00:45<01:01,  4.73it/s]


 42%|█████████████████▍                       | 212/500 [00:45<01:01,  4.68it/s]


 43%|█████████████████▍                       | 213/500 [00:45<01:01,  4.67it/s]


 43%|█████████████████▌                       | 214/500 [00:46<01:00,  4.70it/s]


 43%|█████████████████▋                       | 215/500 [00:46<01:00,  4.73it/s]


 43%|█████████████████▋                       | 216/500 [00:46<00:59,  4.75it/s]


 43%|█████████████████▊                       | 217/500 [00:46<00:59,  4.73it/s]


 44%|█████████████████▉                       | 218/500 [00:46<01:00,  4.66it/s]


 44%|█████████████████▉                       | 219/500 [00:47<01:00,  4.67it/s]


 44%|██████████████████                       | 220/500 [00:47<01:00,  4.66it/s]


 44%|██████████████████                       | 221/500 [00:47<01:00,  4.61it/s]


 44%|██████████████████▏                      | 222/500 [00:47<01:00,  4.58it/s]


 45%|██████████████████▎                      | 223/500 [00:48<01:00,  4.54it/s]


 45%|██████████████████▎                      | 224/500 [00:48<01:01,  4.46it/s]


 45%|██████████████████▍                      | 225/500 [00:48<01:01,  4.50it/s]


 45%|██████████████████▌                      | 226/500 [00:48<01:01,  4.44it/s]


 45%|██████████████████▌                      | 227/500 [00:48<01:01,  4.46it/s]


 46%|██████████████████▋                      | 228/500 [00:49<01:00,  4.49it/s]


 46%|██████████████████▊                      | 229/500 [00:49<01:00,  4.51it/s]


 46%|██████████████████▊                      | 230/500 [00:49<00:59,  4.52it/s]


 46%|██████████████████▉                      | 231/500 [00:49<01:00,  4.42it/s]


 46%|███████████████████                      | 232/500 [00:50<01:00,  4.45it/s]


 47%|███████████████████                      | 233/500 [00:50<00:59,  4.48it/s]


 47%|███████████████████▏                     | 234/500 [00:50<00:58,  4.51it/s]


 47%|███████████████████▎                     | 235/500 [00:50<00:58,  4.51it/s]


 47%|███████████████████▎                     | 236/500 [00:50<00:58,  4.54it/s]


 47%|███████████████████▍                     | 237/500 [00:51<00:58,  4.53it/s]


 48%|███████████████████▌                     | 238/500 [00:51<00:58,  4.50it/s]


 48%|███████████████████▌                     | 239/500 [00:51<00:58,  4.44it/s]


 48%|███████████████████▋                     | 240/500 [00:51<00:59,  4.40it/s]


 48%|███████████████████▊                     | 241/500 [00:52<00:57,  4.47it/s]


 48%|███████████████████▊                     | 242/500 [00:52<00:56,  4.56it/s]


 49%|███████████████████▉                     | 243/500 [00:52<00:55,  4.62it/s]


 49%|████████████████████                     | 244/500 [00:52<00:55,  4.65it/s]


 49%|████████████████████                     | 245/500 [00:52<00:54,  4.69it/s]


 49%|████████████████████▏                    | 246/500 [00:53<00:54,  4.68it/s]


 49%|████████████████████▎                    | 247/500 [00:53<00:53,  4.71it/s]


 50%|████████████████████▎                    | 248/500 [00:53<00:53,  4.73it/s]


 50%|████████████████████▍                    | 249/500 [00:53<00:52,  4.74it/s]


 50%|████████████████████▌                    | 250/500 [00:53<00:52,  4.75it/s]


 50%|████████████████████▌                    | 251/500 [00:54<00:52,  4.74it/s]


 50%|████████████████████▋                    | 252/500 [00:54<00:52,  4.70it/s]


 51%|████████████████████▋                    | 253/500 [00:54<00:53,  4.63it/s]


 51%|████████████████████▊                    | 254/500 [00:54<00:53,  4.63it/s]


 51%|████████████████████▉                    | 255/500 [00:55<00:52,  4.65it/s]


 51%|████████████████████▉                    | 256/500 [00:55<00:52,  4.66it/s]


 51%|█████████████████████                    | 257/500 [00:55<00:51,  4.68it/s]


 52%|█████████████████████▏                   | 258/500 [00:55<00:51,  4.70it/s]


 52%|█████████████████████▏                   | 259/500 [00:55<00:51,  4.71it/s]


 52%|█████████████████████▎                   | 260/500 [00:56<00:51,  4.67it/s]


 52%|█████████████████████▍                   | 261/500 [00:56<00:50,  4.70it/s]


 52%|█████████████████████▍                   | 262/500 [00:56<00:50,  4.73it/s]


 53%|█████████████████████▌                   | 263/500 [00:56<00:50,  4.72it/s]


 53%|█████████████████████▋                   | 264/500 [00:56<00:49,  4.73it/s]


 53%|█████████████████████▋                   | 265/500 [00:57<00:49,  4.76it/s]


 53%|█████████████████████▊                   | 266/500 [00:57<00:48,  4.78it/s]


 53%|█████████████████████▉                   | 267/500 [00:57<00:48,  4.79it/s]


 54%|█████████████████████▉                   | 268/500 [00:57<00:49,  4.68it/s]


 54%|██████████████████████                   | 269/500 [00:58<00:50,  4.55it/s]


 54%|██████████████████████▏                  | 270/500 [00:58<00:51,  4.47it/s]


 54%|██████████████████████▏                  | 271/500 [00:58<00:51,  4.41it/s]


 54%|██████████████████████▎                  | 272/500 [00:58<00:50,  4.51it/s]


 55%|██████████████████████▍                  | 273/500 [00:58<00:49,  4.59it/s]


 55%|██████████████████████▍                  | 274/500 [00:59<00:49,  4.61it/s]


 55%|██████████████████████▌                  | 275/500 [00:59<00:48,  4.67it/s]


 55%|██████████████████████▋                  | 276/500 [00:59<00:47,  4.68it/s]


 55%|██████████████████████▋                  | 277/500 [00:59<00:47,  4.71it/s]


 56%|██████████████████████▊                  | 278/500 [00:59<00:47,  4.70it/s]


 56%|██████████████████████▉                  | 279/500 [01:00<00:46,  4.71it/s]


 56%|██████████████████████▉                  | 280/500 [01:00<00:46,  4.72it/s]


 56%|███████████████████████                  | 281/500 [01:00<00:46,  4.75it/s]


 56%|███████████████████████                  | 282/500 [01:00<00:45,  4.74it/s]


 57%|███████████████████████▏                 | 283/500 [01:01<00:45,  4.76it/s]


 57%|███████████████████████▎                 | 284/500 [01:01<00:45,  4.77it/s]


 57%|███████████████████████▎                 | 285/500 [01:01<00:45,  4.75it/s]


 57%|███████████████████████▍                 | 286/500 [01:01<00:45,  4.75it/s]


 57%|███████████████████████▌                 | 287/500 [01:01<00:44,  4.74it/s]


 58%|███████████████████████▌                 | 288/500 [01:02<00:44,  4.75it/s]


 58%|███████████████████████▋                 | 289/500 [01:02<00:44,  4.78it/s]


 58%|███████████████████████▊                 | 290/500 [01:02<00:44,  4.75it/s]


 58%|███████████████████████▊                 | 291/500 [01:02<00:44,  4.73it/s]


 58%|███████████████████████▉                 | 292/500 [01:02<00:44,  4.71it/s]


 59%|████████████████████████                 | 293/500 [01:03<00:44,  4.62it/s]


 59%|████████████████████████                 | 294/500 [01:03<00:45,  4.57it/s]


 59%|████████████████████████▏                | 295/500 [01:03<00:45,  4.53it/s]


 59%|████████████████████████▎                | 296/500 [01:03<00:44,  4.60it/s]


 59%|████████████████████████▎                | 297/500 [01:04<00:44,  4.59it/s]


 60%|████████████████████████▍                | 298/500 [01:04<00:44,  4.51it/s]


 60%|████████████████████████▌                | 299/500 [01:04<00:46,  4.35it/s]


 60%|████████████████████████▌                | 300/500 [01:04<00:45,  4.35it/s]


 60%|████████████████████████▋                | 301/500 [01:04<00:44,  4.47it/s]


 60%|████████████████████████▊                | 302/500 [01:05<00:43,  4.52it/s]


 61%|████████████████████████▊                | 303/500 [01:05<00:42,  4.60it/s]


 61%|████████████████████████▉                | 304/500 [01:05<00:42,  4.65it/s]


 61%|█████████████████████████                | 305/500 [01:05<00:41,  4.71it/s]


 61%|█████████████████████████                | 306/500 [01:06<00:41,  4.66it/s]


 61%|█████████████████████████▏               | 307/500 [01:06<00:41,  4.66it/s]


 62%|█████████████████████████▎               | 308/500 [01:06<00:41,  4.66it/s]


 62%|█████████████████████████▎               | 309/500 [01:06<00:41,  4.65it/s]


 62%|█████████████████████████▍               | 310/500 [01:06<00:40,  4.67it/s]


 62%|█████████████████████████▌               | 311/500 [01:07<00:40,  4.66it/s]


 62%|█████████████████████████▌               | 312/500 [01:07<00:40,  4.67it/s]


 63%|█████████████████████████▋               | 313/500 [01:07<00:40,  4.67it/s]


 63%|█████████████████████████▋               | 314/500 [01:07<00:39,  4.71it/s]


 63%|█████████████████████████▊               | 315/500 [01:07<00:39,  4.74it/s]


 63%|█████████████████████████▉               | 316/500 [01:08<00:39,  4.60it/s]


 63%|█████████████████████████▉               | 317/500 [01:08<00:39,  4.64it/s]


 64%|██████████████████████████               | 318/500 [01:08<00:39,  4.65it/s]


 64%|██████████████████████████▏              | 319/500 [01:08<00:38,  4.65it/s]


 64%|██████████████████████████▏              | 320/500 [01:09<00:38,  4.68it/s]


 64%|██████████████████████████▎              | 321/500 [01:09<00:38,  4.68it/s]


 64%|██████████████████████████▍              | 322/500 [01:09<00:37,  4.69it/s]


 65%|██████████████████████████▍              | 323/500 [01:09<00:37,  4.74it/s]


 65%|██████████████████████████▌              | 324/500 [01:09<00:37,  4.75it/s]


 65%|██████████████████████████▋              | 325/500 [01:10<00:36,  4.74it/s]


 65%|██████████████████████████▋              | 326/500 [01:10<00:36,  4.73it/s]


 65%|██████████████████████████▊              | 327/500 [01:10<00:36,  4.76it/s]


 66%|██████████████████████████▉              | 328/500 [01:10<00:36,  4.75it/s]


 66%|██████████████████████████▉              | 329/500 [01:10<00:36,  4.75it/s]


 66%|███████████████████████████              | 330/500 [01:11<00:35,  4.74it/s]


 66%|███████████████████████████▏             | 331/500 [01:11<00:35,  4.77it/s]


 66%|███████████████████████████▏             | 332/500 [01:11<00:35,  4.68it/s]


 67%|███████████████████████████▎             | 333/500 [01:11<00:35,  4.67it/s]['tile', 0.9898989898989898, 0.9408087566201664, 0.8471429799146201]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 5/5 for wood




| feature extraction | train | wood |:   0%|              | 0/8 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:




| feature extraction | train | wood |:  12%|▊     | 1/8 [00:01<00:13,  1.88s/it]



| feature extraction | train | wood |:  25%|█▌    | 2/8 [00:03<00:11,  1.88s/it]



| feature extraction | train | wood |:  38%|██▎   | 3/8 [00:05<00:09,  1.88s/it]



| feature extraction | train | wood |:  50%|███   | 4/8 [00:07<00:07,  1.89s/it]



| feature extraction | train | wood |:  62%|███▊  | 5/8 [00:09<00:05,  1.85s/it]



| feature extraction | train | wood |:  75%|████▌ | 6/8 [00:11<00:03,  1.86s/it]



| feature extraction | train | wood |:  88%|█████▎| 7/8 [00:13<00:01,  1.86s/it]



| feature extraction | train | wood |: 100%|██████| 8/8 [00:14<00:00,  1.79s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [25292, 384].
2022-04-22 18:34:01	Train ends, total 98.31s
Saving model...
2022-04-22 18:34:01	Save model in ./output/coreset_resnet18_10/wood.pdparams
2022-04-22 18:34:01	Starting eval model...




| feature extraction | test | wood |:   0%|              | 0/79 [00:00<?, ?it/s]



| feature extraction | test | wood |:   1%|      | 1/79 [00:00<00:28,  2.75it/s]



| feature extraction | test | wood |:   3%|▏     | 2/79 [00:00<00:26,  2.92it/s]



| feature extraction | test | wood |:   4%|▏     | 3/79 [00:00<00:24,  3.05it/s]



| feature extraction | test | wood |:   5%|▎     | 4/79 [00:01<00:23,  3.14it/s]



| feature extraction | test | wood |:   6%|▍     | 5/79 [00:01<00:23,  3.21it/s]



| feature extraction | test | wood |:   8%|▍     | 6/79 [00:01<00:22,  3.26it/s]



| feature extraction | test | wood |:   9%|▌     | 7/79 [00:02<00:21,  3.29it/s]



| feature extraction | test | wood |:  10%|▌     | 8/79 [00:02<00:21,  3.32it/s]



| feature extraction | test | wood |:  11%|▋     | 9/79 [00:02<00:20,  3.34it/s]



| feature extraction | test | wood |:  13%|▋    | 10/79 [00:03<00:20,  3.35it/s]



| feature extraction | test | wood |:  14%|▋    | 11/79 [00:03<00:20,  3.36it/s]



| feature extraction | test | wood |:  15%|▊    | 12/79 [00:03<00:19,  3.36it/s]



| feature extraction | test | wood |:  16%|▊    | 13/79 [00:03<00:19,  3.37it/s]



| feature extraction | test | wood |:  18%|▉    | 14/79 [00:04<00:19,  3.38it/s]



| feature extraction | test | wood |:  19%|▉    | 15/79 [00:04<00:18,  3.38it/s]



| feature extraction | test | wood |:  20%|█    | 16/79 [00:04<00:18,  3.38it/s]



| feature extraction | test | wood |:  22%|█    | 17/79 [00:05<00:18,  3.38it/s]



| feature extraction | test | wood |:  23%|█▏   | 18/79 [00:05<00:18,  3.39it/s]



| feature extraction | test | wood |:  24%|█▏   | 19/79 [00:05<00:17,  3.39it/s]



| feature extraction | test | wood |:  25%|█▎   | 20/79 [00:05<00:17,  3.39it/s]



| feature extraction | test | wood |:  27%|█▎   | 21/79 [00:06<00:17,  3.39it/s]



| feature extraction | test | wood |:  28%|█▍   | 22/79 [00:06<00:16,  3.39it/s]



| feature extraction | test | wood |:  29%|█▍   | 23/79 [00:06<00:16,  3.39it/s]



| feature extraction | test | wood |:  30%|█▌   | 24/79 [00:07<00:16,  3.38it/s]



| feature extraction | test | wood |:  32%|█▌   | 25/79 [00:07<00:15,  3.38it/s]



| feature extraction | test | wood |:  33%|█▋   | 26/79 [00:07<00:15,  3.38it/s]



| feature extraction | test | wood |:  34%|█▋   | 27/79 [00:08<00:15,  3.38it/s]



| feature extraction | test | wood |:  35%|█▊   | 28/79 [00:08<00:15,  3.39it/s]



| feature extraction | test | wood |:  37%|█▊   | 29/79 [00:08<00:14,  3.39it/s]



| feature extraction | test | wood |:  38%|█▉   | 30/79 [00:08<00:14,  3.40it/s]



| feature extraction | test | wood |:  39%|█▉   | 31/79 [00:09<00:14,  3.40it/s]



| feature extraction | test | wood |:  41%|██   | 32/79 [00:09<00:13,  3.39it/s]



| feature extraction | test | wood |:  42%|██   | 33/79 [00:09<00:13,  3.39it/s]



| feature extraction | test | wood |:  43%|██▏  | 34/79 [00:10<00:13,  3.40it/s]



| feature extraction | test | wood |:  44%|██▏  | 35/79 [00:10<00:12,  3.39it/s]



| feature extraction | test | wood |:  46%|██▎  | 36/79 [00:10<00:12,  3.39it/s]



| feature extraction | test | wood |:  47%|██▎  | 37/79 [00:10<00:12,  3.39it/s]



| feature extraction | test | wood |:  48%|██▍  | 38/79 [00:11<00:12,  3.40it/s]



| feature extraction | test | wood |:  49%|██▍  | 39/79 [00:11<00:11,  3.39it/s]



| feature extraction | test | wood |:  51%|██▌  | 40/79 [00:11<00:11,  3.39it/s]



| feature extraction | test | wood |:  52%|██▌  | 41/79 [00:12<00:11,  3.38it/s]



| feature extraction | test | wood |:  53%|██▋  | 42/79 [00:12<00:10,  3.38it/s]



| feature extraction | test | wood |:  54%|██▋  | 43/79 [00:12<00:10,  3.38it/s]



| feature extraction | test | wood |:  56%|██▊  | 44/79 [00:13<00:10,  3.36it/s]



| feature extraction | test | wood |:  57%|██▊  | 45/79 [00:13<00:10,  3.35it/s]



| feature extraction | test | wood |:  58%|██▉  | 46/79 [00:13<00:09,  3.33it/s]



| feature extraction | test | wood |:  59%|██▉  | 47/79 [00:13<00:09,  3.34it/s]



| feature extraction | test | wood |:  61%|███  | 48/79 [00:14<00:09,  3.35it/s]



| feature extraction | test | wood |:  62%|███  | 49/79 [00:14<00:08,  3.36it/s]



| feature extraction | test | wood |:  63%|███▏ | 50/79 [00:14<00:08,  3.37it/s]



| feature extraction | test | wood |:  65%|███▏ | 51/79 [00:15<00:08,  3.38it/s]



| feature extraction | test | wood |:  66%|███▎ | 52/79 [00:15<00:07,  3.38it/s]



| feature extraction | test | wood |:  67%|███▎ | 53/79 [00:15<00:07,  3.38it/s]



| feature extraction | test | wood |:  68%|███▍ | 54/79 [00:16<00:07,  3.39it/s]



| feature extraction | test | wood |:  70%|███▍ | 55/79 [00:16<00:07,  3.39it/s]



| feature extraction | test | wood |:  71%|███▌ | 56/79 [00:16<00:06,  3.39it/s]



| feature extraction | test | wood |:  72%|███▌ | 57/79 [00:16<00:06,  3.39it/s]



| feature extraction | test | wood |:  73%|███▋ | 58/79 [00:17<00:06,  3.40it/s]



| feature extraction | test | wood |:  75%|███▋ | 59/79 [00:17<00:05,  3.39it/s]



| feature extraction | test | wood |:  76%|███▊ | 60/79 [00:17<00:05,  3.39it/s]



| feature extraction | test | wood |:  77%|███▊ | 61/79 [00:18<00:05,  3.38it/s]



| feature extraction | test | wood |:  78%|███▉ | 62/79 [00:18<00:05,  3.38it/s]



| feature extraction | test | wood |:  80%|███▉ | 63/79 [00:18<00:04,  3.38it/s]



| feature extraction | test | wood |:  81%|████ | 64/79 [00:18<00:04,  3.39it/s]



| feature extraction | test | wood |:  82%|████ | 65/79 [00:19<00:04,  3.38it/s]



| feature extraction | test | wood |:  84%|████▏| 66/79 [00:19<00:03,  3.39it/s]



| feature extraction | test | wood |:  85%|████▏| 67/79 [00:19<00:03,  3.38it/s]



| feature extraction | test | wood |:  86%|████▎| 68/79 [00:20<00:03,  3.39it/s]



| feature extraction | test | wood |:  87%|████▎| 69/79 [00:20<00:02,  3.34it/s]



| feature extraction | test | wood |:  89%|████▍| 70/79 [00:20<00:02,  3.27it/s]



| feature extraction | test | wood |:  90%|████▍| 71/79 [00:21<00:02,  3.30it/s]



| feature extraction | test | wood |:  91%|████▌| 72/79 [00:21<00:02,  3.30it/s]



| feature extraction | test | wood |:  92%|████▌| 73/79 [00:21<00:01,  3.31it/s]



| feature extraction | test | wood |:  94%|████▋| 74/79 [00:21<00:01,  3.34it/s]



| feature extraction | test | wood |:  95%|████▋| 75/79 [00:22<00:01,  3.35it/s]



| feature extraction | test | wood |:  96%|████▊| 76/79 [00:22<00:00,  3.37it/s]



| feature extraction | test | wood |:  97%|████▊| 77/79 [00:22<00:00,  3.39it/s]



| feature extraction | test | wood |:  99%|████▉| 78/79 [00:23<00:00,  3.40it/s]



| feature extraction | test | wood |: 100%|█████| 79/79 [00:23<00:00,  3.37it/s]
max_score:4.235682010650635 min_score:0.8046085238456726
F1 image:0.967741935483871 threshold:4.235682010650635
F1 pixel:0.4187073402738571 threshold:4.235682010650635




  0%|                                                   | 0/500 [00:00<?, ?it/s]



  0%|                                           | 1/500 [00:00<00:56,  8.86it/s]



  0%|▏                                          | 2/500 [00:00<00:58,  8.59it/s]



  1%|▎                                          | 3/500 [00:00<00:57,  8.61it/s]



  1%|▎                                          | 4/500 [00:00<00:58,  8.42it/s]



  1%|▍                                          | 5/500 [00:00<00:58,  8.48it/s]



  1%|▌                                          | 6/500 [00:00<00:59,  8.28it/s]



  1%|▌                                          | 7/500 [00:00<00:58,  8.37it/s]



  2%|▋                                          | 8/500 [00:00<00:59,  8.22it/s]



  2%|▊                                          | 9/500 [00:01<00:59,  8.32it/s]



  2%|▊                                         | 10/500 [00:01<00:59,  8.18it/s]



  2%|▉                                         | 11/500 [00:01<00:58,  8.30it/s]



  2%|█                                         | 12/500 [00:01<00:59,  8.15it/s]



  3%|█                                         | 13/500 [00:01<00:58,  8.27it/s]



  3%|█▏                                        | 14/500 [00:01<00:59,  8.17it/s]



  3%|█▎                                        | 15/500 [00:01<00:58,  8.29it/s]



  3%|█▎                                        | 16/500 [00:01<00:59,  8.16it/s]



  3%|█▍                                        | 17/500 [00:02<00:58,  8.25it/s]



  4%|█▌                                        | 18/500 [00:02<00:59,  8.10it/s]



  4%|█▌                                        | 19/500 [00:02<00:58,  8.26it/s]



  4%|█▋                                        | 20/500 [00:02<00:58,  8.16it/s]



  4%|█▊                                        | 21/500 [00:02<00:57,  8.30it/s]



  4%|█▊                                        | 22/500 [00:02<00:58,  8.19it/s]



  5%|█▉                                        | 23/500 [00:02<00:57,  8.32it/s]



  5%|██                                        | 24/500 [00:02<00:57,  8.22it/s]



  5%|██                                        | 25/500 [00:03<00:56,  8.33it/s]



  5%|██▏                                       | 26/500 [00:03<00:57,  8.23it/s]



  5%|██▎                                       | 27/500 [00:03<00:56,  8.35it/s]



  6%|██▎                                       | 28/500 [00:03<00:59,  7.96it/s]



  6%|██▍                                       | 29/500 [00:03<00:57,  8.15it/s]



  6%|██▌                                       | 30/500 [00:03<00:58,  8.10it/s]



  6%|██▌                                       | 31/500 [00:03<00:56,  8.24it/s]



  6%|██▋                                       | 32/500 [00:03<00:57,  8.11it/s]



  7%|██▊                                       | 33/500 [00:04<00:56,  8.25it/s]



  7%|██▊                                       | 34/500 [00:04<00:57,  8.15it/s]



  7%|██▉                                       | 35/500 [00:04<00:56,  8.29it/s]



  7%|███                                       | 36/500 [00:04<00:57,  8.12it/s]



  7%|███                                       | 37/500 [00:04<00:56,  8.24it/s]



  8%|███▏                                      | 38/500 [00:04<00:56,  8.14it/s]



  8%|███▎                                      | 39/500 [00:04<00:55,  8.26it/s]



  8%|███▎                                      | 40/500 [00:04<00:56,  8.14it/s]



  8%|███▍                                      | 41/500 [00:04<00:55,  8.27it/s]



  8%|███▌                                      | 42/500 [00:05<00:56,  8.17it/s]



  9%|███▌                                      | 43/500 [00:05<00:54,  8.31it/s]



  9%|███▋                                      | 44/500 [00:05<00:56,  8.14it/s]



  9%|███▊                                      | 45/500 [00:05<00:55,  8.27it/s]



  9%|███▊                                      | 46/500 [00:05<00:55,  8.11it/s]



  9%|███▉                                      | 47/500 [00:05<00:54,  8.24it/s]



 10%|████                                      | 48/500 [00:05<00:56,  8.02it/s]



 10%|████                                      | 49/500 [00:05<00:55,  8.16it/s]



 10%|████▏                                     | 50/500 [00:06<00:56,  8.02it/s]



 10%|████▎                                     | 51/500 [00:06<00:55,  8.15it/s]



 10%|████▎                                     | 52/500 [00:06<00:55,  8.00it/s]



 11%|████▍                                     | 53/500 [00:06<00:54,  8.14it/s]



 11%|████▌                                     | 54/500 [00:06<00:55,  8.00it/s]



 11%|████▌                                     | 55/500 [00:06<00:55,  8.09it/s]



 11%|████▋                                     | 56/500 [00:06<00:55,  8.01it/s]



 11%|████▊                                     | 57/500 [00:06<00:54,  8.19it/s]



 12%|████▊                                     | 58/500 [00:07<00:54,  8.07it/s]



 12%|████▉                                     | 59/500 [00:07<00:53,  8.23it/s]



 12%|█████                                     | 60/500 [00:07<00:54,  8.08it/s]



 12%|█████                                     | 61/500 [00:07<00:53,  8.24it/s]



 12%|█████▏                                    | 62/500 [00:07<00:53,  8.15it/s]



 13%|█████▎                                    | 63/500 [00:07<00:53,  8.22it/s]



 13%|█████▍                                    | 64/500 [00:07<00:55,  7.81it/s]



 13%|█████▍                                    | 65/500 [00:07<00:55,  7.90it/s]



 13%|█████▌                                    | 66/500 [00:08<00:55,  7.79it/s]



 13%|█████▋                                    | 67/500 [00:08<00:56,  7.73it/s]



 14%|█████▋                                    | 68/500 [00:08<00:56,  7.63it/s]



 14%|█████▊                                    | 69/500 [00:08<00:54,  7.88it/s]



 14%|█████▉                                    | 70/500 [00:08<00:54,  7.86it/s]



 14%|█████▉                                    | 71/500 [00:08<00:53,  8.08it/s]



 14%|██████                                    | 72/500 [00:08<00:53,  8.00it/s]



 15%|██████▏                                   | 73/500 [00:08<00:52,  8.17it/s]



 15%|██████▏                                   | 74/500 [00:09<00:52,  8.06it/s]



 15%|██████▎                                   | 75/500 [00:09<00:51,  8.23it/s]



 15%|██████▍                                   | 76/500 [00:09<00:52,  8.06it/s]



 15%|██████▍                                   | 77/500 [00:09<00:51,  8.20it/s]



 16%|██████▌                                   | 78/500 [00:09<00:51,  8.16it/s]



 16%|██████▋                                   | 79/500 [00:09<00:50,  8.27it/s]



 16%|██████▋                                   | 80/500 [00:09<00:51,  8.21it/s]



 16%|██████▊                                   | 81/500 [00:09<00:50,  8.33it/s]



 16%|██████▉                                   | 82/500 [00:10<00:50,  8.20it/s]



 17%|██████▉                                   | 83/500 [00:10<00:50,  8.33it/s]



 17%|███████                                   | 84/500 [00:10<00:50,  8.21it/s]



 17%|███████▏                                  | 85/500 [00:10<00:49,  8.33it/s]



 17%|███████▏                                  | 86/500 [00:10<00:50,  8.23it/s]



 17%|███████▎                                  | 87/500 [00:10<00:49,  8.35it/s]



 18%|███████▍                                  | 88/500 [00:10<00:49,  8.24it/s]



 18%|███████▍                                  | 89/500 [00:10<00:49,  8.35it/s]



 18%|███████▌                                  | 90/500 [00:11<00:49,  8.24it/s]



 18%|███████▋                                  | 91/500 [00:11<00:48,  8.35it/s]



 18%|███████▋                                  | 92/500 [00:11<00:49,  8.25it/s]



 19%|███████▊                                  | 93/500 [00:11<00:48,  8.37it/s]



 19%|███████▉                                  | 94/500 [00:11<00:49,  8.24it/s]



 19%|███████▉                                  | 95/500 [00:11<00:48,  8.36it/s]



 19%|████████                                  | 96/500 [00:11<00:49,  8.24it/s]



 19%|████████▏                                 | 97/500 [00:11<00:48,  8.37it/s]



 20%|████████▏                                 | 98/500 [00:11<00:48,  8.25it/s]



 20%|████████▎                                 | 99/500 [00:12<00:47,  8.37it/s]



 20%|████████▏                                | 100/500 [00:12<00:48,  8.23it/s]



 20%|████████▎                                | 101/500 [00:12<00:47,  8.34it/s]



 20%|████████▎                                | 102/500 [00:12<00:48,  8.24it/s]



 21%|████████▍                                | 103/500 [00:12<00:47,  8.35it/s]



 21%|████████▌                                | 104/500 [00:12<00:48,  8.24it/s]



 21%|████████▌                                | 105/500 [00:12<00:47,  8.36it/s]



 21%|████████▋                                | 106/500 [00:12<00:48,  8.19it/s]



 21%|████████▊                                | 107/500 [00:13<00:47,  8.33it/s]



 22%|████████▊                                | 108/500 [00:13<00:47,  8.19it/s]



 22%|████████▉                                | 109/500 [00:13<00:46,  8.33it/s]



 22%|█████████                                | 110/500 [00:13<00:47,  8.18it/s]



 22%|█████████                                | 111/500 [00:13<00:46,  8.30it/s]



 22%|█████████▏                               | 112/500 [00:13<00:47,  8.18it/s]



 23%|█████████▎                               | 113/500 [00:13<00:46,  8.30it/s]



 23%|█████████▎                               | 114/500 [00:13<00:47,  8.14it/s]



 23%|█████████▍                               | 115/500 [00:14<00:46,  8.28it/s]



 23%|█████████▌                               | 116/500 [00:14<00:47,  8.15it/s]



 23%|█████████▌                               | 117/500 [00:14<00:46,  8.28it/s]



 24%|█████████▋                               | 118/500 [00:14<00:46,  8.13it/s]



 24%|█████████▊                               | 119/500 [00:14<00:46,  8.26it/s]



 24%|█████████▊                               | 120/500 [00:14<00:46,  8.16it/s]



 24%|█████████▉                               | 121/500 [00:14<00:45,  8.30it/s]



 24%|██████████                               | 122/500 [00:14<00:46,  8.19it/s]



 25%|██████████                               | 123/500 [00:15<00:45,  8.29it/s]



 25%|██████████▏                              | 124/500 [00:15<00:46,  8.16it/s]



 25%|██████████▎                              | 125/500 [00:15<00:45,  8.30it/s]



 25%|██████████▎                              | 126/500 [00:15<00:46,  8.13it/s]



 25%|██████████▍                              | 127/500 [00:15<00:45,  8.26it/s]



 26%|██████████▍                              | 128/500 [00:15<00:45,  8.11it/s]



 26%|██████████▌                              | 129/500 [00:15<00:44,  8.24it/s]



 26%|██████████▋                              | 130/500 [00:15<00:45,  8.06it/s]



 26%|██████████▋                              | 131/500 [00:15<00:44,  8.21it/s]



 26%|██████████▊                              | 132/500 [00:16<00:45,  8.09it/s]



 27%|██████████▉                              | 133/500 [00:16<00:44,  8.23it/s]



 27%|██████████▉                              | 134/500 [00:16<00:45,  8.09it/s]



 27%|███████████                              | 135/500 [00:16<00:44,  8.23it/s]



 27%|███████████▏                             | 136/500 [00:16<00:44,  8.12it/s]



 27%|███████████▏                             | 137/500 [00:16<00:43,  8.26it/s]



 28%|███████████▎                             | 138/500 [00:16<00:44,  8.12it/s]



 28%|███████████▍                             | 139/500 [00:16<00:43,  8.26it/s]



 28%|███████████▍                             | 140/500 [00:17<00:44,  8.12it/s]



 28%|███████████▌                             | 141/500 [00:17<00:43,  8.26it/s]



 28%|███████████▋                             | 142/500 [00:17<00:44,  8.12it/s]



 29%|███████████▋                             | 143/500 [00:17<00:43,  8.25it/s]



 29%|███████████▊                             | 144/500 [00:17<00:43,  8.11it/s]



 29%|███████████▉                             | 145/500 [00:17<00:42,  8.26it/s]



 29%|███████████▉                             | 146/500 [00:17<00:43,  8.12it/s]



 29%|████████████                             | 147/500 [00:17<00:42,  8.25it/s]



 30%|████████████▏                            | 148/500 [00:18<00:43,  8.10it/s]



 30%|████████████▏                            | 149/500 [00:18<00:42,  8.23it/s]



 30%|████████████▎                            | 150/500 [00:18<00:43,  8.10it/s]



 30%|████████████▍                            | 151/500 [00:18<00:42,  8.23it/s]



 30%|████████████▍                            | 152/500 [00:18<00:42,  8.10it/s]



 31%|████████████▌                            | 153/500 [00:18<00:42,  8.23it/s]



 31%|████████████▋                            | 154/500 [00:18<00:42,  8.12it/s]



 31%|████████████▋                            | 155/500 [00:18<00:41,  8.26it/s]



 31%|████████████▊                            | 156/500 [00:19<00:42,  8.14it/s]



 31%|████████████▊                            | 157/500 [00:19<00:41,  8.25it/s]



 32%|████████████▉                            | 158/500 [00:19<00:42,  8.13it/s]



 32%|█████████████                            | 159/500 [00:19<00:41,  8.26it/s]



 32%|█████████████                            | 160/500 [00:19<00:41,  8.13it/s]



 32%|█████████████▏                           | 161/500 [00:19<00:41,  8.27it/s]



 32%|█████████████▎                           | 162/500 [00:19<00:41,  8.13it/s]



 33%|█████████████▎                           | 163/500 [00:19<00:40,  8.26it/s]



 33%|█████████████▍                           | 164/500 [00:20<00:41,  8.17it/s]



 33%|█████████████▌                           | 165/500 [00:20<00:40,  8.31it/s]



 33%|█████████████▌                           | 166/500 [00:20<00:40,  8.17it/s]



 33%|█████████████▋                           | 167/500 [00:20<00:40,  8.31it/s]



 34%|█████████████▊                           | 168/500 [00:20<00:40,  8.20it/s]



 34%|█████████████▊                           | 169/500 [00:20<00:39,  8.34it/s]



 34%|█████████████▉                           | 170/500 [00:20<00:40,  8.20it/s]



 34%|██████████████                           | 171/500 [00:20<00:39,  8.29it/s]



 34%|██████████████                           | 172/500 [00:21<00:40,  8.12it/s]



 35%|██████████████▏                          | 173/500 [00:21<00:39,  8.23it/s]



 35%|██████████████▎                          | 174/500 [00:21<00:40,  8.12it/s]



 35%|██████████████▎                          | 175/500 [00:21<00:39,  8.23it/s]



 35%|██████████████▍                          | 176/500 [00:21<00:39,  8.11it/s]



 35%|██████████████▌                          | 177/500 [00:21<00:39,  8.26it/s]



 36%|██████████████▌                          | 178/500 [00:21<00:39,  8.17it/s]



 36%|██████████████▋                          | 179/500 [00:21<00:38,  8.31it/s]



 36%|██████████████▊                          | 180/500 [00:21<00:38,  8.21it/s]



 36%|██████████████▊                          | 181/500 [00:22<00:38,  8.34it/s]



 36%|██████████████▉                          | 182/500 [00:22<00:38,  8.21it/s]



 37%|███████████████                          | 183/500 [00:22<00:38,  8.32it/s]



 37%|███████████████                          | 184/500 [00:22<00:38,  8.19it/s]



 37%|███████████████▏                         | 185/500 [00:22<00:37,  8.33it/s]



 37%|███████████████▎                         | 186/500 [00:22<00:38,  8.22it/s]



 37%|███████████████▎                         | 187/500 [00:22<00:37,  8.34it/s]



 38%|███████████████▍                         | 188/500 [00:22<00:37,  8.22it/s]



 38%|███████████████▍                         | 189/500 [00:23<00:37,  8.33it/s]



 38%|███████████████▌                         | 190/500 [00:23<00:37,  8.21it/s]



 38%|███████████████▋                         | 191/500 [00:23<00:37,  8.34it/s]



 38%|███████████████▋                         | 192/500 [00:23<00:37,  8.22it/s]



 39%|███████████████▊                         | 193/500 [00:23<00:38,  8.04it/s]



 39%|███████████████▉                         | 194/500 [00:23<00:38,  7.98it/s]



 39%|███████████████▉                         | 195/500 [00:23<00:37,  8.14it/s]



 39%|████████████████                         | 196/500 [00:23<00:37,  8.05it/s]



 39%|████████████████▏                        | 197/500 [00:24<00:36,  8.20it/s]



 40%|████████████████▏                        | 198/500 [00:24<00:37,  8.09it/s]



 40%|████████████████▎                        | 199/500 [00:24<00:36,  8.23it/s]



 40%|████████████████▍                        | 200/500 [00:24<00:37,  8.03it/s]



 40%|████████████████▍                        | 201/500 [00:24<00:36,  8.17it/s]



 40%|████████████████▌                        | 202/500 [00:24<00:36,  8.06it/s]



 41%|████████████████▋                        | 203/500 [00:24<00:36,  8.19it/s]



 41%|████████████████▋                        | 204/500 [00:24<00:36,  8.09it/s]



 41%|████████████████▊                        | 205/500 [00:25<00:35,  8.20it/s]



 41%|████████████████▉                        | 206/500 [00:25<00:36,  8.07it/s]



 41%|████████████████▉                        | 207/500 [00:25<00:35,  8.20it/s]



 42%|█████████████████                        | 208/500 [00:25<00:36,  7.95it/s]



 42%|█████████████████▏                       | 209/500 [00:25<00:35,  8.12it/s]



 42%|█████████████████▏                       | 210/500 [00:25<00:36,  7.98it/s]



 42%|█████████████████▎                       | 211/500 [00:25<00:35,  8.16it/s]



 42%|█████████████████▍                       | 212/500 [00:25<00:35,  8.03it/s]



 43%|█████████████████▍                       | 213/500 [00:26<00:35,  8.20it/s]



 43%|█████████████████▌                       | 214/500 [00:26<00:35,  8.04it/s]



 43%|█████████████████▋                       | 215/500 [00:26<00:34,  8.20it/s]



 43%|█████████████████▋                       | 216/500 [00:26<00:35,  8.06it/s]



 43%|█████████████████▊                       | 217/500 [00:26<00:34,  8.20it/s]



 44%|█████████████████▉                       | 218/500 [00:26<00:34,  8.07it/s]



 44%|█████████████████▉                       | 219/500 [00:26<00:34,  8.21it/s]



 44%|██████████████████                       | 220/500 [00:26<00:34,  8.05it/s]



 44%|██████████████████                       | 221/500 [00:26<00:34,  8.19it/s]



 44%|██████████████████▏                      | 222/500 [00:27<00:34,  8.01it/s]



 45%|██████████████████▎                      | 223/500 [00:27<00:33,  8.17it/s]



 45%|██████████████████▎                      | 224/500 [00:27<00:34,  7.99it/s]



 45%|██████████████████▍                      | 225/500 [00:27<00:33,  8.16it/s]



 45%|██████████████████▌                      | 226/500 [00:27<00:34,  8.04it/s]



 45%|██████████████████▌                      | 227/500 [00:27<00:33,  8.20it/s]



 46%|██████████████████▋                      | 228/500 [00:27<00:33,  8.05it/s]



 46%|██████████████████▊                      | 229/500 [00:27<00:33,  8.20it/s]



 46%|██████████████████▊                      | 230/500 [00:28<00:33,  8.05it/s]



 46%|██████████████████▉                      | 231/500 [00:28<00:32,  8.20it/s]



 46%|███████████████████                      | 232/500 [00:28<00:33,  8.06it/s]



 47%|███████████████████                      | 233/500 [00:28<00:32,  8.21it/s]



 47%|███████████████████▏                     | 234/500 [00:28<00:35,  7.51it/s]



 47%|███████████████████▎                     | 235/500 [00:28<00:39,  6.69it/s]



 47%|███████████████████▎                     | 236/500 [00:29<00:43,  6.08it/s]



 47%|███████████████████▍                     | 237/500 [00:29<00:45,  5.76it/s]



 48%|███████████████████▌                     | 238/500 [00:29<00:42,  6.10it/s]



 48%|███████████████████▌                     | 239/500 [00:29<00:39,  6.64it/s]



 48%|███████████████████▋                     | 240/500 [00:29<00:38,  6.78it/s]



 48%|███████████████████▊                     | 241/500 [00:29<00:35,  7.25it/s]



 48%|███████████████████▊                     | 242/500 [00:29<00:34,  7.40it/s]



 49%|███████████████████▉                     | 243/500 [00:29<00:33,  7.73it/s]



 49%|████████████████████                     | 244/500 [00:30<00:33,  7.71it/s]



 49%|████████████████████                     | 245/500 [00:30<00:32,  7.95it/s]



 49%|████████████████████▏                    | 246/500 [00:30<00:32,  7.89it/s]



 49%|████████████████████▎                    | 247/500 [00:30<00:31,  8.09it/s]



 50%|████████████████████▎                    | 248/500 [00:30<00:31,  7.96it/s]



 50%|████████████████████▍                    | 249/500 [00:30<00:30,  8.14it/s]



 50%|████████████████████▌                    | 250/500 [00:30<00:31,  7.99it/s]



 50%|████████████████████▌                    | 251/500 [00:30<00:30,  8.08it/s]



 50%|████████████████████▋                    | 252/500 [00:31<00:31,  7.89it/s]



 51%|████████████████████▋                    | 253/500 [00:31<00:30,  8.03it/s]['wood', 0.9903508771929824, 0.9434591921741052, 0.8898977219447604]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Evaluation result saved at./output/coreset_resnet18_10/textures_seed521.csv:
          Image_AUROC  Pixel_AUROC  PRO_score
category                                     
carpet       0.995586     0.990199   0.959082
grid         0.969925     0.979229   0.921544
leather      1.000000     0.989842   0.969135
tile         0.989899     0.940809   0.847143
wood         0.990351     0.943459   0.889898
===== Category TEXTURES Mean Performance ====
Image_AUROC    0.989152
Pixel_AUROC    0.968708
PRO_score      0.917360
dtype: float64

/home/aistudio/Anomaly.Paddle
Namespace(arch='resnet18', batch_size=32, category='objects', cpu=False, crop_size=256, data_path='/home/aistudio/data', debug=False, einsum=False, eval=True, eval_PRO=True, eval_threthold_step=500, inc=False, k=10, load_projection=None, method='coreset', non_partial_AUC=False, num_workers=0, save_model=True, save_model_subfolder=True, save_path='./output/coreset_resnet18_10', save_pic=True, seed=521, test_batch_size=1)
W0422 17:49:26.705327  4312 device_context.cc:447] Please NOTE: device: 0, GPU Compute Capability: 7.0, Driver API Version: 10.1, Runtime API Version: 10.1
W0422 17:49:26.710134  4312 device_context.cc:465] device: 0, cuDNN Version: 7.6.
model resnet18, nParams 2787264
Training model 1/10 for bottle
| feature extraction | train | bottle |:   0%|            | 0/7 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:
| feature extraction | train | bottle |: 100%|████| 7/7 [00:06<00:00,  1.14it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [21401, 384].
2022-04-22 17:50:41	Train ends, total 70.05s
Saving model...
2022-04-22 17:50:41	Save model in ./output/coreset_resnet18_10/bottle.pdparams
2022-04-22 17:50:41	Starting eval model...
| feature extraction | test | bottle |: 100%|███| 83/83 [00:21<00:00,  3.88it/s]
max_score:4.348142147064209 min_score:0.12776918709278107
F1 image:1.0 threshold:4.348142147064209
F1 pixel:0.6750256003217887 threshold:4.348142147064209
 48%|███████████████████▊                     | 241/500 [00:33<00:34,  7.42it/s]['bottle', 1.0, 0.9814004270128984, 0.9452570983067263]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:2349: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
  if isinstance(obj, collections.Iterator):
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/cbook/__init__.py:2366: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated, and in 3.8 it will stop working
  return list(data) if isinstance(data, collections.MappingView) else data
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 2/10 for cable

| feature extraction | train | cable |:   0%|             | 0/7 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:

| feature extraction | train | cable |:  14%|▋    | 1/7 [00:01<00:10,  1.70s/it]
| feature extraction | train | cable |:  29%|█▍   | 2/7 [00:03<00:08,  1.72s/it]
| feature extraction | train | cable |:  43%|██▏  | 3/7 [00:05<00:06,  1.72s/it]
| feature extraction | train | cable |:  57%|██▊  | 4/7 [00:06<00:05,  1.70s/it]
| feature extraction | train | cable |:  71%|███▌ | 5/7 [00:08<00:03,  1.67s/it]
| feature extraction | train | cable |:  86%|████▎| 6/7 [00:10<00:01,  1.66s/it]
| feature extraction | train | cable |: 100%|█████| 7/7 [00:11<00:00,  1.68s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [22937, 384].
2022-04-22 17:53:04	Train ends, total 83.75s
Saving model...
2022-04-22 17:53:04	Save model in ./output/coreset_resnet18_10/cable.pdparams
2022-04-22 17:53:04	Starting eval model...

| feature extraction | test | cable |:   0%|            | 0/150 [00:00<?, ?it/s]
| feature extraction | test | cable |:   1%|    | 1/150 [00:00<00:50,  2.95it/s]
| feature extraction | test | cable |:   1%|    | 2/150 [00:00<00:47,  3.13it/s]
| feature extraction | test | cable |:   2%|    | 3/150 [00:00<00:44,  3.27it/s]
| feature extraction | test | cable |:   3%|    | 4/150 [00:01<00:43,  3.38it/s]
| feature extraction | test | cable |:   3%|▏   | 5/150 [00:01<00:41,  3.46it/s]
| feature extraction | test | cable |:   4%|▏   | 6/150 [00:01<00:40,  3.52it/s]
| feature extraction | test | cable |:   5%|▏   | 7/150 [00:01<00:40,  3.57it/s]
| feature extraction | test | cable |:   5%|▏   | 8/150 [00:02<00:39,  3.59it/s]
| feature extraction | test | cable |:   6%|▏   | 9/150 [00:02<00:38,  3.62it/s]
| feature extraction | test | cable |:   7%|▏  | 10/150 [00:02<00:38,  3.63it/s]
| feature extraction | test | cable |:   7%|▏  | 11/150 [00:03<00:38,  3.65it/s]
| feature extraction | test | cable |:   8%|▏  | 12/150 [00:03<00:37,  3.66it/s]
| feature extraction | test | cable |:   9%|▎  | 13/150 [00:03<00:37,  3.66it/s]
| feature extraction | test | cable |:   9%|▎  | 14/150 [00:03<00:37,  3.66it/s]
| feature extraction | test | cable |:  10%|▎  | 15/150 [00:04<00:36,  3.67it/s]
| feature extraction | test | cable |:  11%|▎  | 16/150 [00:04<00:36,  3.67it/s]
| feature extraction | test | cable |:  11%|▎  | 17/150 [00:04<00:36,  3.67it/s]
| feature extraction | test | cable |:  12%|▎  | 18/150 [00:04<00:35,  3.67it/s]
| feature extraction | test | cable |:  13%|▍  | 19/150 [00:05<00:35,  3.67it/s]
| feature extraction | test | cable |:  13%|▍  | 20/150 [00:05<00:35,  3.66it/s]
| feature extraction | test | cable |:  14%|▍  | 21/150 [00:05<00:35,  3.67it/s]
| feature extraction | test | cable |:  15%|▍  | 22/150 [00:06<00:34,  3.67it/s]
| feature extraction | test | cable |:  15%|▍  | 23/150 [00:06<00:34,  3.67it/s]
| feature extraction | test | cable |:  16%|▍  | 24/150 [00:06<00:34,  3.67it/s]
| feature extraction | test | cable |:  17%|▌  | 25/150 [00:06<00:34,  3.67it/s]
| feature extraction | test | cable |:  17%|▌  | 26/150 [00:07<00:33,  3.66it/s]
| feature extraction | test | cable |:  18%|▌  | 27/150 [00:07<00:33,  3.67it/s]
| feature extraction | test | cable |:  19%|▌  | 28/150 [00:07<00:33,  3.67it/s]
| feature extraction | test | cable |:  19%|▌  | 29/150 [00:07<00:32,  3.67it/s]
| feature extraction | test | cable |:  20%|▌  | 30/150 [00:08<00:32,  3.67it/s]
| feature extraction | test | cable |:  21%|▌  | 31/150 [00:08<00:32,  3.67it/s]
| feature extraction | test | cable |:  21%|▋  | 32/150 [00:08<00:32,  3.66it/s]
| feature extraction | test | cable |:  22%|▋  | 33/150 [00:09<00:31,  3.66it/s]
| feature extraction | test | cable |:  23%|▋  | 34/150 [00:09<00:31,  3.66it/s]
| feature extraction | test | cable |:  23%|▋  | 35/150 [00:09<00:31,  3.65it/s]
| feature extraction | test | cable |:  24%|▋  | 36/150 [00:09<00:31,  3.65it/s]
| feature extraction | test | cable |:  25%|▋  | 37/150 [00:10<00:30,  3.66it/s]
| feature extraction | test | cable |:  25%|▊  | 38/150 [00:10<00:30,  3.66it/s]
| feature extraction | test | cable |:  26%|▊  | 39/150 [00:10<00:30,  3.67it/s]
| feature extraction | test | cable |:  27%|▊  | 40/150 [00:10<00:30,  3.66it/s]
| feature extraction | test | cable |:  27%|▊  | 41/150 [00:11<00:29,  3.67it/s]
| feature extraction | test | cable |:  28%|▊  | 42/150 [00:11<00:29,  3.66it/s]
| feature extraction | test | cable |:  29%|▊  | 43/150 [00:11<00:29,  3.66it/s]
| feature extraction | test | cable |:  29%|▉  | 44/150 [00:12<00:28,  3.66it/s]
| feature extraction | test | cable |:  30%|▉  | 45/150 [00:12<00:28,  3.66it/s]
| feature extraction | test | cable |:  31%|▉  | 46/150 [00:12<00:28,  3.66it/s]
| feature extraction | test | cable |:  31%|▉  | 47/150 [00:12<00:28,  3.66it/s]
| feature extraction | test | cable |:  32%|▉  | 48/150 [00:13<00:27,  3.66it/s]
| feature extraction | test | cable |:  33%|▉  | 49/150 [00:13<00:27,  3.67it/s]
| feature extraction | test | cable |:  33%|█  | 50/150 [00:13<00:27,  3.67it/s]
| feature extraction | test | cable |:  34%|█  | 51/150 [00:13<00:26,  3.67it/s]
| feature extraction | test | cable |:  35%|█  | 52/150 [00:14<00:26,  3.67it/s]
| feature extraction | test | cable |:  35%|█  | 53/150 [00:14<00:26,  3.66it/s]
| feature extraction | test | cable |:  36%|█  | 54/150 [00:14<00:26,  3.65it/s]
| feature extraction | test | cable |:  37%|█  | 55/150 [00:15<00:26,  3.62it/s]
| feature extraction | test | cable |:  37%|█  | 56/150 [00:15<00:25,  3.62it/s]
| feature extraction | test | cable |:  38%|█▏ | 57/150 [00:15<00:25,  3.64it/s]
| feature extraction | test | cable |:  39%|█▏ | 58/150 [00:15<00:25,  3.65it/s]
| feature extraction | test | cable |:  39%|█▏ | 59/150 [00:16<00:24,  3.66it/s]
| feature extraction | test | cable |:  40%|█▏ | 60/150 [00:16<00:24,  3.66it/s]
| feature extraction | test | cable |:  41%|█▏ | 61/150 [00:16<00:24,  3.65it/s]
| feature extraction | test | cable |:  41%|█▏ | 62/150 [00:16<00:24,  3.66it/s]
| feature extraction | test | cable |:  42%|█▎ | 63/150 [00:17<00:23,  3.66it/s]
| feature extraction | test | cable |:  43%|█▎ | 64/150 [00:17<00:23,  3.67it/s]
| feature extraction | test | cable |:  43%|█▎ | 65/150 [00:17<00:23,  3.67it/s]
| feature extraction | test | cable |:  44%|█▎ | 66/150 [00:18<00:22,  3.67it/s]
| feature extraction | test | cable |:  45%|█▎ | 67/150 [00:18<00:23,  3.54it/s]
| feature extraction | test | cable |:  45%|█▎ | 68/150 [00:18<00:23,  3.46it/s]
| feature extraction | test | cable |:  46%|█▍ | 69/150 [00:18<00:23,  3.48it/s]
| feature extraction | test | cable |:  47%|█▍ | 70/150 [00:19<00:22,  3.54it/s]
| feature extraction | test | cable |:  47%|█▍ | 71/150 [00:19<00:22,  3.59it/s]
| feature extraction | test | cable |:  48%|█▍ | 72/150 [00:19<00:21,  3.62it/s]
| feature extraction | test | cable |:  49%|█▍ | 73/150 [00:20<00:21,  3.64it/s]
| feature extraction | test | cable |:  49%|█▍ | 74/150 [00:20<00:20,  3.65it/s]
| feature extraction | test | cable |:  50%|█▌ | 75/150 [00:20<00:20,  3.66it/s]
| feature extraction | test | cable |:  51%|█▌ | 76/150 [00:20<00:20,  3.67it/s]
| feature extraction | test | cable |:  51%|█▌ | 77/150 [00:21<00:19,  3.67it/s]
| feature extraction | test | cable |:  52%|█▌ | 78/150 [00:21<00:19,  3.67it/s]
| feature extraction | test | cable |:  53%|█▌ | 79/150 [00:21<00:19,  3.67it/s]
| feature extraction | test | cable |:  53%|█▌ | 80/150 [00:21<00:19,  3.67it/s]
| feature extraction | test | cable |:  54%|█▌ | 81/150 [00:22<00:18,  3.67it/s]
| feature extraction | test | cable |:  55%|█▋ | 82/150 [00:22<00:18,  3.67it/s]
| feature extraction | test | cable |:  55%|█▋ | 83/150 [00:22<00:18,  3.67it/s]
| feature extraction | test | cable |:  56%|█▋ | 84/150 [00:23<00:17,  3.67it/s]
| feature extraction | test | cable |:  57%|█▋ | 85/150 [00:23<00:17,  3.67it/s]
| feature extraction | test | cable |:  57%|█▋ | 86/150 [00:23<00:17,  3.68it/s]
| feature extraction | test | cable |:  58%|█▋ | 87/150 [00:23<00:17,  3.68it/s]
| feature extraction | test | cable |:  59%|█▊ | 88/150 [00:24<00:16,  3.68it/s]
| feature extraction | test | cable |:  59%|█▊ | 89/150 [00:24<00:16,  3.68it/s]
| feature extraction | test | cable |:  60%|█▊ | 90/150 [00:24<00:16,  3.68it/s]
| feature extraction | test | cable |:  61%|█▊ | 91/150 [00:24<00:16,  3.67it/s]
| feature extraction | test | cable |:  61%|█▊ | 92/150 [00:25<00:15,  3.67it/s]
| feature extraction | test | cable |:  62%|█▊ | 93/150 [00:25<00:15,  3.67it/s]
| feature extraction | test | cable |:  63%|█▉ | 94/150 [00:25<00:15,  3.67it/s]
| feature extraction | test | cable |:  63%|█▉ | 95/150 [00:26<00:14,  3.68it/s]
| feature extraction | test | cable |:  64%|█▉ | 96/150 [00:26<00:14,  3.68it/s]
| feature extraction | test | cable |:  65%|█▉ | 97/150 [00:26<00:14,  3.68it/s]
| feature extraction | test | cable |:  65%|█▉ | 98/150 [00:26<00:14,  3.67it/s]
| feature extraction | test | cable |:  66%|█▉ | 99/150 [00:27<00:13,  3.66it/s]
| feature extraction | test | cable |:  67%|█▎| 100/150 [00:27<00:13,  3.67it/s]
| feature extraction | test | cable |:  67%|█▎| 101/150 [00:27<00:13,  3.67it/s]
| feature extraction | test | cable |:  68%|█▎| 102/150 [00:27<00:13,  3.66it/s]
| feature extraction | test | cable |:  69%|█▎| 103/150 [00:28<00:12,  3.67it/s]
| feature extraction | test | cable |:  69%|█▍| 104/150 [00:28<00:12,  3.67it/s]
| feature extraction | test | cable |:  70%|█▍| 105/150 [00:28<00:12,  3.67it/s]
| feature extraction | test | cable |:  71%|█▍| 106/150 [00:29<00:11,  3.67it/s]
| feature extraction | test | cable |:  71%|█▍| 107/150 [00:29<00:11,  3.67it/s]
| feature extraction | test | cable |:  72%|█▍| 108/150 [00:29<00:11,  3.67it/s]
| feature extraction | test | cable |:  73%|█▍| 109/150 [00:29<00:11,  3.67it/s]
| feature extraction | test | cable |:  73%|█▍| 110/150 [00:30<00:10,  3.67it/s]
| feature extraction | test | cable |:  74%|█▍| 111/150 [00:30<00:10,  3.67it/s]
| feature extraction | test | cable |:  75%|█▍| 112/150 [00:30<00:10,  3.67it/s]
| feature extraction | test | cable |:  75%|█▌| 113/150 [00:30<00:10,  3.67it/s]
| feature extraction | test | cable |:  76%|█▌| 114/150 [00:31<00:09,  3.67it/s]
| feature extraction | test | cable |:  77%|█▌| 115/150 [00:31<00:09,  3.67it/s]
| feature extraction | test | cable |:  77%|█▌| 116/150 [00:31<00:09,  3.67it/s]
| feature extraction | test | cable |:  78%|█▌| 117/150 [00:32<00:08,  3.67it/s]
| feature extraction | test | cable |:  79%|█▌| 118/150 [00:32<00:08,  3.67it/s]
| feature extraction | test | cable |:  79%|█▌| 119/150 [00:32<00:08,  3.65it/s]
| feature extraction | test | cable |:  80%|█▌| 120/150 [00:32<00:08,  3.65it/s]
| feature extraction | test | cable |:  81%|█▌| 121/150 [00:33<00:07,  3.66it/s]
| feature extraction | test | cable |:  81%|█▋| 122/150 [00:33<00:07,  3.66it/s]
| feature extraction | test | cable |:  82%|█▋| 123/150 [00:33<00:07,  3.66it/s]
| feature extraction | test | cable |:  83%|█▋| 124/150 [00:33<00:07,  3.66it/s]
| feature extraction | test | cable |:  83%|█▋| 125/150 [00:34<00:06,  3.67it/s]
| feature extraction | test | cable |:  84%|█▋| 126/150 [00:34<00:06,  3.66it/s]
| feature extraction | test | cable |:  85%|█▋| 127/150 [00:34<00:06,  3.67it/s]
| feature extraction | test | cable |:  85%|█▋| 128/150 [00:35<00:06,  3.66it/s]
| feature extraction | test | cable |:  86%|█▋| 129/150 [00:35<00:05,  3.67it/s]
| feature extraction | test | cable |:  87%|█▋| 130/150 [00:35<00:05,  3.67it/s]
| feature extraction | test | cable |:  87%|█▋| 131/150 [00:35<00:05,  3.67it/s]
| feature extraction | test | cable |:  88%|█▊| 132/150 [00:36<00:04,  3.67it/s]
| feature extraction | test | cable |:  89%|█▊| 133/150 [00:36<00:04,  3.67it/s]
| feature extraction | test | cable |:  89%|█▊| 134/150 [00:36<00:04,  3.67it/s]
| feature extraction | test | cable |:  90%|█▊| 135/150 [00:36<00:04,  3.67it/s]
| feature extraction | test | cable |:  91%|█▊| 136/150 [00:37<00:03,  3.67it/s]
| feature extraction | test | cable |:  91%|█▊| 137/150 [00:37<00:03,  3.67it/s]
| feature extraction | test | cable |:  92%|█▊| 138/150 [00:37<00:03,  3.67it/s]
| feature extraction | test | cable |:  93%|█▊| 139/150 [00:38<00:02,  3.68it/s]
| feature extraction | test | cable |:  93%|█▊| 140/150 [00:38<00:02,  3.68it/s]
| feature extraction | test | cable |:  94%|█▉| 141/150 [00:38<00:02,  3.69it/s]
| feature extraction | test | cable |:  95%|█▉| 142/150 [00:38<00:02,  3.68it/s]
| feature extraction | test | cable |:  95%|█▉| 143/150 [00:39<00:01,  3.68it/s]
| feature extraction | test | cable |:  96%|█▉| 144/150 [00:39<00:01,  3.67it/s]
| feature extraction | test | cable |:  97%|█▉| 145/150 [00:39<00:01,  3.59it/s]
| feature extraction | test | cable |:  97%|█▉| 146/150 [00:39<00:01,  3.53it/s]
| feature extraction | test | cable |:  98%|█▉| 147/150 [00:40<00:00,  3.59it/s]
| feature extraction | test | cable |:  99%|█▉| 148/150 [00:40<00:00,  3.63it/s]
| feature extraction | test | cable |:  99%|█▉| 149/150 [00:40<00:00,  3.65it/s]
| feature extraction | test | cable |: 100%|██| 150/150 [00:41<00:00,  3.65it/s]
max_score:4.341184616088867 min_score:0.8442022800445557
F1 image:0.9417989417989417 threshold:4.341184616088867
F1 pixel:0.6272680005391978 threshold:4.341184616088867

  0%|                                                   | 0/500 [00:00<?, ?it/s]
  0%|                                           | 1/500 [00:00<01:50,  4.53it/s]
  0%|▏                                          | 2/500 [00:00<01:51,  4.46it/s]
  1%|▎                                          | 3/500 [00:00<01:52,  4.41it/s]
  1%|▎                                          | 4/500 [00:00<01:52,  4.41it/s]
  1%|▍                                          | 5/500 [00:01<01:52,  4.41it/s]
  1%|▌                                          | 6/500 [00:01<01:51,  4.42it/s]
  1%|▌                                          | 7/500 [00:01<01:51,  4.43it/s]
  2%|▋                                          | 8/500 [00:01<01:50,  4.43it/s]
  2%|▊                                          | 9/500 [00:02<01:52,  4.38it/s]
  2%|▊                                         | 10/500 [00:02<01:52,  4.37it/s]
  2%|▉                                         | 11/500 [00:02<01:52,  4.35it/s]
  2%|█                                         | 12/500 [00:02<01:51,  4.37it/s]
  3%|█                                         | 13/500 [00:02<01:51,  4.37it/s]
  3%|█▏                                        | 14/500 [00:03<01:51,  4.37it/s]
  3%|█▎                                        | 15/500 [00:03<01:50,  4.37it/s]
  3%|█▎                                        | 16/500 [00:03<01:51,  4.33it/s]
  3%|█▍                                        | 17/500 [00:03<01:51,  4.33it/s]
  4%|█▌                                        | 18/500 [00:04<01:51,  4.33it/s]
  4%|█▌                                        | 19/500 [00:04<01:51,  4.33it/s]
  4%|█▋                                        | 20/500 [00:04<01:51,  4.31it/s]
  4%|█▊                                        | 21/500 [00:04<01:50,  4.32it/s]
  4%|█▊                                        | 22/500 [00:05<01:51,  4.30it/s]
  5%|█▉                                        | 23/500 [00:05<01:53,  4.22it/s]
  5%|██                                        | 24/500 [00:05<01:52,  4.24it/s]
  5%|██                                        | 25/500 [00:05<01:52,  4.21it/s]
  5%|██▏                                       | 26/500 [00:06<01:54,  4.12it/s]
  5%|██▎                                       | 27/500 [00:06<01:57,  4.02it/s]
  6%|██▎                                       | 28/500 [00:06<01:59,  3.95it/s]
  6%|██▍                                       | 29/500 [00:06<01:59,  3.95it/s]
  6%|██▌                                       | 30/500 [00:07<01:58,  3.96it/s]
  6%|██▌                                       | 31/500 [00:07<02:02,  3.83it/s]
  6%|██▋                                       | 32/500 [00:07<02:03,  3.79it/s]
  7%|██▊                                       | 33/500 [00:07<02:01,  3.84it/s]
  7%|██▊                                       | 34/500 [00:08<01:58,  3.92it/s]
  7%|██▉                                       | 35/500 [00:08<01:55,  4.03it/s]
  7%|███                                       | 36/500 [00:08<01:52,  4.11it/s]
  7%|███                                       | 37/500 [00:08<01:52,  4.13it/s]
  8%|███▏                                      | 38/500 [00:09<01:50,  4.18it/s]
  8%|███▎                                      | 39/500 [00:09<01:49,  4.23it/s]
  8%|███▎                                      | 40/500 [00:09<01:48,  4.22it/s]
  8%|███▍                                      | 41/500 [00:09<01:48,  4.22it/s]
  8%|███▌                                      | 42/500 [00:09<01:50,  4.13it/s]
  9%|███▌                                      | 43/500 [00:10<01:49,  4.18it/s]
  9%|███▋                                      | 44/500 [00:10<01:48,  4.19it/s]
  9%|███▊                                      | 45/500 [00:10<01:49,  4.17it/s]
  9%|███▊                                      | 46/500 [00:10<01:49,  4.15it/s]
  9%|███▉                                      | 47/500 [00:11<01:48,  4.17it/s]
 10%|████                                      | 48/500 [00:11<01:48,  4.17it/s]
 10%|████                                      | 49/500 [00:11<01:48,  4.16it/s]
 10%|████▏                                     | 50/500 [00:11<01:48,  4.16it/s]
 10%|████▎                                     | 51/500 [00:12<01:48,  4.13it/s]
 10%|████▎                                     | 52/500 [00:12<01:51,  4.02it/s]
 11%|████▍                                     | 53/500 [00:12<01:50,  4.03it/s]
 11%|████▌                                     | 54/500 [00:12<01:52,  3.98it/s]
 11%|████▌                                     | 55/500 [00:13<01:51,  3.98it/s]
 11%|████▋                                     | 56/500 [00:13<01:50,  4.02it/s]
 11%|████▊                                     | 57/500 [00:13<01:49,  4.06it/s]
 12%|████▊                                     | 58/500 [00:13<01:47,  4.13it/s]
 12%|████▉                                     | 59/500 [00:14<01:45,  4.20it/s]
 12%|█████                                     | 60/500 [00:14<01:44,  4.20it/s]
 12%|█████                                     | 61/500 [00:14<01:44,  4.22it/s]
 12%|█████▏                                    | 62/500 [00:14<01:43,  4.24it/s]
 13%|█████▎                                    | 63/500 [00:15<01:42,  4.28it/s]
 13%|█████▍                                    | 64/500 [00:15<01:41,  4.31it/s]
 13%|█████▍                                    | 65/500 [00:15<01:41,  4.30it/s]
 13%|█████▌                                    | 66/500 [00:15<01:41,  4.28it/s]
 13%|█████▋                                    | 67/500 [00:16<01:42,  4.24it/s]
 14%|█████▋                                    | 68/500 [00:16<01:41,  4.25it/s]
 14%|█████▊                                    | 69/500 [00:16<01:41,  4.25it/s]
 14%|█████▉                                    | 70/500 [00:16<01:42,  4.20it/s]
 14%|█████▉                                    | 71/500 [00:16<01:41,  4.21it/s]
 14%|██████                                    | 72/500 [00:17<01:40,  4.24it/s]
 15%|██████▏                                   | 73/500 [00:17<01:40,  4.23it/s]
 15%|██████▏                                   | 74/500 [00:17<01:41,  4.22it/s]
 15%|██████▎                                   | 75/500 [00:17<01:40,  4.23it/s]
 15%|██████▍                                   | 76/500 [00:18<01:40,  4.24it/s]
 15%|██████▍                                   | 77/500 [00:18<01:40,  4.21it/s]
 16%|██████▌                                   | 78/500 [00:18<01:40,  4.21it/s]
 16%|██████▋                                   | 79/500 [00:18<01:40,  4.18it/s]
 16%|██████▋                                   | 80/500 [00:19<01:40,  4.17it/s]
 16%|██████▊                                   | 81/500 [00:19<01:40,  4.18it/s]
 16%|██████▉                                   | 82/500 [00:19<01:40,  4.15it/s]
 17%|██████▉                                   | 83/500 [00:19<01:40,  4.13it/s]
 17%|███████                                   | 84/500 [00:20<01:41,  4.10it/s]
 17%|███████▏                                  | 85/500 [00:20<01:41,  4.09it/s]
 17%|███████▏                                  | 86/500 [00:20<01:40,  4.11it/s]
 17%|███████▎                                  | 87/500 [00:20<01:40,  4.10it/s]
 18%|███████▍                                  | 88/500 [00:21<01:40,  4.12it/s]
 18%|███████▍                                  | 89/500 [00:21<01:40,  4.10it/s]
 18%|███████▌                                  | 90/500 [00:21<01:39,  4.13it/s]
 18%|███████▋                                  | 91/500 [00:21<01:37,  4.18it/s]
 18%|███████▋                                  | 92/500 [00:21<01:37,  4.18it/s]
 19%|███████▊                                  | 93/500 [00:22<01:37,  4.16it/s]
 19%|███████▉                                  | 94/500 [00:22<01:35,  4.24it/s]
 19%|███████▉                                  | 95/500 [00:22<01:34,  4.28it/s]
 19%|████████                                  | 96/500 [00:22<01:35,  4.21it/s]
 19%|████████▏                                 | 97/500 [00:23<01:35,  4.22it/s]
 20%|████████▏                                 | 98/500 [00:23<01:34,  4.24it/s]
 20%|████████▎                                 | 99/500 [00:23<01:34,  4.25it/s]
 20%|████████▏                                | 100/500 [00:23<01:34,  4.24it/s]
 20%|████████▎                                | 101/500 [00:24<01:34,  4.21it/s]
 20%|████████▎                                | 102/500 [00:24<01:38,  4.04it/s]
 21%|████████▍                                | 103/500 [00:24<01:36,  4.12it/s]
 21%|████████▌                                | 104/500 [00:24<01:35,  4.14it/s]
 21%|████████▌                                | 105/500 [00:25<01:35,  4.15it/s]
 21%|████████▋                                | 106/500 [00:25<01:33,  4.23it/s]
 21%|████████▊                                | 107/500 [00:25<01:32,  4.24it/s]
 22%|████████▊                                | 108/500 [00:25<01:32,  4.22it/s]
 22%|████████▉                                | 109/500 [00:26<01:33,  4.20it/s]
 22%|█████████                                | 110/500 [00:26<01:31,  4.25it/s]
 22%|█████████                                | 111/500 [00:26<01:30,  4.28it/s]
 22%|█████████▏                               | 112/500 [00:26<01:31,  4.26it/s]
 23%|█████████▎                               | 113/500 [00:27<01:34,  4.11it/s]
 23%|█████████▎                               | 114/500 [00:27<01:32,  4.19it/s]
 23%|█████████▍                               | 115/500 [00:27<01:30,  4.26it/s]
 23%|█████████▌                               | 116/500 [00:27<01:30,  4.23it/s]
 23%|█████████▌                               | 117/500 [00:27<01:30,  4.23it/s]
 24%|█████████▋                               | 118/500 [00:28<01:29,  4.27it/s]
 24%|█████████▊                               | 119/500 [00:28<01:29,  4.26it/s]
 24%|█████████▊                               | 120/500 [00:28<01:28,  4.28it/s]
 24%|█████████▉                               | 121/500 [00:28<01:28,  4.27it/s]
 24%|██████████                               | 122/500 [00:29<01:27,  4.30it/s]
 25%|██████████                               | 123/500 [00:29<01:28,  4.26it/s]
 25%|██████████▏                              | 124/500 [00:29<01:29,  4.22it/s]
 25%|██████████▎                              | 125/500 [00:29<01:28,  4.22it/s]
 25%|██████████▎                              | 126/500 [00:30<01:27,  4.27it/s]
 25%|██████████▍                              | 127/500 [00:30<01:26,  4.30it/s]
 26%|██████████▍                              | 128/500 [00:30<01:26,  4.30it/s]
 26%|██████████▌                              | 129/500 [00:30<01:27,  4.23it/s]
 26%|██████████▋                              | 130/500 [00:30<01:27,  4.22it/s]
 26%|██████████▋                              | 131/500 [00:31<01:27,  4.24it/s]
 26%|██████████▊                              | 132/500 [00:31<01:26,  4.27it/s]
 27%|██████████▉                              | 133/500 [00:31<01:26,  4.24it/s]
 27%|██████████▉                              | 134/500 [00:31<01:26,  4.25it/s]
 27%|███████████                              | 135/500 [00:32<01:25,  4.26it/s]
 27%|███████████▏                             | 136/500 [00:32<01:24,  4.30it/s]
 27%|███████████▏                             | 137/500 [00:32<01:24,  4.31it/s]
 28%|███████████▎                             | 138/500 [00:32<01:24,  4.26it/s]
 28%|███████████▍                             | 139/500 [00:33<01:28,  4.08it/s]
 28%|███████████▍                             | 140/500 [00:33<01:30,  4.00it/s]
 28%|███████████▌                             | 141/500 [00:33<01:31,  3.92it/s]
 28%|███████████▋                             | 142/500 [00:33<01:32,  3.89it/s]
 29%|███████████▋                             | 143/500 [00:34<01:31,  3.91it/s]
 29%|███████████▊                             | 144/500 [00:34<01:30,  3.95it/s]
 29%|███████████▉                             | 145/500 [00:34<01:28,  3.99it/s]
 29%|███████████▉                             | 146/500 [00:34<01:26,  4.08it/s]
 29%|████████████                             | 147/500 [00:35<01:25,  4.11it/s]
 30%|████████████▏                            | 148/500 [00:35<01:26,  4.05it/s]
 30%|████████████▏                            | 149/500 [00:35<01:25,  4.12it/s]
 30%|████████████▎                            | 150/500 [00:35<01:23,  4.20it/s]
 30%|████████████▍                            | 151/500 [00:36<01:21,  4.26it/s]
 30%|████████████▍                            | 152/500 [00:36<01:20,  4.30it/s]
 31%|████████████▌                            | 153/500 [00:36<01:21,  4.26it/s]
 31%|████████████▋                            | 154/500 [00:36<01:22,  4.21it/s]
 31%|████████████▋                            | 155/500 [00:37<01:22,  4.16it/s]
 31%|████████████▊                            | 156/500 [00:37<01:21,  4.20it/s]
 31%|████████████▊                            | 157/500 [00:37<01:22,  4.13it/s]
 32%|████████████▉                            | 158/500 [00:37<01:24,  4.04it/s]
 32%|█████████████                            | 159/500 [00:38<01:24,  4.04it/s]
 32%|█████████████                            | 160/500 [00:38<01:23,  4.07it/s]
 32%|█████████████▏                           | 161/500 [00:38<01:22,  4.12it/s]
 32%|█████████████▎                           | 162/500 [00:38<01:21,  4.14it/s]
 33%|█████████████▎                           | 163/500 [00:38<01:21,  4.13it/s]
 33%|█████████████▍                           | 164/500 [00:39<01:21,  4.14it/s]
 33%|█████████████▌                           | 165/500 [00:39<01:20,  4.18it/s]
 33%|█████████████▌                           | 166/500 [00:39<01:21,  4.12it/s]
 33%|█████████████▋                           | 167/500 [00:39<01:19,  4.17it/s]
 34%|█████████████▊                           | 168/500 [00:40<01:20,  4.11it/s]
 34%|█████████████▊                           | 169/500 [00:40<01:20,  4.13it/s]
 34%|█████████████▉                           | 170/500 [00:40<01:19,  4.14it/s]
 34%|██████████████                           | 171/500 [00:40<01:20,  4.10it/s]
 34%|██████████████                           | 172/500 [00:41<01:19,  4.11it/s]
 35%|██████████████▏                          | 173/500 [00:41<01:18,  4.16it/s]
 35%|██████████████▎                          | 174/500 [00:41<01:17,  4.20it/s]
 35%|██████████████▎                          | 175/500 [00:41<01:16,  4.25it/s]
 35%|██████████████▍                          | 176/500 [00:42<01:16,  4.25it/s]
 35%|██████████████▌                          | 177/500 [00:42<01:15,  4.28it/s]
 36%|██████████████▌                          | 178/500 [00:42<01:14,  4.32it/s]
 36%|██████████████▋                          | 179/500 [00:42<01:13,  4.34it/s]
 36%|██████████████▊                          | 180/500 [00:43<01:13,  4.34it/s]
 36%|██████████████▊                          | 181/500 [00:43<01:13,  4.36it/s]
 36%|██████████████▉                          | 182/500 [00:43<01:13,  4.35it/s]
 37%|███████████████                          | 183/500 [00:43<01:13,  4.34it/s]
 37%|███████████████                          | 184/500 [00:43<01:12,  4.35it/s]
 37%|███████████████▏                         | 185/500 [00:44<01:13,  4.30it/s]
 37%|███████████████▎                         | 186/500 [00:44<01:13,  4.28it/s]
 37%|███████████████▎                         | 187/500 [00:44<01:13,  4.26it/s]
 38%|███████████████▍                         | 188/500 [00:44<01:12,  4.29it/s]
 38%|███████████████▍                         | 189/500 [00:45<01:12,  4.27it/s]
 38%|███████████████▌                         | 190/500 [00:45<01:12,  4.30it/s]
 38%|███████████████▋                         | 191/500 [00:45<01:11,  4.32it/s]
 38%|███████████████▋                         | 192/500 [00:45<01:10,  4.34it/s]
 39%|███████████████▊                         | 193/500 [00:46<01:10,  4.36it/s]
 39%|███████████████▉                         | 194/500 [00:46<01:10,  4.37it/s]
 39%|███████████████▉                         | 195/500 [00:46<01:09,  4.38it/s]
 39%|████████████████                         | 196/500 [00:46<01:09,  4.40it/s]
 39%|████████████████▏                        | 197/500 [00:46<01:09,  4.38it/s]
 40%|████████████████▏                        | 198/500 [00:47<01:08,  4.38it/s]
 40%|████████████████▎                        | 199/500 [00:47<01:08,  4.38it/s]
 40%|████████████████▍                        | 200/500 [00:47<01:09,  4.34it/s]
 40%|████████████████▍                        | 201/500 [00:47<01:10,  4.26it/s]
 40%|████████████████▌                        | 202/500 [00:48<01:11,  4.18it/s]
 41%|████████████████▋                        | 203/500 [00:48<01:11,  4.17it/s]
 41%|████████████████▋                        | 204/500 [00:48<01:10,  4.17it/s]
 41%|████████████████▊                        | 205/500 [00:48<01:11,  4.15it/s]
 41%|████████████████▉                        | 206/500 [00:49<01:11,  4.12it/s]
 41%|████████████████▉                        | 207/500 [00:49<01:10,  4.14it/s]
 42%|█████████████████                        | 208/500 [00:49<01:09,  4.21it/s]
 42%|█████████████████▏                       | 209/500 [00:49<01:08,  4.23it/s]
 42%|█████████████████▏                       | 210/500 [00:50<01:08,  4.25it/s]
 42%|█████████████████▎                       | 211/500 [00:50<01:07,  4.26it/s]
 42%|█████████████████▍                       | 212/500 [00:50<01:06,  4.30it/s]
 43%|█████████████████▍                       | 213/500 [00:50<01:06,  4.31it/s]
 43%|█████████████████▌                       | 214/500 [00:50<01:06,  4.30it/s]
 43%|█████████████████▋                       | 215/500 [00:51<01:06,  4.29it/s]
 43%|█████████████████▋                       | 216/500 [00:51<01:06,  4.30it/s]
 43%|█████████████████▊                       | 217/500 [00:51<01:06,  4.28it/s]
 44%|█████████████████▉                       | 218/500 [00:51<01:05,  4.30it/s]
 44%|█████████████████▉                       | 219/500 [00:52<01:05,  4.30it/s]
 44%|██████████████████                       | 220/500 [00:52<01:05,  4.31it/s]
 44%|██████████████████                       | 221/500 [00:52<01:04,  4.33it/s]
 44%|██████████████████▏                      | 222/500 [00:52<01:03,  4.34it/s]
 45%|██████████████████▎                      | 223/500 [00:53<01:04,  4.31it/s]
 45%|██████████████████▎                      | 224/500 [00:53<01:04,  4.31it/s]
 45%|██████████████████▍                      | 225/500 [00:53<01:03,  4.30it/s]
 45%|██████████████████▌                      | 226/500 [00:53<01:04,  4.28it/s]
 45%|██████████████████▌                      | 227/500 [00:53<01:03,  4.28it/s]
 46%|██████████████████▋                      | 228/500 [00:54<01:05,  4.13it/s]
 46%|██████████████████▊                      | 229/500 [00:54<01:13,  3.66it/s]
 46%|██████████████████▊                      | 230/500 [00:54<01:12,  3.72it/s]
 46%|██████████████████▉                      | 231/500 [00:55<01:10,  3.82it/s]
 46%|███████████████████                      | 232/500 [00:55<01:07,  3.97it/s]
 47%|███████████████████                      | 233/500 [00:55<01:05,  4.07it/s]
 47%|███████████████████▏                     | 234/500 [00:55<01:03,  4.16it/s]
 47%|███████████████████▎                     | 235/500 [00:56<01:03,  4.19it/s]
 47%|███████████████████▎                     | 236/500 [00:56<01:02,  4.24it/s]
 47%|███████████████████▍                     | 237/500 [00:56<01:01,  4.27it/s]
 48%|███████████████████▌                     | 238/500 [00:56<01:00,  4.30it/s]
 48%|███████████████████▌                     | 239/500 [00:56<01:01,  4.22it/s]
 48%|███████████████████▋                     | 240/500 [00:57<01:02,  4.19it/s]
 48%|███████████████████▊                     | 241/500 [00:57<01:01,  4.22it/s]
 48%|███████████████████▊                     | 242/500 [00:57<01:00,  4.26it/s]
 49%|███████████████████▉                     | 243/500 [00:57<01:00,  4.27it/s]['cable', 0.9776986506746627, 0.9844280999140127, 0.9414028061758493]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 3/10 for capsule


| feature extraction | train | capsule |:   0%|           | 0/7 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:


| feature extraction | train | capsule |:  14%|▍  | 1/7 [00:01<00:09,  1.63s/it]

| feature extraction | train | capsule |:  29%|▊  | 2/7 [00:03<00:08,  1.61s/it]

| feature extraction | train | capsule |:  43%|█▎ | 3/7 [00:04<00:06,  1.60s/it]

| feature extraction | train | capsule |:  57%|█▋ | 4/7 [00:06<00:04,  1.60s/it]

| feature extraction | train | capsule |:  71%|██▏| 5/7 [00:07<00:03,  1.59s/it]

| feature extraction | train | capsule |:  86%|██▌| 6/7 [00:09<00:01,  1.59s/it]

| feature extraction | train | capsule |: 100%|███| 7/7 [00:10<00:00,  1.56s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [22425, 384].
2022-04-22 17:56:09	Train ends, total 78.70s
Saving model...
2022-04-22 17:56:09	Save model in ./output/coreset_resnet18_10/capsule.pdparams
2022-04-22 17:56:09	Starting eval model...


| feature extraction | test | capsule |:   0%|          | 0/132 [00:00<?, ?it/s]

| feature extraction | test | capsule |:   1%|  | 1/132 [00:00<00:43,  3.04it/s]

| feature extraction | test | capsule |:   2%|  | 2/132 [00:00<00:40,  3.22it/s]

| feature extraction | test | capsule |:   2%|  | 3/132 [00:00<00:38,  3.35it/s]

| feature extraction | test | capsule |:   3%|  | 4/132 [00:01<00:37,  3.40it/s]

| feature extraction | test | capsule |:   4%|  | 5/132 [00:01<00:37,  3.42it/s]

| feature extraction | test | capsule |:   5%|  | 6/132 [00:01<00:35,  3.51it/s]

| feature extraction | test | capsule |:   5%|  | 7/132 [00:01<00:34,  3.58it/s]

| feature extraction | test | capsule |:   6%|  | 8/132 [00:02<00:34,  3.63it/s]

| feature extraction | test | capsule |:   7%|▏ | 9/132 [00:02<00:33,  3.66it/s]

| feature extraction | test | capsule |:   8%| | 10/132 [00:02<00:33,  3.69it/s]

| feature extraction | test | capsule |:   8%| | 11/132 [00:03<00:32,  3.70it/s]

| feature extraction | test | capsule |:   9%| | 12/132 [00:03<00:32,  3.71it/s]

| feature extraction | test | capsule |:  10%| | 13/132 [00:03<00:31,  3.72it/s]

| feature extraction | test | capsule |:  11%| | 14/132 [00:03<00:31,  3.73it/s]

| feature extraction | test | capsule |:  11%| | 15/132 [00:04<00:31,  3.71it/s]

| feature extraction | test | capsule |:  12%| | 16/132 [00:04<00:31,  3.71it/s]

| feature extraction | test | capsule |:  13%|▏| 17/132 [00:04<00:30,  3.71it/s]

| feature extraction | test | capsule |:  14%|▏| 18/132 [00:04<00:30,  3.72it/s]

| feature extraction | test | capsule |:  14%|▏| 19/132 [00:05<00:30,  3.72it/s]

| feature extraction | test | capsule |:  15%|▏| 20/132 [00:05<00:30,  3.73it/s]

| feature extraction | test | capsule |:  16%|▏| 21/132 [00:05<00:29,  3.73it/s]

| feature extraction | test | capsule |:  17%|▏| 22/132 [00:05<00:29,  3.73it/s]

| feature extraction | test | capsule |:  17%|▏| 23/132 [00:06<00:29,  3.73it/s]

| feature extraction | test | capsule |:  18%|▏| 24/132 [00:06<00:29,  3.71it/s]

| feature extraction | test | capsule |:  19%|▏| 25/132 [00:06<00:28,  3.72it/s]

| feature extraction | test | capsule |:  20%|▏| 26/132 [00:07<00:28,  3.72it/s]

| feature extraction | test | capsule |:  20%|▏| 27/132 [00:07<00:28,  3.73it/s]

| feature extraction | test | capsule |:  21%|▏| 28/132 [00:07<00:27,  3.73it/s]

| feature extraction | test | capsule |:  22%|▏| 29/132 [00:07<00:27,  3.73it/s]

| feature extraction | test | capsule |:  23%|▏| 30/132 [00:08<00:27,  3.73it/s]

| feature extraction | test | capsule |:  23%|▏| 31/132 [00:08<00:27,  3.73it/s]

| feature extraction | test | capsule |:  24%|▏| 32/132 [00:08<00:26,  3.73it/s]

| feature extraction | test | capsule |:  25%|▎| 33/132 [00:08<00:26,  3.74it/s]

| feature extraction | test | capsule |:  26%|▎| 34/132 [00:09<00:26,  3.74it/s]

| feature extraction | test | capsule |:  27%|▎| 35/132 [00:09<00:25,  3.74it/s]

| feature extraction | test | capsule |:  27%|▎| 36/132 [00:09<00:25,  3.73it/s]

| feature extraction | test | capsule |:  28%|▎| 37/132 [00:10<00:25,  3.69it/s]

| feature extraction | test | capsule |:  29%|▎| 38/132 [00:10<00:25,  3.70it/s]

| feature extraction | test | capsule |:  30%|▎| 39/132 [00:10<00:25,  3.71it/s]

| feature extraction | test | capsule |:  30%|▎| 40/132 [00:10<00:24,  3.72it/s]

| feature extraction | test | capsule |:  31%|▎| 41/132 [00:11<00:24,  3.73it/s]

| feature extraction | test | capsule |:  32%|▎| 42/132 [00:11<00:24,  3.73it/s]

| feature extraction | test | capsule |:  33%|▎| 43/132 [00:11<00:24,  3.70it/s]

| feature extraction | test | capsule |:  33%|▎| 44/132 [00:11<00:23,  3.69it/s]

| feature extraction | test | capsule |:  34%|▎| 45/132 [00:12<00:23,  3.71it/s]

| feature extraction | test | capsule |:  35%|▎| 46/132 [00:12<00:23,  3.72it/s]

| feature extraction | test | capsule |:  36%|▎| 47/132 [00:12<00:22,  3.73it/s]

| feature extraction | test | capsule |:  36%|▎| 48/132 [00:12<00:22,  3.74it/s]

| feature extraction | test | capsule |:  37%|▎| 49/132 [00:13<00:22,  3.75it/s]

| feature extraction | test | capsule |:  38%|▍| 50/132 [00:13<00:21,  3.75it/s]

| feature extraction | test | capsule |:  39%|▍| 51/132 [00:13<00:21,  3.76it/s]

| feature extraction | test | capsule |:  39%|▍| 52/132 [00:14<00:21,  3.76it/s]

| feature extraction | test | capsule |:  40%|▍| 53/132 [00:14<00:20,  3.76it/s]

| feature extraction | test | capsule |:  41%|▍| 54/132 [00:14<00:20,  3.76it/s]

| feature extraction | test | capsule |:  42%|▍| 55/132 [00:14<00:20,  3.76it/s]

| feature extraction | test | capsule |:  42%|▍| 56/132 [00:15<00:20,  3.76it/s]

| feature extraction | test | capsule |:  43%|▍| 57/132 [00:15<00:19,  3.76it/s]

| feature extraction | test | capsule |:  44%|▍| 58/132 [00:15<00:19,  3.76it/s]

| feature extraction | test | capsule |:  45%|▍| 59/132 [00:15<00:19,  3.76it/s]

| feature extraction | test | capsule |:  45%|▍| 60/132 [00:16<00:19,  3.76it/s]

| feature extraction | test | capsule |:  46%|▍| 61/132 [00:16<00:18,  3.74it/s]

| feature extraction | test | capsule |:  47%|▍| 62/132 [00:16<00:18,  3.74it/s]

| feature extraction | test | capsule |:  48%|▍| 63/132 [00:16<00:18,  3.74it/s]

| feature extraction | test | capsule |:  48%|▍| 64/132 [00:17<00:18,  3.75it/s]

| feature extraction | test | capsule |:  49%|▍| 65/132 [00:17<00:17,  3.75it/s]

| feature extraction | test | capsule |:  50%|▌| 66/132 [00:17<00:17,  3.75it/s]

| feature extraction | test | capsule |:  51%|▌| 67/132 [00:18<00:17,  3.75it/s]

| feature extraction | test | capsule |:  52%|▌| 68/132 [00:18<00:17,  3.73it/s]

| feature extraction | test | capsule |:  52%|▌| 69/132 [00:18<00:16,  3.73it/s]

| feature extraction | test | capsule |:  53%|▌| 70/132 [00:18<00:16,  3.73it/s]

| feature extraction | test | capsule |:  54%|▌| 71/132 [00:19<00:16,  3.74it/s]

| feature extraction | test | capsule |:  55%|▌| 72/132 [00:19<00:16,  3.75it/s]

| feature extraction | test | capsule |:  55%|▌| 73/132 [00:19<00:15,  3.75it/s]

| feature extraction | test | capsule |:  56%|▌| 74/132 [00:19<00:15,  3.75it/s]

| feature extraction | test | capsule |:  57%|▌| 75/132 [00:20<00:15,  3.75it/s]

| feature extraction | test | capsule |:  58%|▌| 76/132 [00:20<00:14,  3.75it/s]

| feature extraction | test | capsule |:  58%|▌| 77/132 [00:20<00:14,  3.75it/s]

| feature extraction | test | capsule |:  59%|▌| 78/132 [00:20<00:14,  3.75it/s]

| feature extraction | test | capsule |:  60%|▌| 79/132 [00:21<00:14,  3.75it/s]

| feature extraction | test | capsule |:  61%|▌| 80/132 [00:21<00:13,  3.75it/s]

| feature extraction | test | capsule |:  61%|▌| 81/132 [00:21<00:13,  3.75it/s]

| feature extraction | test | capsule |:  62%|▌| 82/132 [00:22<00:13,  3.71it/s]

| feature extraction | test | capsule |:  63%|▋| 83/132 [00:22<00:13,  3.61it/s]

| feature extraction | test | capsule |:  64%|▋| 84/132 [00:22<00:13,  3.65it/s]

| feature extraction | test | capsule |:  64%|▋| 85/132 [00:22<00:12,  3.67it/s]

| feature extraction | test | capsule |:  65%|▋| 86/132 [00:23<00:12,  3.69it/s]

| feature extraction | test | capsule |:  66%|▋| 87/132 [00:23<00:12,  3.71it/s]

| feature extraction | test | capsule |:  67%|▋| 88/132 [00:23<00:11,  3.72it/s]

| feature extraction | test | capsule |:  67%|▋| 89/132 [00:23<00:11,  3.72it/s]

| feature extraction | test | capsule |:  68%|▋| 90/132 [00:24<00:11,  3.72it/s]

| feature extraction | test | capsule |:  69%|▋| 91/132 [00:24<00:11,  3.73it/s]

| feature extraction | test | capsule |:  70%|▋| 92/132 [00:24<00:10,  3.73it/s]

| feature extraction | test | capsule |:  70%|▋| 93/132 [00:25<00:10,  3.73it/s]

| feature extraction | test | capsule |:  71%|▋| 94/132 [00:25<00:10,  3.74it/s]

| feature extraction | test | capsule |:  72%|▋| 95/132 [00:25<00:09,  3.74it/s]

| feature extraction | test | capsule |:  73%|▋| 96/132 [00:25<00:09,  3.74it/s]

| feature extraction | test | capsule |:  73%|▋| 97/132 [00:26<00:09,  3.74it/s]

| feature extraction | test | capsule |:  74%|▋| 98/132 [00:26<00:09,  3.74it/s]

| feature extraction | test | capsule |:  75%|▊| 99/132 [00:26<00:08,  3.73it/s]

| feature extraction | test | capsule |:  76%|▊| 100/132 [00:26<00:08,  3.73it/s]

| feature extraction | test | capsule |:  77%|▊| 101/132 [00:27<00:08,  3.72it/s]

| feature extraction | test | capsule |:  77%|▊| 102/132 [00:27<00:08,  3.72it/s]

| feature extraction | test | capsule |:  78%|▊| 103/132 [00:27<00:07,  3.72it/s]

| feature extraction | test | capsule |:  79%|▊| 104/132 [00:27<00:07,  3.72it/s]

| feature extraction | test | capsule |:  80%|▊| 105/132 [00:28<00:07,  3.72it/s]

| feature extraction | test | capsule |:  80%|▊| 106/132 [00:28<00:06,  3.72it/s]

| feature extraction | test | capsule |:  81%|▊| 107/132 [00:28<00:06,  3.72it/s]

| feature extraction | test | capsule |:  82%|▊| 108/132 [00:29<00:06,  3.72it/s]

| feature extraction | test | capsule |:  83%|▊| 109/132 [00:29<00:06,  3.72it/s]

| feature extraction | test | capsule |:  83%|▊| 110/132 [00:29<00:05,  3.73it/s]

| feature extraction | test | capsule |:  84%|▊| 111/132 [00:29<00:05,  3.73it/s]

| feature extraction | test | capsule |:  85%|▊| 112/132 [00:30<00:05,  3.74it/s]

| feature extraction | test | capsule |:  86%|▊| 113/132 [00:30<00:05,  3.75it/s]

| feature extraction | test | capsule |:  86%|▊| 114/132 [00:30<00:04,  3.75it/s]

| feature extraction | test | capsule |:  87%|▊| 115/132 [00:30<00:04,  3.75it/s]

| feature extraction | test | capsule |:  88%|▉| 116/132 [00:31<00:04,  3.76it/s]

| feature extraction | test | capsule |:  89%|▉| 117/132 [00:31<00:03,  3.76it/s]

| feature extraction | test | capsule |:  89%|▉| 118/132 [00:31<00:03,  3.76it/s]

| feature extraction | test | capsule |:  90%|▉| 119/132 [00:31<00:03,  3.76it/s]

| feature extraction | test | capsule |:  91%|▉| 120/132 [00:32<00:03,  3.76it/s]

| feature extraction | test | capsule |:  92%|▉| 121/132 [00:32<00:02,  3.76it/s]

| feature extraction | test | capsule |:  92%|▉| 122/132 [00:32<00:02,  3.76it/s]

| feature extraction | test | capsule |:  93%|▉| 123/132 [00:33<00:02,  3.76it/s]

| feature extraction | test | capsule |:  94%|▉| 124/132 [00:33<00:02,  3.76it/s]

| feature extraction | test | capsule |:  95%|▉| 125/132 [00:33<00:01,  3.75it/s]

| feature extraction | test | capsule |:  95%|▉| 126/132 [00:33<00:01,  3.75it/s]

| feature extraction | test | capsule |:  96%|▉| 127/132 [00:34<00:01,  3.75it/s]

| feature extraction | test | capsule |:  97%|▉| 128/132 [00:34<00:01,  3.74it/s]

| feature extraction | test | capsule |:  98%|▉| 129/132 [00:34<00:00,  3.76it/s]

| feature extraction | test | capsule |:  98%|▉| 130/132 [00:34<00:00,  3.76it/s]

| feature extraction | test | capsule |:  99%|▉| 131/132 [00:35<00:00,  3.77it/s]

| feature extraction | test | capsule |: 100%|█| 132/132 [00:35<00:00,  3.73it/s]
max_score:3.8907437324523926 min_score:0.35983923077583313
F1 image:0.9646017699115045 threshold:3.8907437324523926
F1 pixel:0.48656265614210403 threshold:3.8907437324523926


  0%|                                                   | 0/500 [00:00<?, ?it/s]

  0%|                                           | 1/500 [00:00<01:37,  5.09it/s]

  0%|▏                                          | 2/500 [00:00<01:39,  5.02it/s]

  1%|▎                                          | 3/500 [00:00<01:38,  5.07it/s]

  1%|▎                                          | 4/500 [00:00<01:37,  5.08it/s]

  1%|▍                                          | 5/500 [00:00<01:36,  5.13it/s]

  1%|▌                                          | 6/500 [00:01<01:37,  5.09it/s]

  1%|▌                                          | 7/500 [00:01<01:41,  4.88it/s]

  2%|▋                                          | 8/500 [00:01<01:43,  4.75it/s]

  2%|▊                                          | 9/500 [00:01<01:45,  4.66it/s]

  2%|▊                                         | 10/500 [00:02<01:46,  4.59it/s]

  2%|▉                                         | 11/500 [00:02<01:44,  4.68it/s]

  2%|█                                         | 12/500 [00:02<01:42,  4.77it/s]

  3%|█                                         | 13/500 [00:02<01:40,  4.85it/s]

  3%|█▏                                        | 14/500 [00:02<01:38,  4.93it/s]

  3%|█▎                                        | 15/500 [00:03<01:37,  5.00it/s]

  3%|█▎                                        | 16/500 [00:03<01:36,  4.99it/s]

  3%|█▍                                        | 17/500 [00:03<01:36,  5.02it/s]

  4%|█▌                                        | 18/500 [00:03<01:35,  5.06it/s]

  4%|█▌                                        | 19/500 [00:03<01:34,  5.08it/s]

  4%|█▋                                        | 20/500 [00:04<01:34,  5.08it/s]

  4%|█▊                                        | 21/500 [00:04<01:35,  5.02it/s]

  4%|█▊                                        | 22/500 [00:04<01:34,  5.05it/s]

  5%|█▉                                        | 23/500 [00:04<01:35,  4.97it/s]

  5%|██                                        | 24/500 [00:04<01:34,  5.01it/s]

  5%|██                                        | 25/500 [00:05<01:35,  4.97it/s]

  5%|██▏                                       | 26/500 [00:05<01:36,  4.92it/s]

  5%|██▎                                       | 27/500 [00:05<01:36,  4.91it/s]

  6%|██▎                                       | 28/500 [00:05<01:35,  4.97it/s]

  6%|██▍                                       | 29/500 [00:05<01:35,  4.92it/s]

  6%|██▌                                       | 30/500 [00:06<01:35,  4.91it/s]

  6%|██▌                                       | 31/500 [00:06<01:36,  4.86it/s]

  6%|██▋                                       | 32/500 [00:06<01:37,  4.82it/s]

  7%|██▊                                       | 33/500 [00:06<01:35,  4.89it/s]

  7%|██▊                                       | 34/500 [00:06<01:34,  4.93it/s]

  7%|██▉                                       | 35/500 [00:07<01:37,  4.79it/s]

  7%|███                                       | 36/500 [00:07<01:36,  4.80it/s]

  7%|███                                       | 37/500 [00:07<01:36,  4.82it/s]

  8%|███▏                                      | 38/500 [00:07<01:35,  4.85it/s]

  8%|███▎                                      | 39/500 [00:07<01:33,  4.92it/s]

  8%|███▎                                      | 40/500 [00:08<01:33,  4.90it/s]

  8%|███▍                                      | 41/500 [00:08<01:34,  4.87it/s]

  8%|███▌                                      | 42/500 [00:08<01:32,  4.93it/s]

  9%|███▌                                      | 43/500 [00:08<01:31,  5.01it/s]

  9%|███▋                                      | 44/500 [00:08<01:31,  5.00it/s]

  9%|███▊                                      | 45/500 [00:09<01:32,  4.93it/s]

  9%|███▊                                      | 46/500 [00:09<01:32,  4.91it/s]

  9%|███▉                                      | 47/500 [00:09<01:31,  4.95it/s]

 10%|████                                      | 48/500 [00:09<01:32,  4.89it/s]

 10%|████                                      | 49/500 [00:09<01:31,  4.93it/s]

 10%|████▏                                     | 50/500 [00:10<01:30,  4.96it/s]

 10%|████▎                                     | 51/500 [00:10<01:30,  4.97it/s]

 10%|████▎                                     | 52/500 [00:10<01:29,  5.00it/s]

 11%|████▍                                     | 53/500 [00:10<01:29,  5.02it/s]

 11%|████▌                                     | 54/500 [00:10<01:29,  4.97it/s]

 11%|████▌                                     | 55/500 [00:11<01:30,  4.89it/s]

 11%|████▋                                     | 56/500 [00:11<01:29,  4.95it/s]

 11%|████▊                                     | 57/500 [00:11<01:30,  4.91it/s]

 12%|████▊                                     | 58/500 [00:11<01:28,  4.99it/s]

 12%|████▉                                     | 59/500 [00:11<01:28,  4.99it/s]

 12%|█████                                     | 60/500 [00:12<01:28,  4.97it/s]

 12%|█████                                     | 61/500 [00:12<01:27,  5.01it/s]

 12%|█████▏                                    | 62/500 [00:12<01:27,  4.98it/s]

 13%|█████▎                                    | 63/500 [00:12<01:26,  5.04it/s]

 13%|█████▍                                    | 64/500 [00:12<01:25,  5.08it/s]

 13%|█████▍                                    | 65/500 [00:13<01:26,  5.03it/s]

 13%|█████▌                                    | 66/500 [00:13<01:26,  5.04it/s]

 13%|█████▋                                    | 67/500 [00:13<01:26,  4.99it/s]

 14%|█████▋                                    | 68/500 [00:13<01:25,  5.03it/s]

 14%|█████▊                                    | 69/500 [00:13<01:25,  5.05it/s]

 14%|█████▉                                    | 70/500 [00:14<01:25,  5.06it/s]

 14%|█████▉                                    | 71/500 [00:14<01:25,  5.02it/s]

 14%|██████                                    | 72/500 [00:14<01:27,  4.87it/s]

 15%|██████▏                                   | 73/500 [00:14<01:26,  4.95it/s]

 15%|██████▏                                   | 74/500 [00:14<01:25,  4.96it/s]

 15%|██████▎                                   | 75/500 [00:15<01:24,  5.00it/s]

 15%|██████▍                                   | 76/500 [00:15<01:24,  5.02it/s]

 15%|██████▍                                   | 77/500 [00:15<01:23,  5.06it/s]

 16%|██████▌                                   | 78/500 [00:15<01:22,  5.09it/s]

 16%|██████▋                                   | 79/500 [00:15<01:22,  5.12it/s]

 16%|██████▋                                   | 80/500 [00:16<01:21,  5.13it/s]

 16%|██████▊                                   | 81/500 [00:16<01:21,  5.14it/s]

 16%|██████▉                                   | 82/500 [00:16<01:22,  5.09it/s]

 17%|██████▉                                   | 83/500 [00:16<01:23,  4.98it/s]

 17%|███████                                   | 84/500 [00:16<01:23,  4.99it/s]

 17%|███████▏                                  | 85/500 [00:17<01:25,  4.88it/s]

 17%|███████▏                                  | 86/500 [00:17<01:24,  4.89it/s]

 17%|███████▎                                  | 87/500 [00:17<01:24,  4.90it/s]

 18%|███████▍                                  | 88/500 [00:17<01:22,  4.97it/s]

 18%|███████▍                                  | 89/500 [00:17<01:21,  5.03it/s]

 18%|███████▌                                  | 90/500 [00:18<01:20,  5.08it/s]

 18%|███████▋                                  | 91/500 [00:18<01:20,  5.09it/s]

 18%|███████▋                                  | 92/500 [00:18<01:19,  5.10it/s]

 19%|███████▊                                  | 93/500 [00:18<01:19,  5.12it/s]

 19%|███████▉                                  | 94/500 [00:18<01:18,  5.14it/s]

 19%|███████▉                                  | 95/500 [00:19<01:21,  4.99it/s]

 19%|████████                                  | 96/500 [00:19<01:21,  4.93it/s]

 19%|████████▏                                 | 97/500 [00:19<01:23,  4.83it/s]

 20%|████████▏                                 | 98/500 [00:19<01:21,  4.92it/s]

 20%|████████▎                                 | 99/500 [00:19<01:21,  4.93it/s]

 20%|████████▏                                | 100/500 [00:20<01:23,  4.80it/s]

 20%|████████▎                                | 101/500 [00:20<01:23,  4.76it/s]

 20%|████████▎                                | 102/500 [00:20<01:24,  4.73it/s]

 21%|████████▍                                | 103/500 [00:20<01:21,  4.87it/s]

 21%|████████▌                                | 104/500 [00:20<01:19,  4.96it/s]

 21%|████████▌                                | 105/500 [00:21<01:18,  5.03it/s]

 21%|████████▋                                | 106/500 [00:21<01:17,  5.06it/s]

 21%|████████▊                                | 107/500 [00:21<01:17,  5.10it/s]

 22%|████████▊                                | 108/500 [00:21<01:17,  5.09it/s]

 22%|████████▉                                | 109/500 [00:21<01:16,  5.11it/s]

 22%|█████████                                | 110/500 [00:22<01:16,  5.11it/s]

 22%|█████████                                | 111/500 [00:22<01:19,  4.88it/s]

 22%|█████████▏                               | 112/500 [00:22<01:20,  4.80it/s]

 23%|█████████▎                               | 113/500 [00:22<01:19,  4.84it/s]

 23%|█████████▎                               | 114/500 [00:23<01:20,  4.80it/s]

 23%|█████████▍                               | 115/500 [00:23<01:20,  4.77it/s]

 23%|█████████▌                               | 116/500 [00:23<01:18,  4.88it/s]

 23%|█████████▌                               | 117/500 [00:23<01:17,  4.93it/s]

 24%|█████████▋                               | 118/500 [00:23<01:16,  4.98it/s]

 24%|█████████▊                               | 119/500 [00:24<01:16,  5.00it/s]

 24%|█████████▊                               | 120/500 [00:24<01:15,  5.02it/s]

 24%|█████████▉                               | 121/500 [00:24<01:15,  5.00it/s]

 24%|██████████                               | 122/500 [00:24<01:16,  4.96it/s]

 25%|██████████                               | 123/500 [00:24<01:15,  5.01it/s]

 25%|██████████▏                              | 124/500 [00:25<01:14,  5.04it/s]

 25%|██████████▎                              | 125/500 [00:25<01:14,  5.05it/s]

 25%|██████████▎                              | 126/500 [00:25<01:13,  5.06it/s]

 25%|██████████▍                              | 127/500 [00:25<01:14,  5.03it/s]

 26%|██████████▍                              | 128/500 [00:25<01:13,  5.06it/s]

 26%|██████████▌                              | 129/500 [00:26<01:14,  5.01it/s]

 26%|██████████▋                              | 130/500 [00:26<01:13,  5.04it/s]

 26%|██████████▋                              | 131/500 [00:26<01:13,  5.02it/s]

 26%|██████████▊                              | 132/500 [00:26<01:14,  4.91it/s]

 27%|██████████▉                              | 133/500 [00:26<01:13,  4.97it/s]

 27%|██████████▉                              | 134/500 [00:27<01:13,  5.01it/s]

 27%|███████████                              | 135/500 [00:27<01:12,  5.05it/s]

 27%|███████████▏                             | 136/500 [00:27<01:14,  4.90it/s]

 27%|███████████▏                             | 137/500 [00:27<01:13,  4.96it/s]

 28%|███████████▎                             | 138/500 [00:27<01:12,  5.02it/s]

 28%|███████████▍                             | 139/500 [00:28<01:11,  5.08it/s]

 28%|███████████▍                             | 140/500 [00:28<01:10,  5.10it/s]

 28%|███████████▌                             | 141/500 [00:28<01:10,  5.13it/s]

 28%|███████████▋                             | 142/500 [00:28<01:10,  5.08it/s]

 29%|███████████▋                             | 143/500 [00:28<01:10,  5.10it/s]

 29%|███████████▊                             | 144/500 [00:28<01:09,  5.13it/s]

 29%|███████████▉                             | 145/500 [00:29<01:09,  5.13it/s]

 29%|███████████▉                             | 146/500 [00:29<01:08,  5.14it/s]

 29%|████████████                             | 147/500 [00:29<01:08,  5.14it/s]

 30%|████████████▏                            | 148/500 [00:29<01:08,  5.14it/s]

 30%|████████████▏                            | 149/500 [00:29<01:08,  5.15it/s]

 30%|████████████▎                            | 150/500 [00:30<01:07,  5.15it/s]

 30%|████████████▍                            | 151/500 [00:30<01:07,  5.15it/s]

 30%|████████████▍                            | 152/500 [00:30<01:07,  5.15it/s]

 31%|████████████▌                            | 153/500 [00:30<01:07,  5.14it/s]

 31%|████████████▋                            | 154/500 [00:30<01:07,  5.15it/s]

 31%|████████████▋                            | 155/500 [00:31<01:06,  5.15it/s]

 31%|████████████▊                            | 156/500 [00:31<01:07,  5.13it/s]

 31%|████████████▊                            | 157/500 [00:31<01:06,  5.14it/s]

 32%|████████████▉                            | 158/500 [00:31<01:06,  5.15it/s]

 32%|█████████████                            | 159/500 [00:31<01:06,  5.14it/s]

 32%|█████████████                            | 160/500 [00:32<01:07,  5.05it/s]

 32%|█████████████▏                           | 161/500 [00:32<01:07,  5.05it/s]

 32%|█████████████▎                           | 162/500 [00:32<01:07,  5.04it/s]

 33%|█████████████▎                           | 163/500 [00:32<01:06,  5.06it/s]

 33%|█████████████▍                           | 164/500 [00:32<01:06,  5.08it/s]

 33%|█████████████▌                           | 165/500 [00:33<01:05,  5.09it/s]

 33%|█████████████▌                           | 166/500 [00:33<01:05,  5.09it/s]

 33%|█████████████▋                           | 167/500 [00:33<01:05,  5.10it/s]

 34%|█████████████▊                           | 168/500 [00:33<01:05,  5.10it/s]

 34%|█████████████▊                           | 169/500 [00:33<01:05,  5.08it/s]

 34%|█████████████▉                           | 170/500 [00:34<01:04,  5.10it/s]

 34%|██████████████                           | 171/500 [00:34<01:06,  4.96it/s]

 34%|██████████████                           | 172/500 [00:34<01:05,  4.98it/s]

 35%|██████████████▏                          | 173/500 [00:34<01:05,  5.00it/s]

 35%|██████████████▎                          | 174/500 [00:34<01:04,  5.02it/s]

 35%|██████████████▎                          | 175/500 [00:35<01:04,  5.03it/s]

 35%|██████████████▍                          | 176/500 [00:35<01:04,  4.99it/s]

 35%|██████████████▌                          | 177/500 [00:35<01:04,  4.98it/s]

 36%|██████████████▌                          | 178/500 [00:35<01:04,  4.99it/s]

 36%|██████████████▋                          | 179/500 [00:35<01:05,  4.93it/s]

 36%|██████████████▊                          | 180/500 [00:36<01:04,  4.94it/s]

 36%|██████████████▊                          | 181/500 [00:36<01:04,  4.95it/s]

 36%|██████████████▉                          | 182/500 [00:36<01:03,  4.97it/s]

 37%|███████████████                          | 183/500 [00:36<01:04,  4.94it/s]

 37%|███████████████                          | 184/500 [00:36<01:03,  4.94it/s]

 37%|███████████████▏                         | 185/500 [00:37<01:03,  4.99it/s]

 37%|███████████████▎                         | 186/500 [00:37<01:03,  4.98it/s]

 37%|███████████████▎                         | 187/500 [00:37<01:02,  4.98it/s]

 38%|███████████████▍                         | 188/500 [00:37<01:02,  5.00it/s]

 38%|███████████████▍                         | 189/500 [00:37<01:02,  4.99it/s]

 38%|███████████████▌                         | 190/500 [00:38<01:01,  5.01it/s]

 38%|███████████████▋                         | 191/500 [00:38<01:01,  5.03it/s]

 38%|███████████████▋                         | 192/500 [00:38<01:01,  5.04it/s]

 39%|███████████████▊                         | 193/500 [00:38<01:01,  5.02it/s]

 39%|███████████████▉                         | 194/500 [00:38<01:01,  5.01it/s]

 39%|███████████████▉                         | 195/500 [00:39<01:00,  5.04it/s]

 39%|████████████████                         | 196/500 [00:39<01:00,  5.01it/s]

 39%|████████████████▏                        | 197/500 [00:39<01:01,  4.96it/s]

 40%|████████████████▏                        | 198/500 [00:39<01:00,  4.97it/s]

 40%|████████████████▎                        | 199/500 [00:39<01:00,  4.95it/s]

 40%|████████████████▍                        | 200/500 [00:40<01:00,  4.99it/s]

 40%|████████████████▍                        | 201/500 [00:40<00:59,  4.99it/s]

 40%|████████████████▌                        | 202/500 [00:40<01:00,  4.91it/s]

 41%|████████████████▋                        | 203/500 [00:40<01:00,  4.90it/s]

 41%|████████████████▋                        | 204/500 [00:40<01:00,  4.90it/s]

 41%|████████████████▊                        | 205/500 [00:41<00:59,  4.95it/s]

 41%|████████████████▉                        | 206/500 [00:41<00:58,  5.00it/s]

 41%|████████████████▉                        | 207/500 [00:41<00:58,  5.01it/s]

 42%|█████████████████                        | 208/500 [00:41<00:58,  5.00it/s]

 42%|█████████████████▏                       | 209/500 [00:41<00:58,  4.99it/s]

 42%|█████████████████▏                       | 210/500 [00:42<00:58,  4.95it/s]

 42%|█████████████████▎                       | 211/500 [00:42<00:58,  4.98it/s]

 42%|█████████████████▍                       | 212/500 [00:42<00:57,  5.00it/s]

 43%|█████████████████▍                       | 213/500 [00:42<00:57,  4.96it/s]

 43%|█████████████████▌                       | 214/500 [00:42<00:57,  4.94it/s]

 43%|█████████████████▋                       | 215/500 [00:43<00:58,  4.84it/s]

 43%|█████████████████▋                       | 216/500 [00:43<00:59,  4.74it/s]

 43%|█████████████████▊                       | 217/500 [00:43<01:01,  4.62it/s]

 44%|█████████████████▉                       | 218/500 [00:43<01:01,  4.62it/s]

 44%|█████████████████▉                       | 219/500 [00:44<01:00,  4.62it/s]

 44%|██████████████████                       | 220/500 [00:44<00:59,  4.68it/s]

 44%|██████████████████                       | 221/500 [00:44<00:59,  4.72it/s]

 44%|██████████████████▏                      | 222/500 [00:44<00:57,  4.84it/s]

 45%|██████████████████▎                      | 223/500 [00:44<00:56,  4.92it/s]

 45%|██████████████████▎                      | 224/500 [00:45<00:55,  5.00it/s]

 45%|██████████████████▍                      | 225/500 [00:45<00:55,  4.99it/s]

 45%|██████████████████▌                      | 226/500 [00:45<00:54,  5.03it/s]

 45%|██████████████████▌                      | 227/500 [00:45<00:54,  4.99it/s]

 46%|██████████████████▋                      | 228/500 [00:45<00:54,  4.98it/s]

 46%|██████████████████▊                      | 229/500 [00:46<00:54,  4.94it/s]

 46%|██████████████████▊                      | 230/500 [00:46<00:54,  4.95it/s]

 46%|██████████████████▉                      | 231/500 [00:46<00:53,  4.99it/s]

 46%|███████████████████                      | 232/500 [00:46<00:53,  4.99it/s]

 47%|███████████████████                      | 233/500 [00:46<00:53,  5.00it/s]

 47%|███████████████████▏                     | 234/500 [00:47<00:52,  5.03it/s]

 47%|███████████████████▎                     | 235/500 [00:47<00:53,  5.00it/s]

 47%|███████████████████▎                     | 236/500 [00:47<00:52,  5.04it/s]

 47%|███████████████████▍                     | 237/500 [00:47<00:53,  4.96it/s]

 48%|███████████████████▌                     | 238/500 [00:47<00:52,  4.98it/s]

 48%|███████████████████▌                     | 239/500 [00:48<00:52,  4.97it/s]

 48%|███████████████████▋                     | 240/500 [00:48<00:52,  4.93it/s]

 48%|███████████████████▊                     | 241/500 [00:48<00:52,  4.95it/s]

 48%|███████████████████▊                     | 242/500 [00:48<00:52,  4.92it/s]

 49%|███████████████████▉                     | 243/500 [00:48<00:51,  4.99it/s]

 49%|████████████████████                     | 244/500 [00:49<00:51,  5.02it/s]

 49%|████████████████████                     | 245/500 [00:49<00:51,  4.97it/s]

 49%|████████████████████▏                    | 246/500 [00:49<00:50,  4.99it/s]

 49%|████████████████████▎                    | 247/500 [00:49<00:50,  4.97it/s]

 50%|████████████████████▎                    | 248/500 [00:49<00:49,  5.04it/s]

 50%|████████████████████▍                    | 249/500 [00:50<00:50,  4.95it/s]

 50%|████████████████████▌                    | 250/500 [00:50<00:50,  4.94it/s]

 50%|████████████████████▌                    | 251/500 [00:50<00:51,  4.86it/s]

 50%|████████████████████▋                    | 252/500 [00:50<00:50,  4.87it/s]

 51%|████████████████████▋                    | 253/500 [00:50<00:51,  4.82it/s]

 51%|████████████████████▊                    | 254/500 [00:51<00:51,  4.80it/s]

 51%|████████████████████▉                    | 255/500 [00:51<00:50,  4.84it/s]

 51%|████████████████████▉                    | 256/500 [00:51<00:49,  4.92it/s]

 51%|█████████████████████                    | 257/500 [00:51<00:49,  4.96it/s]

 52%|█████████████████████▏                   | 258/500 [00:51<00:48,  4.98it/s]

 52%|█████████████████████▏                   | 259/500 [00:52<00:48,  4.96it/s]

 52%|█████████████████████▎                   | 260/500 [00:52<00:48,  4.99it/s]

 52%|█████████████████████▍                   | 261/500 [00:52<00:47,  5.01it/s]

 52%|█████████████████████▍                   | 262/500 [00:52<00:47,  5.01it/s]

 53%|█████████████████████▌                   | 263/500 [00:52<00:46,  5.05it/s]

 53%|█████████████████████▋                   | 264/500 [00:53<00:46,  5.04it/s]

 53%|█████████████████████▋                   | 265/500 [00:53<00:47,  4.94it/s]

 53%|█████████████████████▊                   | 266/500 [00:53<00:47,  4.94it/s]

 53%|█████████████████████▉                   | 267/500 [00:53<00:47,  4.90it/s]

 54%|█████████████████████▉                   | 268/500 [00:53<00:47,  4.90it/s]

 54%|██████████████████████                   | 269/500 [00:54<00:47,  4.89it/s]

 54%|██████████████████████▏                  | 270/500 [00:54<00:46,  4.93it/s]

 54%|██████████████████████▏                  | 271/500 [00:54<00:46,  4.89it/s]

 54%|██████████████████████▎                  | 272/500 [00:54<00:46,  4.94it/s]

 55%|██████████████████████▍                  | 273/500 [00:54<00:45,  4.99it/s]

 55%|██████████████████████▍                  | 274/500 [00:55<00:45,  5.01it/s]

 55%|██████████████████████▌                  | 275/500 [00:55<00:44,  5.01it/s]

 55%|██████████████████████▋                  | 276/500 [00:55<00:44,  5.04it/s]

 55%|██████████████████████▋                  | 277/500 [00:55<00:44,  5.02it/s]

 56%|██████████████████████▊                  | 278/500 [00:55<00:43,  5.07it/s]

 56%|██████████████████████▉                  | 279/500 [00:56<00:43,  5.04it/s]

 56%|██████████████████████▉                  | 280/500 [00:56<00:44,  4.93it/s]

 56%|███████████████████████                  | 281/500 [00:56<00:45,  4.84it/s]

 56%|███████████████████████                  | 282/500 [00:56<00:45,  4.81it/s]

 57%|███████████████████████▏                 | 283/500 [00:56<00:44,  4.84it/s]

 57%|███████████████████████▎                 | 284/500 [00:57<00:44,  4.82it/s]

 57%|███████████████████████▎                 | 285/500 [00:57<00:44,  4.85it/s]

 57%|███████████████████████▍                 | 286/500 [00:57<00:44,  4.85it/s]

 57%|███████████████████████▌                 | 287/500 [00:57<00:43,  4.87it/s]

 58%|███████████████████████▌                 | 288/500 [00:57<00:42,  4.93it/s]

 58%|███████████████████████▋                 | 289/500 [00:58<00:42,  4.94it/s]

 58%|███████████████████████▊                 | 290/500 [00:58<00:42,  4.91it/s]

 58%|███████████████████████▊                 | 291/500 [00:58<00:43,  4.82it/s]

 58%|███████████████████████▉                 | 292/500 [00:58<00:43,  4.83it/s]

 59%|████████████████████████                 | 293/500 [00:58<00:42,  4.86it/s]

 59%|████████████████████████                 | 294/500 [00:59<00:42,  4.87it/s]

 59%|████████████████████████▏                | 295/500 [00:59<00:42,  4.86it/s]

 59%|████████████████████████▎                | 296/500 [00:59<00:41,  4.90it/s]

 59%|████████████████████████▎                | 297/500 [00:59<00:41,  4.94it/s]

 60%|████████████████████████▍                | 298/500 [00:59<00:40,  4.99it/s]

 60%|████████████████████████▌                | 299/500 [01:00<00:40,  4.98it/s]

 60%|████████████████████████▌                | 300/500 [01:00<00:39,  5.02it/s]

 60%|████████████████████████▋                | 301/500 [01:00<00:40,  4.91it/s]

 60%|████████████████████████▊                | 302/500 [01:00<00:40,  4.84it/s]

 61%|████████████████████████▊                | 303/500 [01:01<00:40,  4.84it/s]

 61%|████████████████████████▉                | 304/500 [01:01<00:40,  4.89it/s]

 61%|█████████████████████████                | 305/500 [01:01<00:39,  4.95it/s]

 61%|█████████████████████████                | 306/500 [01:01<00:38,  4.98it/s]

 61%|█████████████████████████▏               | 307/500 [01:01<00:38,  4.99it/s]['capsule', 0.9796569605105704, 0.989979459318634, 0.9426884765257426]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 4/10 for hazelnut



| feature extraction | train | hazelnut |:   0%|         | 0/13 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:



| feature extraction | train | hazelnut |:   8%| | 1/13 [00:01<00:18,  1.55s/it]


| feature extraction | train | hazelnut |:  15%|▏| 2/13 [00:03<00:17,  1.57s/it]


| feature extraction | train | hazelnut |:  23%|▏| 3/13 [00:04<00:15,  1.56s/it]


| feature extraction | train | hazelnut |:  31%|▎| 4/13 [00:06<00:13,  1.55s/it]


| feature extraction | train | hazelnut |:  38%|▍| 5/13 [00:07<00:12,  1.53s/it]


| feature extraction | train | hazelnut |:  46%|▍| 6/13 [00:09<00:10,  1.56s/it]


| feature extraction | train | hazelnut |:  54%|▌| 7/13 [00:11<00:09,  1.59s/it]


| feature extraction | train | hazelnut |:  62%|▌| 8/13 [00:12<00:07,  1.57s/it]


| feature extraction | train | hazelnut |:  69%|▋| 9/13 [00:14<00:06,  1.56s/it]


| feature extraction | train | hazelnut |:  77%|▊| 10/13 [00:15<00:04,  1.56s/it]


| feature extraction | train | hazelnut |:  85%|▊| 11/13 [00:17<00:03,  1.54s/it]


| feature extraction | train | hazelnut |:  92%|▉| 12/13 [00:18<00:01,  1.53s/it]


| feature extraction | train | hazelnut |: 100%|█| 13/13 [00:19<00:00,  1.46s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [40038, 384].
2022-04-22 18:01:19	Train ends, total 206.40s
Saving model...
2022-04-22 18:01:19	Save model in ./output/coreset_resnet18_10/hazelnut.pdparams
2022-04-22 18:01:19	Starting eval model...



| feature extraction | test | hazelnut |:   0%|         | 0/110 [00:00<?, ?it/s]


| feature extraction | test | hazelnut |:   1%| | 1/110 [00:00<00:55,  1.97it/s]


| feature extraction | test | hazelnut |:   2%| | 2/110 [00:00<00:52,  2.04it/s]


| feature extraction | test | hazelnut |:   3%| | 3/110 [00:01<00:51,  2.09it/s]


| feature extraction | test | hazelnut |:   4%| | 4/110 [00:01<00:49,  2.13it/s]


| feature extraction | test | hazelnut |:   5%| | 5/110 [00:02<00:48,  2.16it/s]


| feature extraction | test | hazelnut |:   5%| | 6/110 [00:02<00:47,  2.18it/s]


| feature extraction | test | hazelnut |:   6%| | 7/110 [00:03<00:47,  2.19it/s]


| feature extraction | test | hazelnut |:   7%| | 8/110 [00:03<00:46,  2.20it/s]


| feature extraction | test | hazelnut |:   8%| | 9/110 [00:04<00:45,  2.20it/s]


| feature extraction | test | hazelnut |:   9%| | 10/110 [00:04<00:45,  2.21it/s]


| feature extraction | test | hazelnut |:  10%| | 11/110 [00:05<00:44,  2.21it/s]


| feature extraction | test | hazelnut |:  11%| | 12/110 [00:05<00:45,  2.17it/s]


| feature extraction | test | hazelnut |:  12%| | 13/110 [00:05<00:45,  2.11it/s]


| feature extraction | test | hazelnut |:  13%|▏| 14/110 [00:06<00:45,  2.09it/s]


| feature extraction | test | hazelnut |:  14%|▏| 15/110 [00:06<00:44,  2.13it/s]


| feature extraction | test | hazelnut |:  15%|▏| 16/110 [00:07<00:44,  2.13it/s]


| feature extraction | test | hazelnut |:  15%|▏| 17/110 [00:07<00:43,  2.16it/s]


| feature extraction | test | hazelnut |:  16%|▏| 18/110 [00:08<00:42,  2.18it/s]


| feature extraction | test | hazelnut |:  17%|▏| 19/110 [00:08<00:41,  2.19it/s]


| feature extraction | test | hazelnut |:  18%|▏| 20/110 [00:09<00:40,  2.20it/s]


| feature extraction | test | hazelnut |:  19%|▏| 21/110 [00:09<00:40,  2.21it/s]


| feature extraction | test | hazelnut |:  20%|▏| 22/110 [00:10<00:39,  2.21it/s]


| feature extraction | test | hazelnut |:  21%|▏| 23/110 [00:10<00:39,  2.22it/s]


| feature extraction | test | hazelnut |:  22%|▏| 24/110 [00:10<00:38,  2.22it/s]


| feature extraction | test | hazelnut |:  23%|▏| 25/110 [00:11<00:38,  2.22it/s]


| feature extraction | test | hazelnut |:  24%|▏| 26/110 [00:11<00:37,  2.22it/s]


| feature extraction | test | hazelnut |:  25%|▏| 27/110 [00:12<00:37,  2.22it/s]


| feature extraction | test | hazelnut |:  25%|▎| 28/110 [00:12<00:36,  2.22it/s]


| feature extraction | test | hazelnut |:  26%|▎| 29/110 [00:13<00:36,  2.22it/s]


| feature extraction | test | hazelnut |:  27%|▎| 30/110 [00:13<00:36,  2.22it/s]


| feature extraction | test | hazelnut |:  28%|▎| 31/110 [00:14<00:35,  2.22it/s]


| feature extraction | test | hazelnut |:  29%|▎| 32/110 [00:14<00:35,  2.22it/s]


| feature extraction | test | hazelnut |:  30%|▎| 33/110 [00:15<00:34,  2.22it/s]


| feature extraction | test | hazelnut |:  31%|▎| 34/110 [00:15<00:34,  2.22it/s]


| feature extraction | test | hazelnut |:  32%|▎| 35/110 [00:15<00:33,  2.22it/s]


| feature extraction | test | hazelnut |:  33%|▎| 36/110 [00:16<00:33,  2.22it/s]


| feature extraction | test | hazelnut |:  34%|▎| 37/110 [00:16<00:32,  2.22it/s]


| feature extraction | test | hazelnut |:  35%|▎| 38/110 [00:17<00:32,  2.22it/s]


| feature extraction | test | hazelnut |:  35%|▎| 39/110 [00:17<00:31,  2.22it/s]


| feature extraction | test | hazelnut |:  36%|▎| 40/110 [00:18<00:31,  2.22it/s]


| feature extraction | test | hazelnut |:  37%|▎| 41/110 [00:18<00:31,  2.22it/s]


| feature extraction | test | hazelnut |:  38%|▍| 42/110 [00:19<00:30,  2.22it/s]


| feature extraction | test | hazelnut |:  39%|▍| 43/110 [00:19<00:30,  2.22it/s]


| feature extraction | test | hazelnut |:  40%|▍| 44/110 [00:20<00:29,  2.22it/s]


| feature extraction | test | hazelnut |:  41%|▍| 45/110 [00:20<00:29,  2.22it/s]


| feature extraction | test | hazelnut |:  42%|▍| 46/110 [00:20<00:28,  2.22it/s]


| feature extraction | test | hazelnut |:  43%|▍| 47/110 [00:21<00:28,  2.22it/s]


| feature extraction | test | hazelnut |:  44%|▍| 48/110 [00:21<00:27,  2.22it/s]


| feature extraction | test | hazelnut |:  45%|▍| 49/110 [00:22<00:27,  2.22it/s]


| feature extraction | test | hazelnut |:  45%|▍| 50/110 [00:22<00:26,  2.22it/s]


| feature extraction | test | hazelnut |:  46%|▍| 51/110 [00:23<00:26,  2.22it/s]


| feature extraction | test | hazelnut |:  47%|▍| 52/110 [00:23<00:26,  2.22it/s]


| feature extraction | test | hazelnut |:  48%|▍| 53/110 [00:24<00:25,  2.22it/s]


| feature extraction | test | hazelnut |:  49%|▍| 54/110 [00:24<00:25,  2.22it/s]


| feature extraction | test | hazelnut |:  50%|▌| 55/110 [00:24<00:24,  2.22it/s]


| feature extraction | test | hazelnut |:  51%|▌| 56/110 [00:25<00:24,  2.22it/s]


| feature extraction | test | hazelnut |:  52%|▌| 57/110 [00:25<00:23,  2.22it/s]


| feature extraction | test | hazelnut |:  53%|▌| 58/110 [00:26<00:23,  2.22it/s]


| feature extraction | test | hazelnut |:  54%|▌| 59/110 [00:26<00:23,  2.22it/s]


| feature extraction | test | hazelnut |:  55%|▌| 60/110 [00:27<00:22,  2.22it/s]


| feature extraction | test | hazelnut |:  55%|▌| 61/110 [00:27<00:22,  2.22it/s]


| feature extraction | test | hazelnut |:  56%|▌| 62/110 [00:28<00:21,  2.22it/s]


| feature extraction | test | hazelnut |:  57%|▌| 63/110 [00:28<00:21,  2.22it/s]


| feature extraction | test | hazelnut |:  58%|▌| 64/110 [00:29<00:20,  2.22it/s]


| feature extraction | test | hazelnut |:  59%|▌| 65/110 [00:29<00:20,  2.22it/s]


| feature extraction | test | hazelnut |:  60%|▌| 66/110 [00:29<00:19,  2.22it/s]


| feature extraction | test | hazelnut |:  61%|▌| 67/110 [00:30<00:19,  2.22it/s]


| feature extraction | test | hazelnut |:  62%|▌| 68/110 [00:30<00:18,  2.22it/s]


| feature extraction | test | hazelnut |:  63%|▋| 69/110 [00:31<00:18,  2.22it/s]


| feature extraction | test | hazelnut |:  64%|▋| 70/110 [00:31<00:18,  2.22it/s]


| feature extraction | test | hazelnut |:  65%|▋| 71/110 [00:32<00:17,  2.22it/s]


| feature extraction | test | hazelnut |:  65%|▋| 72/110 [00:32<00:17,  2.21it/s]


| feature extraction | test | hazelnut |:  66%|▋| 73/110 [00:33<00:16,  2.21it/s]


| feature extraction | test | hazelnut |:  67%|▋| 74/110 [00:33<00:16,  2.21it/s]


| feature extraction | test | hazelnut |:  68%|▋| 75/110 [00:33<00:15,  2.21it/s]


| feature extraction | test | hazelnut |:  69%|▋| 76/110 [00:34<00:15,  2.21it/s]


| feature extraction | test | hazelnut |:  70%|▋| 77/110 [00:34<00:14,  2.21it/s]


| feature extraction | test | hazelnut |:  71%|▋| 78/110 [00:35<00:14,  2.22it/s]


| feature extraction | test | hazelnut |:  72%|▋| 79/110 [00:35<00:13,  2.22it/s]


| feature extraction | test | hazelnut |:  73%|▋| 80/110 [00:36<00:13,  2.22it/s]


| feature extraction | test | hazelnut |:  74%|▋| 81/110 [00:36<00:13,  2.21it/s]


| feature extraction | test | hazelnut |:  75%|▋| 82/110 [00:37<00:12,  2.22it/s]


| feature extraction | test | hazelnut |:  75%|▊| 83/110 [00:37<00:12,  2.22it/s]


| feature extraction | test | hazelnut |:  76%|▊| 84/110 [00:38<00:11,  2.22it/s]


| feature extraction | test | hazelnut |:  77%|▊| 85/110 [00:38<00:11,  2.22it/s]


| feature extraction | test | hazelnut |:  78%|▊| 86/110 [00:38<00:10,  2.22it/s]


| feature extraction | test | hazelnut |:  79%|▊| 87/110 [00:39<00:10,  2.22it/s]


| feature extraction | test | hazelnut |:  80%|▊| 88/110 [00:39<00:09,  2.22it/s]


| feature extraction | test | hazelnut |:  81%|▊| 89/110 [00:40<00:09,  2.22it/s]


| feature extraction | test | hazelnut |:  82%|▊| 90/110 [00:40<00:09,  2.22it/s]


| feature extraction | test | hazelnut |:  83%|▊| 91/110 [00:41<00:08,  2.22it/s]


| feature extraction | test | hazelnut |:  84%|▊| 92/110 [00:41<00:08,  2.22it/s]


| feature extraction | test | hazelnut |:  85%|▊| 93/110 [00:42<00:07,  2.22it/s]


| feature extraction | test | hazelnut |:  85%|▊| 94/110 [00:42<00:07,  2.22it/s]


| feature extraction | test | hazelnut |:  86%|▊| 95/110 [00:42<00:06,  2.22it/s]


| feature extraction | test | hazelnut |:  87%|▊| 96/110 [00:43<00:06,  2.22it/s]


| feature extraction | test | hazelnut |:  88%|▉| 97/110 [00:43<00:05,  2.22it/s]


| feature extraction | test | hazelnut |:  89%|▉| 98/110 [00:44<00:05,  2.22it/s]


| feature extraction | test | hazelnut |:  90%|▉| 99/110 [00:44<00:04,  2.22it/s]


| feature extraction | test | hazelnut |:  91%|▉| 100/110 [00:45<00:04,  2.22it/s]


| feature extraction | test | hazelnut |:  92%|▉| 101/110 [00:45<00:04,  2.22it/s]


| feature extraction | test | hazelnut |:  93%|▉| 102/110 [00:46<00:03,  2.21it/s]


| feature extraction | test | hazelnut |:  94%|▉| 103/110 [00:46<00:03,  2.21it/s]


| feature extraction | test | hazelnut |:  95%|▉| 104/110 [00:47<00:02,  2.21it/s]


| feature extraction | test | hazelnut |:  95%|▉| 105/110 [00:47<00:02,  2.21it/s]


| feature extraction | test | hazelnut |:  96%|▉| 106/110 [00:47<00:01,  2.21it/s]


| feature extraction | test | hazelnut |:  97%|▉| 107/110 [00:48<00:01,  2.22it/s]


| feature extraction | test | hazelnut |:  98%|▉| 108/110 [00:48<00:00,  2.22it/s]


| feature extraction | test | hazelnut |:  99%|▉| 109/110 [00:49<00:00,  2.22it/s]


| feature extraction | test | hazelnut |: 100%|█| 110/110 [00:49<00:00,  2.21it/s]
max_score:4.4499101638793945 min_score:0.41317179799079895
F1 image:1.0 threshold:4.4499101638793945
F1 pixel:0.5832674267888135 threshold:4.4499101638793945



  0%|                                                   | 0/500 [00:00<?, ?it/s]


  0%|                                           | 1/500 [00:00<01:28,  5.64it/s]


  0%|▏                                          | 2/500 [00:00<01:27,  5.67it/s]


  1%|▎                                          | 3/500 [00:00<01:27,  5.65it/s]


  1%|▎                                          | 4/500 [00:00<01:27,  5.70it/s]


  1%|▍                                          | 5/500 [00:00<01:26,  5.73it/s]


  1%|▌                                          | 6/500 [00:01<01:25,  5.78it/s]


  1%|▌                                          | 7/500 [00:01<01:25,  5.76it/s]


  2%|▋                                          | 8/500 [00:01<01:26,  5.66it/s]


  2%|▊                                          | 9/500 [00:01<01:26,  5.68it/s]


  2%|▊                                         | 10/500 [00:01<01:26,  5.68it/s]


  2%|▉                                         | 11/500 [00:01<01:26,  5.67it/s]


  2%|█                                         | 12/500 [00:02<01:25,  5.69it/s]


  3%|█                                         | 13/500 [00:02<01:25,  5.70it/s]


  3%|█▏                                        | 14/500 [00:02<01:26,  5.65it/s]


  3%|█▎                                        | 15/500 [00:02<01:24,  5.71it/s]


  3%|█▎                                        | 16/500 [00:02<01:23,  5.78it/s]


  3%|█▍                                        | 17/500 [00:02<01:24,  5.72it/s]


  4%|█▌                                        | 18/500 [00:03<01:24,  5.69it/s]


  4%|█▌                                        | 19/500 [00:03<01:24,  5.66it/s]


  4%|█▋                                        | 20/500 [00:03<01:24,  5.70it/s]


  4%|█▊                                        | 21/500 [00:03<01:24,  5.68it/s]


  4%|█▊                                        | 22/500 [00:03<01:25,  5.62it/s]


  5%|█▉                                        | 23/500 [00:04<01:24,  5.63it/s]


  5%|██                                        | 24/500 [00:04<01:24,  5.65it/s]


  5%|██                                        | 25/500 [00:04<01:23,  5.66it/s]


  5%|██▏                                       | 26/500 [00:04<01:23,  5.65it/s]


  5%|██▎                                       | 27/500 [00:04<01:23,  5.66it/s]


  6%|██▎                                       | 28/500 [00:04<01:23,  5.64it/s]


  6%|██▍                                       | 29/500 [00:05<01:23,  5.66it/s]


  6%|██▌                                       | 30/500 [00:05<01:24,  5.58it/s]


  6%|██▌                                       | 31/500 [00:05<01:22,  5.69it/s]


  6%|██▋                                       | 32/500 [00:05<01:21,  5.76it/s]


  7%|██▊                                       | 33/500 [00:05<01:20,  5.81it/s]


  7%|██▊                                       | 34/500 [00:05<01:21,  5.74it/s]


  7%|██▉                                       | 35/500 [00:06<01:21,  5.73it/s]


  7%|███                                       | 36/500 [00:06<01:20,  5.77it/s]


  7%|███                                       | 37/500 [00:06<01:19,  5.86it/s]


  8%|███▏                                      | 38/500 [00:06<01:18,  5.92it/s]


  8%|███▎                                      | 39/500 [00:06<01:18,  5.87it/s]


  8%|███▎                                      | 40/500 [00:06<01:19,  5.82it/s]


  8%|███▍                                      | 41/500 [00:07<01:20,  5.69it/s]


  8%|███▌                                      | 42/500 [00:07<01:20,  5.67it/s]


  9%|███▌                                      | 43/500 [00:07<01:20,  5.68it/s]


  9%|███▋                                      | 44/500 [00:07<01:20,  5.69it/s]


  9%|███▊                                      | 45/500 [00:07<01:18,  5.79it/s]


  9%|███▊                                      | 46/500 [00:08<01:18,  5.78it/s]


  9%|███▉                                      | 47/500 [00:08<01:19,  5.73it/s]


 10%|████                                      | 48/500 [00:08<01:18,  5.77it/s]


 10%|████                                      | 49/500 [00:08<01:18,  5.78it/s]


 10%|████▏                                     | 50/500 [00:08<01:17,  5.78it/s]


 10%|████▎                                     | 51/500 [00:08<01:18,  5.72it/s]


 10%|████▎                                     | 52/500 [00:09<01:18,  5.74it/s]


 11%|████▍                                     | 53/500 [00:09<01:17,  5.75it/s]


 11%|████▌                                     | 54/500 [00:09<01:17,  5.76it/s]


 11%|████▌                                     | 55/500 [00:09<01:19,  5.62it/s]


 11%|████▋                                     | 56/500 [00:09<01:17,  5.73it/s]


 11%|████▊                                     | 57/500 [00:09<01:16,  5.79it/s]


 12%|████▊                                     | 58/500 [00:10<01:16,  5.82it/s]


 12%|████▉                                     | 59/500 [00:10<01:15,  5.84it/s]


 12%|█████                                     | 60/500 [00:10<01:14,  5.88it/s]


 12%|█████                                     | 61/500 [00:10<01:14,  5.90it/s]


 12%|█████▏                                    | 62/500 [00:10<01:14,  5.85it/s]


 13%|█████▎                                    | 63/500 [00:10<01:15,  5.77it/s]


 13%|█████▍                                    | 64/500 [00:11<01:16,  5.72it/s]


 13%|█████▍                                    | 65/500 [00:11<01:15,  5.76it/s]


 13%|█████▌                                    | 66/500 [00:11<01:15,  5.72it/s]


 13%|█████▋                                    | 67/500 [00:11<01:16,  5.69it/s]


 14%|█████▋                                    | 68/500 [00:11<01:16,  5.66it/s]


 14%|█████▊                                    | 69/500 [00:12<01:15,  5.67it/s]


 14%|█████▉                                    | 70/500 [00:12<01:16,  5.65it/s]


 14%|█████▉                                    | 71/500 [00:12<01:15,  5.69it/s]


 14%|██████                                    | 72/500 [00:12<01:14,  5.73it/s]


 15%|██████▏                                   | 73/500 [00:12<01:14,  5.70it/s]


 15%|██████▏                                   | 74/500 [00:12<01:15,  5.61it/s]


 15%|██████▎                                   | 75/500 [00:13<01:14,  5.69it/s]


 15%|██████▍                                   | 76/500 [00:13<01:14,  5.69it/s]


 15%|██████▍                                   | 77/500 [00:13<01:13,  5.75it/s]


 16%|██████▌                                   | 78/500 [00:13<01:13,  5.72it/s]


 16%|██████▋                                   | 79/500 [00:13<01:13,  5.73it/s]


 16%|██████▋                                   | 80/500 [00:13<01:14,  5.60it/s]


 16%|██████▊                                   | 81/500 [00:14<01:14,  5.60it/s]


 16%|██████▉                                   | 82/500 [00:14<01:15,  5.55it/s]


 17%|██████▉                                   | 83/500 [00:14<01:15,  5.50it/s]


 17%|███████                                   | 84/500 [00:14<01:19,  5.22it/s]


 17%|███████▏                                  | 85/500 [00:14<01:18,  5.28it/s]


 17%|███████▏                                  | 86/500 [00:15<01:19,  5.22it/s]


 17%|███████▎                                  | 87/500 [00:15<01:20,  5.13it/s]


 18%|███████▍                                  | 88/500 [00:15<01:21,  5.07it/s]


 18%|███████▍                                  | 89/500 [00:15<01:18,  5.23it/s]


 18%|███████▌                                  | 90/500 [00:15<01:16,  5.38it/s]


 18%|███████▋                                  | 91/500 [00:16<01:14,  5.49it/s]


 18%|███████▋                                  | 92/500 [00:16<01:16,  5.35it/s]


 19%|███████▊                                  | 93/500 [00:16<01:16,  5.33it/s]


 19%|███████▉                                  | 94/500 [00:16<01:16,  5.30it/s]


 19%|███████▉                                  | 95/500 [00:16<01:13,  5.48it/s]


 19%|████████                                  | 96/500 [00:16<01:13,  5.52it/s]


 19%|████████▏                                 | 97/500 [00:17<01:12,  5.58it/s]


 20%|████████▏                                 | 98/500 [00:17<01:12,  5.56it/s]


 20%|████████▎                                 | 99/500 [00:17<01:11,  5.57it/s]


 20%|████████▏                                | 100/500 [00:17<01:11,  5.63it/s]


 20%|████████▎                                | 101/500 [00:17<01:10,  5.68it/s]


 20%|████████▎                                | 102/500 [00:18<01:09,  5.70it/s]


 21%|████████▍                                | 103/500 [00:18<01:10,  5.64it/s]


 21%|████████▌                                | 104/500 [00:18<01:10,  5.63it/s]


 21%|████████▌                                | 105/500 [00:18<01:09,  5.66it/s]


 21%|████████▋                                | 106/500 [00:18<01:09,  5.67it/s]


 21%|████████▊                                | 107/500 [00:18<01:09,  5.63it/s]


 22%|████████▊                                | 108/500 [00:19<01:09,  5.68it/s]


 22%|████████▉                                | 109/500 [00:19<01:08,  5.74it/s]


 22%|█████████                                | 110/500 [00:19<01:07,  5.77it/s]


 22%|█████████                                | 111/500 [00:19<01:06,  5.82it/s]


 22%|█████████▏                               | 112/500 [00:19<01:07,  5.72it/s]


 23%|█████████▎                               | 113/500 [00:19<01:08,  5.68it/s]


 23%|█████████▎                               | 114/500 [00:20<01:09,  5.58it/s]


 23%|█████████▍                               | 115/500 [00:20<01:08,  5.63it/s]


 23%|█████████▌                               | 116/500 [00:20<01:07,  5.71it/s]


 23%|█████████▌                               | 117/500 [00:20<01:06,  5.79it/s]


 24%|█████████▋                               | 118/500 [00:20<01:06,  5.78it/s]


 24%|█████████▊                               | 119/500 [00:21<01:06,  5.70it/s]


 24%|█████████▊                               | 120/500 [00:21<01:07,  5.61it/s]


 24%|█████████▉                               | 121/500 [00:21<01:06,  5.73it/s]


 24%|██████████                               | 122/500 [00:21<01:06,  5.72it/s]


 25%|██████████                               | 123/500 [00:21<01:06,  5.64it/s]


 25%|██████████▏                              | 124/500 [00:21<01:06,  5.63it/s]


 25%|██████████▎                              | 125/500 [00:22<01:06,  5.60it/s]


 25%|██████████▎                              | 126/500 [00:22<01:07,  5.52it/s]


 25%|██████████▍                              | 127/500 [00:22<01:06,  5.58it/s]


 26%|██████████▍                              | 128/500 [00:22<01:05,  5.68it/s]


 26%|██████████▌                              | 129/500 [00:22<01:04,  5.76it/s]


 26%|██████████▋                              | 130/500 [00:22<01:04,  5.71it/s]


 26%|██████████▋                              | 131/500 [00:23<01:05,  5.63it/s]


 26%|██████████▊                              | 132/500 [00:23<01:07,  5.49it/s]


 27%|██████████▉                              | 133/500 [00:23<01:06,  5.50it/s]


 27%|██████████▉                              | 134/500 [00:23<01:06,  5.53it/s]


 27%|███████████                              | 135/500 [00:23<01:06,  5.50it/s]


 27%|███████████▏                             | 136/500 [00:24<01:06,  5.50it/s]


 27%|███████████▏                             | 137/500 [00:24<01:05,  5.56it/s]


 28%|███████████▎                             | 138/500 [00:24<01:05,  5.56it/s]


 28%|███████████▍                             | 139/500 [00:24<01:04,  5.58it/s]


 28%|███████████▍                             | 140/500 [00:24<01:04,  5.62it/s]


 28%|███████████▌                             | 141/500 [00:24<01:03,  5.70it/s]


 28%|███████████▋                             | 142/500 [00:25<01:02,  5.69it/s]


 29%|███████████▋                             | 143/500 [00:25<01:03,  5.62it/s]


 29%|███████████▊                             | 144/500 [00:25<01:03,  5.64it/s]


 29%|███████████▉                             | 145/500 [00:25<01:03,  5.59it/s]


 29%|███████████▉                             | 146/500 [00:25<01:03,  5.54it/s]


 29%|████████████                             | 147/500 [00:26<01:03,  5.54it/s]


 30%|████████████▏                            | 148/500 [00:26<01:04,  5.48it/s]


 30%|████████████▏                            | 149/500 [00:26<01:04,  5.46it/s]


 30%|████████████▎                            | 150/500 [00:26<01:04,  5.42it/s]


 30%|████████████▍                            | 151/500 [00:26<01:03,  5.47it/s]


 30%|████████████▍                            | 152/500 [00:26<01:02,  5.54it/s]


 31%|████████████▌                            | 153/500 [00:27<01:02,  5.52it/s]


 31%|████████████▋                            | 154/500 [00:27<01:02,  5.53it/s]


 31%|████████████▋                            | 155/500 [00:27<01:01,  5.58it/s]


 31%|████████████▊                            | 156/500 [00:27<01:01,  5.64it/s]


 31%|████████████▊                            | 157/500 [00:27<01:00,  5.69it/s]


 32%|████████████▉                            | 158/500 [00:28<01:00,  5.66it/s]


 32%|█████████████                            | 159/500 [00:28<00:59,  5.69it/s]


 32%|█████████████                            | 160/500 [00:28<00:59,  5.71it/s]


 32%|█████████████▏                           | 161/500 [00:28<00:58,  5.79it/s]


 32%|█████████████▎                           | 162/500 [00:28<00:58,  5.82it/s]


 33%|█████████████▎                           | 163/500 [00:28<00:57,  5.84it/s]


 33%|█████████████▍                           | 164/500 [00:29<00:57,  5.82it/s]['hazelnut', 1.0, 0.9885039810811737, 0.9362842503417921]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 5/10 for metal_nut




| feature extraction | train | metal_nut |:   0%|         | 0/7 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:




| feature extraction | train | metal_nut |:  14%|▏| 1/7 [00:00<00:04,  1.36it/s]



| feature extraction | train | metal_nut |:  29%|▎| 2/7 [00:01<00:03,  1.38it/s]



| feature extraction | train | metal_nut |:  43%|▍| 3/7 [00:02<00:02,  1.38it/s]



| feature extraction | train | metal_nut |:  57%|▌| 4/7 [00:02<00:02,  1.39it/s]



| feature extraction | train | metal_nut |:  71%|▋| 5/7 [00:03<00:01,  1.39it/s]



| feature extraction | train | metal_nut |:  86%|▊| 6/7 [00:04<00:00,  1.40it/s]



| feature extraction | train | metal_nut |: 100%|█| 7/7 [00:04<00:00,  1.43it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [22528, 384].
2022-04-22 18:03:57	Train ends, total 74.07s
Saving model...
2022-04-22 18:03:57	Save model in ./output/coreset_resnet18_10/metal_nut.pdparams
2022-04-22 18:03:57	Starting eval model...




| feature extraction | test | metal_nut |:   0%|        | 0/115 [00:00<?, ?it/s]



| feature extraction | test | metal_nut |:   1%| | 1/115 [00:00<00:34,  3.29it/s]



| feature extraction | test | metal_nut |:   2%| | 2/115 [00:00<00:33,  3.41it/s]



| feature extraction | test | metal_nut |:   3%| | 3/115 [00:00<00:32,  3.50it/s]



| feature extraction | test | metal_nut |:   3%| | 4/115 [00:01<00:31,  3.56it/s]



| feature extraction | test | metal_nut |:   4%| | 5/115 [00:01<00:30,  3.61it/s]



| feature extraction | test | metal_nut |:   5%| | 6/115 [00:01<00:29,  3.64it/s]



| feature extraction | test | metal_nut |:   6%| | 7/115 [00:01<00:29,  3.67it/s]



| feature extraction | test | metal_nut |:   7%| | 8/115 [00:02<00:29,  3.68it/s]



| feature extraction | test | metal_nut |:   8%| | 9/115 [00:02<00:28,  3.70it/s]



| feature extraction | test | metal_nut |:   9%| | 10/115 [00:02<00:28,  3.70it/s]



| feature extraction | test | metal_nut |:  10%| | 11/115 [00:02<00:28,  3.71it/s]



| feature extraction | test | metal_nut |:  10%| | 12/115 [00:03<00:27,  3.72it/s]



| feature extraction | test | metal_nut |:  11%| | 13/115 [00:03<00:27,  3.72it/s]



| feature extraction | test | metal_nut |:  12%| | 14/115 [00:03<00:27,  3.72it/s]



| feature extraction | test | metal_nut |:  13%|▏| 15/115 [00:04<00:26,  3.73it/s]



| feature extraction | test | metal_nut |:  14%|▏| 16/115 [00:04<00:26,  3.73it/s]



| feature extraction | test | metal_nut |:  15%|▏| 17/115 [00:04<00:26,  3.73it/s]



| feature extraction | test | metal_nut |:  16%|▏| 18/115 [00:04<00:26,  3.73it/s]



| feature extraction | test | metal_nut |:  17%|▏| 19/115 [00:05<00:25,  3.73it/s]



| feature extraction | test | metal_nut |:  17%|▏| 20/115 [00:05<00:25,  3.73it/s]



| feature extraction | test | metal_nut |:  18%|▏| 21/115 [00:05<00:25,  3.73it/s]



| feature extraction | test | metal_nut |:  19%|▏| 22/115 [00:05<00:24,  3.73it/s]



| feature extraction | test | metal_nut |:  20%|▏| 23/115 [00:06<00:24,  3.73it/s]



| feature extraction | test | metal_nut |:  21%|▏| 24/115 [00:06<00:24,  3.73it/s]



| feature extraction | test | metal_nut |:  22%|▏| 25/115 [00:06<00:24,  3.73it/s]



| feature extraction | test | metal_nut |:  23%|▏| 26/115 [00:07<00:23,  3.73it/s]



| feature extraction | test | metal_nut |:  23%|▏| 27/115 [00:07<00:23,  3.73it/s]



| feature extraction | test | metal_nut |:  24%|▏| 28/115 [00:07<00:23,  3.72it/s]



| feature extraction | test | metal_nut |:  25%|▎| 29/115 [00:07<00:23,  3.73it/s]



| feature extraction | test | metal_nut |:  26%|▎| 30/115 [00:08<00:22,  3.72it/s]



| feature extraction | test | metal_nut |:  27%|▎| 31/115 [00:08<00:22,  3.73it/s]



| feature extraction | test | metal_nut |:  28%|▎| 32/115 [00:08<00:22,  3.72it/s]



| feature extraction | test | metal_nut |:  29%|▎| 33/115 [00:08<00:22,  3.72it/s]



| feature extraction | test | metal_nut |:  30%|▎| 34/115 [00:09<00:21,  3.72it/s]



| feature extraction | test | metal_nut |:  30%|▎| 35/115 [00:09<00:21,  3.73it/s]



| feature extraction | test | metal_nut |:  31%|▎| 36/115 [00:09<00:21,  3.73it/s]



| feature extraction | test | metal_nut |:  32%|▎| 37/115 [00:09<00:20,  3.73it/s]



| feature extraction | test | metal_nut |:  33%|▎| 38/115 [00:10<00:20,  3.73it/s]



| feature extraction | test | metal_nut |:  34%|▎| 39/115 [00:10<00:20,  3.73it/s]



| feature extraction | test | metal_nut |:  35%|▎| 40/115 [00:10<00:20,  3.72it/s]



| feature extraction | test | metal_nut |:  36%|▎| 41/115 [00:11<00:19,  3.73it/s]



| feature extraction | test | metal_nut |:  37%|▎| 42/115 [00:11<00:19,  3.72it/s]



| feature extraction | test | metal_nut |:  37%|▎| 43/115 [00:11<00:19,  3.73it/s]



| feature extraction | test | metal_nut |:  38%|▍| 44/115 [00:11<00:19,  3.73it/s]



| feature extraction | test | metal_nut |:  39%|▍| 45/115 [00:12<00:18,  3.73it/s]



| feature extraction | test | metal_nut |:  40%|▍| 46/115 [00:12<00:18,  3.73it/s]



| feature extraction | test | metal_nut |:  41%|▍| 47/115 [00:12<00:18,  3.74it/s]



| feature extraction | test | metal_nut |:  42%|▍| 48/115 [00:12<00:17,  3.74it/s]



| feature extraction | test | metal_nut |:  43%|▍| 49/115 [00:13<00:17,  3.75it/s]



| feature extraction | test | metal_nut |:  43%|▍| 50/115 [00:13<00:17,  3.74it/s]



| feature extraction | test | metal_nut |:  44%|▍| 51/115 [00:13<00:17,  3.75it/s]



| feature extraction | test | metal_nut |:  45%|▍| 52/115 [00:13<00:16,  3.74it/s]



| feature extraction | test | metal_nut |:  46%|▍| 53/115 [00:14<00:16,  3.75it/s]



| feature extraction | test | metal_nut |:  47%|▍| 54/115 [00:14<00:16,  3.74it/s]



| feature extraction | test | metal_nut |:  48%|▍| 55/115 [00:14<00:16,  3.74it/s]



| feature extraction | test | metal_nut |:  49%|▍| 56/115 [00:15<00:15,  3.74it/s]



| feature extraction | test | metal_nut |:  50%|▍| 57/115 [00:15<00:15,  3.70it/s]



| feature extraction | test | metal_nut |:  50%|▌| 58/115 [00:15<00:15,  3.71it/s]



| feature extraction | test | metal_nut |:  51%|▌| 59/115 [00:15<00:15,  3.66it/s]



| feature extraction | test | metal_nut |:  52%|▌| 60/115 [00:16<00:14,  3.68it/s]



| feature extraction | test | metal_nut |:  53%|▌| 61/115 [00:16<00:14,  3.69it/s]



| feature extraction | test | metal_nut |:  54%|▌| 62/115 [00:16<00:14,  3.70it/s]



| feature extraction | test | metal_nut |:  55%|▌| 63/115 [00:16<00:14,  3.71it/s]



| feature extraction | test | metal_nut |:  56%|▌| 64/115 [00:17<00:13,  3.71it/s]



| feature extraction | test | metal_nut |:  57%|▌| 65/115 [00:17<00:13,  3.72it/s]



| feature extraction | test | metal_nut |:  57%|▌| 66/115 [00:17<00:13,  3.71it/s]



| feature extraction | test | metal_nut |:  58%|▌| 67/115 [00:18<00:12,  3.70it/s]



| feature extraction | test | metal_nut |:  59%|▌| 68/115 [00:18<00:12,  3.71it/s]



| feature extraction | test | metal_nut |:  60%|▌| 69/115 [00:18<00:12,  3.71it/s]



| feature extraction | test | metal_nut |:  61%|▌| 70/115 [00:18<00:12,  3.71it/s]



| feature extraction | test | metal_nut |:  62%|▌| 71/115 [00:19<00:11,  3.72it/s]



| feature extraction | test | metal_nut |:  63%|▋| 72/115 [00:19<00:11,  3.71it/s]



| feature extraction | test | metal_nut |:  63%|▋| 73/115 [00:19<00:11,  3.71it/s]



| feature extraction | test | metal_nut |:  64%|▋| 74/115 [00:19<00:11,  3.72it/s]



| feature extraction | test | metal_nut |:  65%|▋| 75/115 [00:20<00:10,  3.72it/s]



| feature extraction | test | metal_nut |:  66%|▋| 76/115 [00:20<00:10,  3.72it/s]



| feature extraction | test | metal_nut |:  67%|▋| 77/115 [00:20<00:10,  3.72it/s]



| feature extraction | test | metal_nut |:  68%|▋| 78/115 [00:20<00:09,  3.72it/s]



| feature extraction | test | metal_nut |:  69%|▋| 79/115 [00:21<00:09,  3.72it/s]



| feature extraction | test | metal_nut |:  70%|▋| 80/115 [00:21<00:09,  3.72it/s]



| feature extraction | test | metal_nut |:  70%|▋| 81/115 [00:21<00:09,  3.72it/s]



| feature extraction | test | metal_nut |:  71%|▋| 82/115 [00:22<00:08,  3.72it/s]



| feature extraction | test | metal_nut |:  72%|▋| 83/115 [00:22<00:08,  3.72it/s]



| feature extraction | test | metal_nut |:  73%|▋| 84/115 [00:22<00:08,  3.72it/s]



| feature extraction | test | metal_nut |:  74%|▋| 85/115 [00:22<00:08,  3.72it/s]



| feature extraction | test | metal_nut |:  75%|▋| 86/115 [00:23<00:07,  3.72it/s]



| feature extraction | test | metal_nut |:  76%|▊| 87/115 [00:23<00:07,  3.72it/s]



| feature extraction | test | metal_nut |:  77%|▊| 88/115 [00:23<00:07,  3.72it/s]



| feature extraction | test | metal_nut |:  77%|▊| 89/115 [00:23<00:06,  3.73it/s]



| feature extraction | test | metal_nut |:  78%|▊| 90/115 [00:24<00:06,  3.73it/s]



| feature extraction | test | metal_nut |:  79%|▊| 91/115 [00:24<00:06,  3.73it/s]



| feature extraction | test | metal_nut |:  80%|▊| 92/115 [00:24<00:06,  3.73it/s]



| feature extraction | test | metal_nut |:  81%|▊| 93/115 [00:25<00:05,  3.73it/s]



| feature extraction | test | metal_nut |:  82%|▊| 94/115 [00:25<00:05,  3.73it/s]



| feature extraction | test | metal_nut |:  83%|▊| 95/115 [00:25<00:05,  3.73it/s]



| feature extraction | test | metal_nut |:  83%|▊| 96/115 [00:25<00:05,  3.73it/s]



| feature extraction | test | metal_nut |:  84%|▊| 97/115 [00:26<00:04,  3.74it/s]



| feature extraction | test | metal_nut |:  85%|▊| 98/115 [00:26<00:04,  3.73it/s]



| feature extraction | test | metal_nut |:  86%|▊| 99/115 [00:26<00:04,  3.73it/s]



| feature extraction | test | metal_nut |:  87%|▊| 100/115 [00:26<00:04,  3.73it/s]



| feature extraction | test | metal_nut |:  88%|▉| 101/115 [00:27<00:03,  3.68it/s]



| feature extraction | test | metal_nut |:  89%|▉| 102/115 [00:27<00:03,  3.70it/s]



| feature extraction | test | metal_nut |:  90%|▉| 103/115 [00:27<00:03,  3.71it/s]



| feature extraction | test | metal_nut |:  90%|▉| 104/115 [00:27<00:02,  3.72it/s]



| feature extraction | test | metal_nut |:  91%|▉| 105/115 [00:28<00:02,  3.73it/s]



| feature extraction | test | metal_nut |:  92%|▉| 106/115 [00:28<00:02,  3.73it/s]



| feature extraction | test | metal_nut |:  93%|▉| 107/115 [00:28<00:02,  3.73it/s]



| feature extraction | test | metal_nut |:  94%|▉| 108/115 [00:29<00:01,  3.73it/s]



| feature extraction | test | metal_nut |:  95%|▉| 109/115 [00:29<00:01,  3.73it/s]



| feature extraction | test | metal_nut |:  96%|▉| 110/115 [00:29<00:01,  3.73it/s]



| feature extraction | test | metal_nut |:  97%|▉| 111/115 [00:29<00:01,  3.73it/s]



| feature extraction | test | metal_nut |:  97%|▉| 112/115 [00:30<00:00,  3.75it/s]



| feature extraction | test | metal_nut |:  98%|▉| 113/115 [00:30<00:00,  3.75it/s]



| feature extraction | test | metal_nut |:  99%|▉| 114/115 [00:30<00:00,  3.75it/s]



| feature extraction | test | metal_nut |: 100%|█| 115/115 [00:30<00:00,  3.72it/s]
max_score:3.3297696113586426 min_score:0.4609236717224121
F1 image:0.9836065573770492 threshold:3.3297696113586426
F1 pixel:0.8316242013537537 threshold:3.3297696113586426




  0%|                                                   | 0/500 [00:00<?, ?it/s]



  0%|                                           | 1/500 [00:00<01:54,  4.37it/s]



  0%|▏                                          | 2/500 [00:00<01:56,  4.29it/s]



  1%|▎                                          | 3/500 [00:00<02:03,  4.03it/s]



  1%|▎                                          | 4/500 [00:00<01:58,  4.18it/s]



  1%|▍                                          | 5/500 [00:01<01:55,  4.29it/s]



  1%|▌                                          | 6/500 [00:01<01:53,  4.35it/s]



  1%|▌                                          | 7/500 [00:01<01:52,  4.40it/s]



  2%|▋                                          | 8/500 [00:01<01:51,  4.41it/s]



  2%|▊                                          | 9/500 [00:02<01:49,  4.46it/s]



  2%|▊                                         | 10/500 [00:02<01:49,  4.49it/s]



  2%|▉                                         | 11/500 [00:02<01:48,  4.52it/s]



  2%|█                                         | 12/500 [00:02<01:47,  4.52it/s]



  3%|█                                         | 13/500 [00:02<01:50,  4.43it/s]



  3%|█▏                                        | 14/500 [00:03<01:51,  4.34it/s]



  3%|█▎                                        | 15/500 [00:03<01:52,  4.33it/s]



  3%|█▎                                        | 16/500 [00:03<01:50,  4.39it/s]



  3%|█▍                                        | 17/500 [00:03<01:49,  4.43it/s]



  4%|█▌                                        | 18/500 [00:04<01:49,  4.40it/s]



  4%|█▌                                        | 19/500 [00:04<01:51,  4.32it/s]



  4%|█▋                                        | 20/500 [00:04<01:52,  4.28it/s]



  4%|█▊                                        | 21/500 [00:04<01:49,  4.38it/s]



  4%|█▊                                        | 22/500 [00:05<01:47,  4.43it/s]



  5%|█▉                                        | 23/500 [00:05<01:46,  4.48it/s]



  5%|██                                        | 24/500 [00:05<01:45,  4.52it/s]



  5%|██                                        | 25/500 [00:05<01:44,  4.54it/s]



  5%|██▏                                       | 26/500 [00:05<01:43,  4.56it/s]



  5%|██▎                                       | 27/500 [00:06<01:42,  4.60it/s]



  6%|██▎                                       | 28/500 [00:06<01:42,  4.60it/s]



  6%|██▍                                       | 29/500 [00:06<01:42,  4.60it/s]



  6%|██▌                                       | 30/500 [00:06<01:42,  4.58it/s]



  6%|██▌                                       | 31/500 [00:06<01:42,  4.58it/s]



  6%|██▋                                       | 32/500 [00:07<01:42,  4.58it/s]



  7%|██▊                                       | 33/500 [00:07<01:41,  4.60it/s]



  7%|██▊                                       | 34/500 [00:07<01:41,  4.59it/s]



  7%|██▉                                       | 35/500 [00:07<01:41,  4.59it/s]



  7%|███                                       | 36/500 [00:08<01:41,  4.57it/s]



  7%|███                                       | 37/500 [00:08<01:41,  4.56it/s]



  8%|███▏                                      | 38/500 [00:08<01:41,  4.54it/s]



  8%|███▎                                      | 39/500 [00:08<01:41,  4.55it/s]



  8%|███▎                                      | 40/500 [00:08<01:41,  4.55it/s]



  8%|███▍                                      | 41/500 [00:09<01:40,  4.56it/s]



  8%|███▌                                      | 42/500 [00:09<01:41,  4.53it/s]



  9%|███▌                                      | 43/500 [00:09<01:40,  4.53it/s]



  9%|███▋                                      | 44/500 [00:09<01:41,  4.49it/s]



  9%|███▊                                      | 45/500 [00:10<01:41,  4.49it/s]



  9%|███▊                                      | 46/500 [00:10<01:41,  4.47it/s]



  9%|███▉                                      | 47/500 [00:10<01:41,  4.47it/s]



 10%|████                                      | 48/500 [00:10<01:40,  4.49it/s]



 10%|████                                      | 49/500 [00:10<01:39,  4.53it/s]



 10%|████▏                                     | 50/500 [00:11<01:39,  4.53it/s]



 10%|████▎                                     | 51/500 [00:11<01:40,  4.47it/s]



 10%|████▎                                     | 52/500 [00:11<01:39,  4.50it/s]



 11%|████▍                                     | 53/500 [00:11<01:38,  4.52it/s]



 11%|████▌                                     | 54/500 [00:12<01:38,  4.54it/s]



 11%|████▌                                     | 55/500 [00:12<01:39,  4.49it/s]



 11%|████▋                                     | 56/500 [00:12<01:38,  4.53it/s]



 11%|████▊                                     | 57/500 [00:12<01:37,  4.55it/s]



 12%|████▊                                     | 58/500 [00:12<01:37,  4.55it/s]



 12%|████▉                                     | 59/500 [00:13<01:36,  4.58it/s]



 12%|█████                                     | 60/500 [00:13<01:36,  4.57it/s]



 12%|█████                                     | 61/500 [00:13<01:36,  4.57it/s]



 12%|█████▏                                    | 62/500 [00:13<01:37,  4.51it/s]



 13%|█████▎                                    | 63/500 [00:14<01:35,  4.56it/s]



 13%|█████▍                                    | 64/500 [00:14<01:35,  4.56it/s]



 13%|█████▍                                    | 65/500 [00:14<01:37,  4.47it/s]



 13%|█████▌                                    | 66/500 [00:14<01:37,  4.44it/s]



 13%|█████▋                                    | 67/500 [00:14<01:36,  4.50it/s]



 14%|█████▋                                    | 68/500 [00:15<01:35,  4.52it/s]



 14%|█████▊                                    | 69/500 [00:15<01:35,  4.51it/s]



 14%|█████▉                                    | 70/500 [00:15<01:37,  4.43it/s]



 14%|█████▉                                    | 71/500 [00:15<01:35,  4.48it/s]



 14%|██████                                    | 72/500 [00:16<01:34,  4.55it/s]



 15%|██████▏                                   | 73/500 [00:16<01:32,  4.60it/s]



 15%|██████▏                                   | 74/500 [00:16<01:33,  4.54it/s]



 15%|██████▎                                   | 75/500 [00:16<01:35,  4.47it/s]



 15%|██████▍                                   | 76/500 [00:16<01:34,  4.47it/s]



 15%|██████▍                                   | 77/500 [00:17<01:33,  4.53it/s]



 16%|██████▌                                   | 78/500 [00:17<01:33,  4.52it/s]



 16%|██████▋                                   | 79/500 [00:17<01:31,  4.58it/s]



 16%|██████▋                                   | 80/500 [00:17<01:30,  4.62it/s]



 16%|██████▊                                   | 81/500 [00:18<01:30,  4.63it/s]



 16%|██████▉                                   | 82/500 [00:18<01:29,  4.65it/s]



 17%|██████▉                                   | 83/500 [00:18<01:31,  4.57it/s]



 17%|███████                                   | 84/500 [00:18<01:31,  4.56it/s]



 17%|███████▏                                  | 85/500 [00:18<01:30,  4.60it/s]



 17%|███████▏                                  | 86/500 [00:19<01:29,  4.60it/s]



 17%|███████▎                                  | 87/500 [00:19<01:31,  4.49it/s]



 18%|███████▍                                  | 88/500 [00:19<01:32,  4.47it/s]



 18%|███████▍                                  | 89/500 [00:19<01:31,  4.48it/s]



 18%|███████▌                                  | 90/500 [00:20<01:31,  4.49it/s]



 18%|███████▋                                  | 91/500 [00:20<01:29,  4.55it/s]



 18%|███████▋                                  | 92/500 [00:20<01:30,  4.53it/s]



 19%|███████▊                                  | 93/500 [00:20<01:29,  4.53it/s]



 19%|███████▉                                  | 94/500 [00:20<01:29,  4.53it/s]



 19%|███████▉                                  | 95/500 [00:21<01:31,  4.42it/s]



 19%|████████                                  | 96/500 [00:21<01:36,  4.17it/s]



 19%|████████▏                                 | 97/500 [00:21<01:36,  4.19it/s]



 20%|████████▏                                 | 98/500 [00:21<01:34,  4.23it/s]



 20%|████████▎                                 | 99/500 [00:22<01:32,  4.32it/s]



 20%|████████▏                                | 100/500 [00:22<01:32,  4.33it/s]



 20%|████████▎                                | 101/500 [00:22<01:31,  4.37it/s]



 20%|████████▎                                | 102/500 [00:22<01:29,  4.43it/s]



 21%|████████▍                                | 103/500 [00:22<01:28,  4.49it/s]



 21%|████████▌                                | 104/500 [00:23<01:27,  4.53it/s]



 21%|████████▌                                | 105/500 [00:23<01:27,  4.50it/s]



 21%|████████▋                                | 106/500 [00:23<01:27,  4.48it/s]



 21%|████████▊                                | 107/500 [00:23<01:28,  4.46it/s]



 22%|████████▊                                | 108/500 [00:24<01:27,  4.47it/s]



 22%|████████▉                                | 109/500 [00:24<01:26,  4.51it/s]



 22%|█████████                                | 110/500 [00:24<01:27,  4.47it/s]



 22%|█████████                                | 111/500 [00:24<01:27,  4.43it/s]



 22%|█████████▏                               | 112/500 [00:24<01:26,  4.49it/s]



 23%|█████████▎                               | 113/500 [00:25<01:25,  4.52it/s]



 23%|█████████▎                               | 114/500 [00:25<01:26,  4.49it/s]



 23%|█████████▍                               | 115/500 [00:25<01:24,  4.53it/s]



 23%|█████████▌                               | 116/500 [00:25<01:24,  4.57it/s]



 23%|█████████▌                               | 117/500 [00:26<01:23,  4.61it/s]



 24%|█████████▋                               | 118/500 [00:26<01:22,  4.61it/s]



 24%|█████████▊                               | 119/500 [00:26<01:22,  4.63it/s]



 24%|█████████▊                               | 120/500 [00:26<01:22,  4.61it/s]



 24%|█████████▉                               | 121/500 [00:26<01:21,  4.63it/s]



 24%|██████████                               | 122/500 [00:27<01:21,  4.62it/s]



 25%|██████████                               | 123/500 [00:27<01:21,  4.61it/s]



 25%|██████████▏                              | 124/500 [00:27<01:21,  4.61it/s]



 25%|██████████▎                              | 125/500 [00:27<01:21,  4.62it/s]



 25%|██████████▎                              | 126/500 [00:28<01:21,  4.61it/s]



 25%|██████████▍                              | 127/500 [00:28<01:21,  4.60it/s]



 26%|██████████▍                              | 128/500 [00:28<01:21,  4.57it/s]



 26%|██████████▌                              | 129/500 [00:28<01:21,  4.58it/s]



 26%|██████████▋                              | 130/500 [00:28<01:22,  4.50it/s]



 26%|██████████▋                              | 131/500 [00:29<01:21,  4.54it/s]



 26%|██████████▊                              | 132/500 [00:29<01:20,  4.54it/s]



 27%|██████████▉                              | 133/500 [00:29<01:20,  4.55it/s]



 27%|██████████▉                              | 134/500 [00:29<01:20,  4.55it/s]



 27%|███████████                              | 135/500 [00:29<01:19,  4.58it/s]



 27%|███████████▏                             | 136/500 [00:30<01:19,  4.57it/s]



 27%|███████████▏                             | 137/500 [00:30<01:19,  4.58it/s]



 28%|███████████▎                             | 138/500 [00:30<01:19,  4.55it/s]



 28%|███████████▍                             | 139/500 [00:30<01:19,  4.54it/s]



 28%|███████████▍                             | 140/500 [00:31<01:18,  4.57it/s]



 28%|███████████▌                             | 141/500 [00:31<01:18,  4.60it/s]



 28%|███████████▋                             | 142/500 [00:31<01:19,  4.48it/s]



 29%|███████████▋                             | 143/500 [00:31<01:19,  4.52it/s]



 29%|███████████▊                             | 144/500 [00:31<01:18,  4.55it/s]



 29%|███████████▉                             | 145/500 [00:32<01:17,  4.58it/s]



 29%|███████████▉                             | 146/500 [00:32<01:17,  4.58it/s]



 29%|████████████                             | 147/500 [00:32<01:16,  4.60it/s]



 30%|████████████▏                            | 148/500 [00:32<01:16,  4.58it/s]



 30%|████████████▏                            | 149/500 [00:33<01:16,  4.60it/s]



 30%|████████████▎                            | 150/500 [00:33<01:16,  4.59it/s]



 30%|████████████▍                            | 151/500 [00:33<01:16,  4.57it/s]



 30%|████████████▍                            | 152/500 [00:33<01:16,  4.53it/s]



 31%|████████████▌                            | 153/500 [00:33<01:17,  4.49it/s]



 31%|████████████▋                            | 154/500 [00:34<01:17,  4.47it/s]



 31%|████████████▋                            | 155/500 [00:34<01:18,  4.41it/s]



 31%|████████████▊                            | 156/500 [00:34<01:19,  4.35it/s]



 31%|████████████▊                            | 157/500 [00:34<01:18,  4.37it/s]



 32%|████████████▉                            | 158/500 [00:35<01:18,  4.38it/s]



 32%|█████████████                            | 159/500 [00:35<01:17,  4.40it/s]



 32%|█████████████                            | 160/500 [00:35<01:16,  4.42it/s]



 32%|█████████████▏                           | 161/500 [00:35<01:16,  4.41it/s]



 32%|█████████████▎                           | 162/500 [00:36<01:15,  4.45it/s]



 33%|█████████████▎                           | 163/500 [00:36<01:14,  4.50it/s]



 33%|█████████████▍                           | 164/500 [00:36<01:14,  4.52it/s]



 33%|█████████████▌                           | 165/500 [00:36<01:13,  4.53it/s]



 33%|█████████████▌                           | 166/500 [00:36<01:13,  4.53it/s]



 33%|█████████████▋                           | 167/500 [00:37<01:13,  4.53it/s]



 34%|█████████████▊                           | 168/500 [00:37<01:13,  4.53it/s]



 34%|█████████████▊                           | 169/500 [00:37<01:12,  4.54it/s]



 34%|█████████████▉                           | 170/500 [00:37<01:12,  4.55it/s]



 34%|██████████████                           | 171/500 [00:37<01:11,  4.58it/s]



 34%|██████████████                           | 172/500 [00:38<01:12,  4.50it/s]



 35%|██████████████▏                          | 173/500 [00:38<01:12,  4.53it/s]



 35%|██████████████▎                          | 174/500 [00:38<01:12,  4.52it/s]



 35%|██████████████▎                          | 175/500 [00:38<01:11,  4.54it/s]



 35%|██████████████▍                          | 176/500 [00:39<01:11,  4.55it/s]



 35%|██████████████▌                          | 177/500 [00:39<01:10,  4.58it/s]



 36%|██████████████▌                          | 178/500 [00:39<01:10,  4.59it/s]



 36%|██████████████▋                          | 179/500 [00:39<01:10,  4.58it/s]



 36%|██████████████▊                          | 180/500 [00:39<01:09,  4.58it/s]



 36%|██████████████▊                          | 181/500 [00:40<01:09,  4.58it/s]



 36%|██████████████▉                          | 182/500 [00:40<01:09,  4.56it/s]



 37%|███████████████                          | 183/500 [00:40<01:09,  4.55it/s]



 37%|███████████████                          | 184/500 [00:40<01:09,  4.53it/s]



 37%|███████████████▏                         | 185/500 [00:41<01:09,  4.55it/s]



 37%|███████████████▎                         | 186/500 [00:41<01:08,  4.56it/s]



 37%|███████████████▎                         | 187/500 [00:41<01:08,  4.54it/s]



 38%|███████████████▍                         | 188/500 [00:41<01:09,  4.50it/s]



 38%|███████████████▍                         | 189/500 [00:41<01:08,  4.52it/s]



 38%|███████████████▌                         | 190/500 [00:42<01:10,  4.42it/s]



 38%|███████████████▋                         | 191/500 [00:42<01:09,  4.42it/s]



 38%|███████████████▋                         | 192/500 [00:42<01:10,  4.39it/s]



 39%|███████████████▊                         | 193/500 [00:42<01:09,  4.40it/s]



 39%|███████████████▉                         | 194/500 [00:43<01:08,  4.45it/s]



 39%|███████████████▉                         | 195/500 [00:43<01:07,  4.49it/s]



 39%|████████████████                         | 196/500 [00:43<01:07,  4.50it/s]



 39%|████████████████▏                        | 197/500 [00:43<01:08,  4.45it/s]



 40%|████████████████▏                        | 198/500 [00:43<01:07,  4.44it/s]



 40%|████████████████▎                        | 199/500 [00:44<01:07,  4.45it/s]



 40%|████████████████▍                        | 200/500 [00:44<01:08,  4.38it/s]



 40%|████████████████▍                        | 201/500 [00:44<01:08,  4.40it/s]



 40%|████████████████▌                        | 202/500 [00:44<01:08,  4.33it/s]



 41%|████████████████▋                        | 203/500 [00:45<01:08,  4.32it/s]



 41%|████████████████▋                        | 204/500 [00:45<01:08,  4.33it/s]



 41%|████████████████▊                        | 205/500 [00:45<01:07,  4.34it/s]



 41%|████████████████▉                        | 206/500 [00:45<01:07,  4.34it/s]



 41%|████████████████▉                        | 207/500 [00:46<01:06,  4.40it/s]



 42%|█████████████████                        | 208/500 [00:46<01:05,  4.44it/s]



 42%|█████████████████▏                       | 209/500 [00:46<01:05,  4.46it/s]



 42%|█████████████████▏                       | 210/500 [00:46<01:04,  4.49it/s]



 42%|█████████████████▎                       | 211/500 [00:46<01:04,  4.45it/s]



 42%|█████████████████▍                       | 212/500 [00:47<01:03,  4.50it/s]



 43%|█████████████████▍                       | 213/500 [00:47<01:03,  4.53it/s]



 43%|█████████████████▌                       | 214/500 [00:47<01:02,  4.56it/s]



 43%|█████████████████▋                       | 215/500 [00:47<01:02,  4.56it/s]



 43%|█████████████████▋                       | 216/500 [00:48<01:01,  4.59it/s]



 43%|█████████████████▊                       | 217/500 [00:48<01:01,  4.59it/s]



 44%|█████████████████▉                       | 218/500 [00:48<01:01,  4.55it/s]



 44%|█████████████████▉                       | 219/500 [00:48<01:02,  4.53it/s]



 44%|██████████████████                       | 220/500 [00:48<01:01,  4.56it/s]



 44%|██████████████████                       | 221/500 [00:49<01:01,  4.54it/s]



 44%|██████████████████▏                      | 222/500 [00:49<01:02,  4.48it/s]



 45%|██████████████████▎                      | 223/500 [00:49<01:01,  4.48it/s]



 45%|██████████████████▎                      | 224/500 [00:49<01:03,  4.36it/s]



 45%|██████████████████▍                      | 225/500 [00:50<01:03,  4.33it/s]



 45%|██████████████████▌                      | 226/500 [00:50<01:03,  4.33it/s]



 45%|██████████████████▌                      | 227/500 [00:50<01:02,  4.37it/s]



 46%|██████████████████▋                      | 228/500 [00:50<01:03,  4.29it/s]



 46%|██████████████████▊                      | 229/500 [00:51<01:04,  4.20it/s]



 46%|██████████████████▊                      | 230/500 [00:51<01:04,  4.21it/s]



 46%|██████████████████▉                      | 231/500 [00:51<01:03,  4.24it/s]



 46%|███████████████████                      | 232/500 [00:51<01:02,  4.28it/s]



 47%|███████████████████                      | 233/500 [00:51<01:02,  4.30it/s]



 47%|███████████████████▏                     | 234/500 [00:52<01:01,  4.31it/s]



 47%|███████████████████▎                     | 235/500 [00:52<01:02,  4.22it/s]



 47%|███████████████████▎                     | 236/500 [00:52<01:02,  4.22it/s]



 47%|███████████████████▍                     | 237/500 [00:52<01:01,  4.26it/s]



 48%|███████████████████▌                     | 238/500 [00:53<01:00,  4.32it/s]



 48%|███████████████████▌                     | 239/500 [00:53<01:00,  4.34it/s]



 48%|███████████████████▋                     | 240/500 [00:53<00:59,  4.40it/s]



 48%|███████████████████▊                     | 241/500 [00:53<00:58,  4.45it/s]



 48%|███████████████████▊                     | 242/500 [00:53<00:57,  4.48it/s]



 49%|███████████████████▉                     | 243/500 [00:54<00:56,  4.52it/s]



 49%|████████████████████                     | 244/500 [00:54<00:56,  4.53it/s]



 49%|████████████████████                     | 245/500 [00:54<00:56,  4.55it/s]



 49%|████████████████████▏                    | 246/500 [00:54<00:55,  4.56it/s]



 49%|████████████████████▎                    | 247/500 [00:55<00:55,  4.58it/s]



 50%|████████████████████▎                    | 248/500 [00:55<00:55,  4.57it/s]



 50%|████████████████████▍                    | 249/500 [00:55<00:55,  4.49it/s]



 50%|████████████████████▌                    | 250/500 [00:55<00:56,  4.43it/s]



 50%|████████████████████▌                    | 251/500 [00:55<00:56,  4.41it/s]



 50%|████████████████████▋                    | 252/500 [00:56<00:56,  4.35it/s]



 51%|████████████████████▋                    | 253/500 [00:56<00:57,  4.32it/s]



 51%|████████████████████▊                    | 254/500 [00:56<00:56,  4.34it/s]



 51%|████████████████████▉                    | 255/500 [00:56<00:56,  4.32it/s]



 51%|████████████████████▉                    | 256/500 [00:57<00:55,  4.36it/s]



 51%|█████████████████████                    | 257/500 [00:57<00:56,  4.34it/s]



 52%|█████████████████████▏                   | 258/500 [00:57<00:55,  4.39it/s]



 52%|█████████████████████▏                   | 259/500 [00:57<00:54,  4.41it/s]



 52%|█████████████████████▎                   | 260/500 [00:58<00:53,  4.47it/s]



 52%|█████████████████████▍                   | 261/500 [00:58<00:53,  4.51it/s]



 52%|█████████████████████▍                   | 262/500 [00:58<00:52,  4.53it/s]



 53%|█████████████████████▌                   | 263/500 [00:58<00:52,  4.54it/s]



 53%|█████████████████████▋                   | 264/500 [00:58<00:51,  4.54it/s]



 53%|█████████████████████▋                   | 265/500 [00:59<00:51,  4.54it/s]



 53%|█████████████████████▊                   | 266/500 [00:59<00:51,  4.55it/s]



 53%|█████████████████████▉                   | 267/500 [00:59<00:51,  4.55it/s]



 54%|█████████████████████▉                   | 268/500 [00:59<00:50,  4.55it/s]



 54%|██████████████████████                   | 269/500 [01:00<00:51,  4.53it/s]



 54%|██████████████████████▏                  | 270/500 [01:00<00:50,  4.56it/s]



 54%|██████████████████████▏                  | 271/500 [01:00<00:50,  4.52it/s]



 54%|██████████████████████▎                  | 272/500 [01:00<00:50,  4.49it/s]



 55%|██████████████████████▍                  | 273/500 [01:00<00:50,  4.46it/s]



 55%|██████████████████████▍                  | 274/500 [01:01<00:50,  4.47it/s]



 55%|██████████████████████▌                  | 275/500 [01:01<00:50,  4.48it/s]



 55%|██████████████████████▋                  | 276/500 [01:01<00:50,  4.47it/s]



 55%|██████████████████████▋                  | 277/500 [01:01<00:49,  4.49it/s]



 56%|██████████████████████▊                  | 278/500 [01:02<00:49,  4.52it/s]



 56%|██████████████████████▉                  | 279/500 [01:02<00:48,  4.55it/s]



 56%|██████████████████████▉                  | 280/500 [01:02<00:48,  4.55it/s]



 56%|███████████████████████                  | 281/500 [01:02<00:48,  4.56it/s]



 56%|███████████████████████                  | 282/500 [01:02<00:47,  4.55it/s]



 57%|███████████████████████▏                 | 283/500 [01:03<00:48,  4.45it/s]



 57%|███████████████████████▎                 | 284/500 [01:03<00:48,  4.41it/s]



 57%|███████████████████████▎                 | 285/500 [01:03<00:48,  4.41it/s]



 57%|███████████████████████▍                 | 286/500 [01:03<00:47,  4.46it/s]



 57%|███████████████████████▌                 | 287/500 [01:04<00:47,  4.51it/s]



 58%|███████████████████████▌                 | 288/500 [01:04<00:46,  4.53it/s]



 58%|███████████████████████▋                 | 289/500 [01:04<00:46,  4.53it/s]



 58%|███████████████████████▊                 | 290/500 [01:04<00:46,  4.52it/s]



 58%|███████████████████████▊                 | 291/500 [01:04<00:46,  4.54it/s]



 58%|███████████████████████▉                 | 292/500 [01:05<00:45,  4.54it/s]



 59%|████████████████████████                 | 293/500 [01:05<00:45,  4.58it/s]



 59%|████████████████████████                 | 294/500 [01:05<00:44,  4.58it/s]



 59%|████████████████████████▏                | 295/500 [01:05<00:44,  4.60it/s]



 59%|████████████████████████▎                | 296/500 [01:05<00:44,  4.62it/s]



 59%|████████████████████████▎                | 297/500 [01:06<00:43,  4.62it/s]



 60%|████████████████████████▍                | 298/500 [01:06<00:44,  4.58it/s]



 60%|████████████████████████▌                | 299/500 [01:06<00:44,  4.47it/s]



 60%|████████████████████████▌                | 300/500 [01:06<00:44,  4.45it/s]



 60%|████████████████████████▋                | 301/500 [01:07<00:46,  4.32it/s]



 60%|████████████████████████▊                | 302/500 [01:07<00:45,  4.33it/s]



 61%|████████████████████████▊                | 303/500 [01:07<00:44,  4.39it/s]



 61%|████████████████████████▉                | 304/500 [01:07<00:44,  4.41it/s]



 61%|█████████████████████████                | 305/500 [01:08<00:45,  4.32it/s]



 61%|█████████████████████████                | 306/500 [01:08<00:44,  4.32it/s]



 61%|█████████████████████████▏               | 307/500 [01:08<00:43,  4.40it/s]



 62%|█████████████████████████▎               | 308/500 [01:08<00:43,  4.45it/s]



 62%|█████████████████████████▎               | 309/500 [01:08<00:42,  4.52it/s]



 62%|█████████████████████████▍               | 310/500 [01:09<00:41,  4.53it/s]



 62%|█████████████████████████▌               | 311/500 [01:09<00:41,  4.55it/s]



 62%|█████████████████████████▌               | 312/500 [01:09<00:41,  4.55it/s]



 63%|█████████████████████████▋               | 313/500 [01:09<00:41,  4.56it/s]



 63%|█████████████████████████▋               | 314/500 [01:10<00:40,  4.56it/s]



 63%|█████████████████████████▊               | 315/500 [01:10<00:40,  4.54it/s]



 63%|█████████████████████████▉               | 316/500 [01:10<00:40,  4.52it/s]



 63%|█████████████████████████▉               | 317/500 [01:10<00:40,  4.53it/s]



 64%|██████████████████████████               | 318/500 [01:10<00:40,  4.54it/s]



 64%|██████████████████████████▏              | 319/500 [01:11<00:39,  4.57it/s]



 64%|██████████████████████████▏              | 320/500 [01:11<00:39,  4.58it/s]



 64%|██████████████████████████▎              | 321/500 [01:11<00:39,  4.58it/s]



 64%|██████████████████████████▍              | 322/500 [01:11<00:39,  4.53it/s]



 65%|██████████████████████████▍              | 323/500 [01:12<00:39,  4.54it/s]



 65%|██████████████████████████▌              | 324/500 [01:12<00:38,  4.52it/s]



 65%|██████████████████████████▋              | 325/500 [01:12<00:38,  4.51it/s]



 65%|██████████████████████████▋              | 326/500 [01:12<00:38,  4.51it/s]



 65%|██████████████████████████▊              | 327/500 [01:12<00:38,  4.49it/s]



 66%|██████████████████████████▉              | 328/500 [01:13<00:38,  4.49it/s]



 66%|██████████████████████████▉              | 329/500 [01:13<00:37,  4.52it/s]



 66%|███████████████████████████              | 330/500 [01:13<00:38,  4.41it/s]



 66%|███████████████████████████▏             | 331/500 [01:13<00:38,  4.43it/s]



 66%|███████████████████████████▏             | 332/500 [01:14<00:37,  4.49it/s]



 67%|███████████████████████████▎             | 333/500 [01:14<00:36,  4.53it/s]



 67%|███████████████████████████▍             | 334/500 [01:14<00:36,  4.52it/s]



 67%|███████████████████████████▍             | 335/500 [01:14<00:36,  4.53it/s]



 67%|███████████████████████████▌             | 336/500 [01:14<00:36,  4.54it/s]



 67%|███████████████████████████▋             | 337/500 [01:15<00:35,  4.55it/s]



 68%|███████████████████████████▋             | 338/500 [01:15<00:35,  4.56it/s]



 68%|███████████████████████████▊             | 339/500 [01:15<00:35,  4.49it/s]



 68%|███████████████████████████▉             | 340/500 [01:15<00:36,  4.42it/s]



 68%|███████████████████████████▉             | 341/500 [01:16<00:35,  4.43it/s]



 68%|████████████████████████████             | 342/500 [01:16<00:36,  4.33it/s]



 69%|████████████████████████████▏            | 343/500 [01:16<00:35,  4.37it/s]



 69%|████████████████████████████▏            | 344/500 [01:16<00:35,  4.43it/s]



 69%|████████████████████████████▎            | 345/500 [01:16<00:34,  4.49it/s]



 69%|████████████████████████████▎            | 346/500 [01:17<00:34,  4.53it/s]



 69%|████████████████████████████▍            | 347/500 [01:17<00:33,  4.54it/s]



 70%|████████████████████████████▌            | 348/500 [01:17<00:33,  4.55it/s]



 70%|████████████████████████████▌            | 349/500 [01:17<00:33,  4.57it/s]



 70%|████████████████████████████▋            | 350/500 [01:18<00:32,  4.56it/s]



 70%|████████████████████████████▊            | 351/500 [01:18<00:32,  4.53it/s]



 70%|████████████████████████████▊            | 352/500 [01:18<00:33,  4.48it/s]



 71%|████████████████████████████▉            | 353/500 [01:18<00:32,  4.48it/s]



 71%|█████████████████████████████            | 354/500 [01:18<00:32,  4.51it/s]



 71%|█████████████████████████████            | 355/500 [01:19<00:32,  4.46it/s]



 71%|█████████████████████████████▏           | 356/500 [01:19<00:32,  4.45it/s]



 71%|█████████████████████████████▎           | 357/500 [01:19<00:31,  4.49it/s]



 72%|█████████████████████████████▎           | 358/500 [01:19<00:31,  4.50it/s]



 72%|█████████████████████████████▍           | 359/500 [01:20<00:31,  4.53it/s]['metal_nut', 0.9931573802541545, 0.9858836250058807, 0.938088176689218]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 6/10 for pill





| feature extraction | train | pill |:   0%|              | 0/9 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:





| feature extraction | train | pill |:  11%|▋     | 1/9 [00:01<00:08,  1.00s/it]




| feature extraction | train | pill |:  22%|█▎    | 2/9 [00:02<00:07,  1.00s/it]




| feature extraction | train | pill |:  33%|██    | 3/9 [00:03<00:06,  1.01s/it]




| feature extraction | train | pill |:  44%|██▋   | 4/9 [00:04<00:05,  1.02s/it]




| feature extraction | train | pill |:  56%|███▎  | 5/9 [00:05<00:04,  1.01s/it]




| feature extraction | train | pill |:  67%|████  | 6/9 [00:05<00:02,  1.01it/s]




| feature extraction | train | pill |:  78%|████▋ | 7/9 [00:06<00:01,  1.02it/s]




| feature extraction | train | pill |:  89%|█████▎| 8/9 [00:07<00:00,  1.03it/s]




| feature extraction | train | pill |: 100%|██████| 9/9 [00:08<00:00,  1.09it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [27340, 384].
2022-04-22 18:07:40	Train ends, total 106.46s
Saving model...
2022-04-22 18:07:40	Save model in ./output/coreset_resnet18_10/pill.pdparams
2022-04-22 18:07:40	Starting eval model...





| feature extraction | test | pill |:   0%|             | 0/167 [00:00<?, ?it/s]




| feature extraction | test | pill |:   1%|     | 1/167 [00:00<00:58,  2.82it/s]




| feature extraction | test | pill |:   1%|     | 2/167 [00:00<00:56,  2.92it/s]




| feature extraction | test | pill |:   2%|     | 3/167 [00:00<00:54,  2.99it/s]




| feature extraction | test | pill |:   2%|     | 4/167 [00:01<00:53,  3.05it/s]




| feature extraction | test | pill |:   3%|▏    | 5/167 [00:01<00:52,  3.08it/s]




| feature extraction | test | pill |:   4%|▏    | 6/167 [00:01<00:51,  3.11it/s]




| feature extraction | test | pill |:   4%|▏    | 7/167 [00:02<00:51,  3.13it/s]




| feature extraction | test | pill |:   5%|▏    | 8/167 [00:02<00:50,  3.15it/s]




| feature extraction | test | pill |:   5%|▎    | 9/167 [00:02<00:50,  3.16it/s]




| feature extraction | test | pill |:   6%|▏   | 10/167 [00:03<00:49,  3.17it/s]




| feature extraction | test | pill |:   7%|▎   | 11/167 [00:03<00:49,  3.17it/s]




| feature extraction | test | pill |:   7%|▎   | 12/167 [00:03<00:48,  3.18it/s]




| feature extraction | test | pill |:   8%|▎   | 13/167 [00:04<00:48,  3.18it/s]




| feature extraction | test | pill |:   8%|▎   | 14/167 [00:04<00:48,  3.18it/s]




| feature extraction | test | pill |:   9%|▎   | 15/167 [00:04<00:47,  3.18it/s]




| feature extraction | test | pill |:  10%|▍   | 16/167 [00:05<00:47,  3.19it/s]




| feature extraction | test | pill |:  10%|▍   | 17/167 [00:05<00:47,  3.18it/s]




| feature extraction | test | pill |:  11%|▍   | 18/167 [00:05<00:46,  3.18it/s]




| feature extraction | test | pill |:  11%|▍   | 19/167 [00:06<00:46,  3.18it/s]




| feature extraction | test | pill |:  12%|▍   | 20/167 [00:06<00:46,  3.18it/s]




| feature extraction | test | pill |:  13%|▌   | 21/167 [00:06<00:45,  3.18it/s]




| feature extraction | test | pill |:  13%|▌   | 22/167 [00:06<00:45,  3.17it/s]




| feature extraction | test | pill |:  14%|▌   | 23/167 [00:07<00:45,  3.17it/s]




| feature extraction | test | pill |:  14%|▌   | 24/167 [00:07<00:46,  3.10it/s]




| feature extraction | test | pill |:  15%|▌   | 25/167 [00:07<00:45,  3.13it/s]




| feature extraction | test | pill |:  16%|▌   | 26/167 [00:08<00:44,  3.14it/s]




| feature extraction | test | pill |:  16%|▋   | 27/167 [00:08<00:44,  3.15it/s]




| feature extraction | test | pill |:  17%|▋   | 28/167 [00:08<00:44,  3.12it/s]




| feature extraction | test | pill |:  17%|▋   | 29/167 [00:09<00:44,  3.13it/s]




| feature extraction | test | pill |:  18%|▋   | 30/167 [00:09<00:43,  3.14it/s]




| feature extraction | test | pill |:  19%|▋   | 31/167 [00:09<00:43,  3.15it/s]




| feature extraction | test | pill |:  19%|▊   | 32/167 [00:10<00:42,  3.16it/s]




| feature extraction | test | pill |:  20%|▊   | 33/167 [00:10<00:42,  3.17it/s]




| feature extraction | test | pill |:  20%|▊   | 34/167 [00:10<00:41,  3.18it/s]




| feature extraction | test | pill |:  21%|▊   | 35/167 [00:11<00:41,  3.18it/s]




| feature extraction | test | pill |:  22%|▊   | 36/167 [00:11<00:41,  3.18it/s]




| feature extraction | test | pill |:  22%|▉   | 37/167 [00:11<00:40,  3.18it/s]




| feature extraction | test | pill |:  23%|▉   | 38/167 [00:12<00:40,  3.19it/s]




| feature extraction | test | pill |:  23%|▉   | 39/167 [00:12<00:40,  3.18it/s]




| feature extraction | test | pill |:  24%|▉   | 40/167 [00:12<00:39,  3.19it/s]




| feature extraction | test | pill |:  25%|▉   | 41/167 [00:12<00:39,  3.18it/s]




| feature extraction | test | pill |:  25%|█   | 42/167 [00:13<00:39,  3.19it/s]




| feature extraction | test | pill |:  26%|█   | 43/167 [00:13<00:38,  3.18it/s]




| feature extraction | test | pill |:  26%|█   | 44/167 [00:13<00:38,  3.19it/s]




| feature extraction | test | pill |:  27%|█   | 45/167 [00:14<00:38,  3.19it/s]




| feature extraction | test | pill |:  28%|█   | 46/167 [00:14<00:37,  3.19it/s]




| feature extraction | test | pill |:  28%|█▏  | 47/167 [00:14<00:37,  3.19it/s]




| feature extraction | test | pill |:  29%|█▏  | 48/167 [00:15<00:37,  3.19it/s]




| feature extraction | test | pill |:  29%|█▏  | 49/167 [00:15<00:37,  3.18it/s]




| feature extraction | test | pill |:  30%|█▏  | 50/167 [00:15<00:36,  3.18it/s]




| feature extraction | test | pill |:  31%|█▏  | 51/167 [00:16<00:36,  3.18it/s]




| feature extraction | test | pill |:  31%|█▏  | 52/167 [00:16<00:36,  3.18it/s]




| feature extraction | test | pill |:  32%|█▎  | 53/167 [00:16<00:35,  3.18it/s]




| feature extraction | test | pill |:  32%|█▎  | 54/167 [00:17<00:35,  3.19it/s]




| feature extraction | test | pill |:  33%|█▎  | 55/167 [00:17<00:35,  3.18it/s]




| feature extraction | test | pill |:  34%|█▎  | 56/167 [00:17<00:34,  3.19it/s]




| feature extraction | test | pill |:  34%|█▎  | 57/167 [00:17<00:34,  3.19it/s]




| feature extraction | test | pill |:  35%|█▍  | 58/167 [00:18<00:34,  3.19it/s]




| feature extraction | test | pill |:  35%|█▍  | 59/167 [00:18<00:33,  3.19it/s]




| feature extraction | test | pill |:  36%|█▍  | 60/167 [00:18<00:33,  3.19it/s]




| feature extraction | test | pill |:  37%|█▍  | 61/167 [00:19<00:33,  3.19it/s]




| feature extraction | test | pill |:  37%|█▍  | 62/167 [00:19<00:32,  3.19it/s]




| feature extraction | test | pill |:  38%|█▌  | 63/167 [00:19<00:32,  3.18it/s]




| feature extraction | test | pill |:  38%|█▌  | 64/167 [00:20<00:32,  3.19it/s]




| feature extraction | test | pill |:  39%|█▌  | 65/167 [00:20<00:32,  3.19it/s]




| feature extraction | test | pill |:  40%|█▌  | 66/167 [00:20<00:31,  3.19it/s]




| feature extraction | test | pill |:  40%|█▌  | 67/167 [00:21<00:31,  3.19it/s]




| feature extraction | test | pill |:  41%|█▋  | 68/167 [00:21<00:31,  3.19it/s]




| feature extraction | test | pill |:  41%|█▋  | 69/167 [00:21<00:30,  3.19it/s]




| feature extraction | test | pill |:  42%|█▋  | 70/167 [00:22<00:30,  3.19it/s]




| feature extraction | test | pill |:  43%|█▋  | 71/167 [00:22<00:30,  3.14it/s]




| feature extraction | test | pill |:  43%|█▋  | 72/167 [00:22<00:30,  3.15it/s]




| feature extraction | test | pill |:  44%|█▋  | 73/167 [00:23<00:29,  3.16it/s]




| feature extraction | test | pill |:  44%|█▊  | 74/167 [00:23<00:29,  3.17it/s]




| feature extraction | test | pill |:  45%|█▊  | 75/167 [00:23<00:29,  3.17it/s]




| feature extraction | test | pill |:  46%|█▊  | 76/167 [00:23<00:28,  3.18it/s]




| feature extraction | test | pill |:  46%|█▊  | 77/167 [00:24<00:28,  3.18it/s]




| feature extraction | test | pill |:  47%|█▊  | 78/167 [00:24<00:27,  3.18it/s]




| feature extraction | test | pill |:  47%|█▉  | 79/167 [00:24<00:27,  3.18it/s]




| feature extraction | test | pill |:  48%|█▉  | 80/167 [00:25<00:27,  3.19it/s]




| feature extraction | test | pill |:  49%|█▉  | 81/167 [00:25<00:27,  3.18it/s]




| feature extraction | test | pill |:  49%|█▉  | 82/167 [00:25<00:26,  3.18it/s]




| feature extraction | test | pill |:  50%|█▉  | 83/167 [00:26<00:26,  3.18it/s]




| feature extraction | test | pill |:  50%|██  | 84/167 [00:26<00:26,  3.19it/s]




| feature extraction | test | pill |:  51%|██  | 85/167 [00:26<00:25,  3.19it/s]




| feature extraction | test | pill |:  51%|██  | 86/167 [00:27<00:25,  3.19it/s]




| feature extraction | test | pill |:  52%|██  | 87/167 [00:27<00:25,  3.19it/s]




| feature extraction | test | pill |:  53%|██  | 88/167 [00:27<00:24,  3.19it/s]




| feature extraction | test | pill |:  53%|██▏ | 89/167 [00:28<00:24,  3.18it/s]




| feature extraction | test | pill |:  54%|██▏ | 90/167 [00:28<00:24,  3.18it/s]




| feature extraction | test | pill |:  54%|██▏ | 91/167 [00:28<00:23,  3.18it/s]




| feature extraction | test | pill |:  55%|██▏ | 92/167 [00:28<00:23,  3.18it/s]




| feature extraction | test | pill |:  56%|██▏ | 93/167 [00:29<00:23,  3.18it/s]




| feature extraction | test | pill |:  56%|██▎ | 94/167 [00:29<00:22,  3.19it/s]




| feature extraction | test | pill |:  57%|██▎ | 95/167 [00:29<00:22,  3.18it/s]




| feature extraction | test | pill |:  57%|██▎ | 96/167 [00:30<00:22,  3.19it/s]




| feature extraction | test | pill |:  58%|██▎ | 97/167 [00:30<00:21,  3.18it/s]




| feature extraction | test | pill |:  59%|██▎ | 98/167 [00:30<00:21,  3.18it/s]




| feature extraction | test | pill |:  59%|██▎ | 99/167 [00:31<00:21,  3.18it/s]




| feature extraction | test | pill |:  60%|█▊ | 100/167 [00:31<00:21,  3.18it/s]




| feature extraction | test | pill |:  60%|█▊ | 101/167 [00:31<00:20,  3.18it/s]




| feature extraction | test | pill |:  61%|█▊ | 102/167 [00:32<00:20,  3.18it/s]




| feature extraction | test | pill |:  62%|█▊ | 103/167 [00:32<00:20,  3.18it/s]




| feature extraction | test | pill |:  62%|█▊ | 104/167 [00:32<00:19,  3.18it/s]




| feature extraction | test | pill |:  63%|█▉ | 105/167 [00:33<00:19,  3.18it/s]




| feature extraction | test | pill |:  63%|█▉ | 106/167 [00:33<00:19,  3.18it/s]




| feature extraction | test | pill |:  64%|█▉ | 107/167 [00:33<00:18,  3.19it/s]




| feature extraction | test | pill |:  65%|█▉ | 108/167 [00:34<00:18,  3.19it/s]




| feature extraction | test | pill |:  65%|█▉ | 109/167 [00:34<00:18,  3.19it/s]




| feature extraction | test | pill |:  66%|█▉ | 110/167 [00:34<00:17,  3.19it/s]




| feature extraction | test | pill |:  66%|█▉ | 111/167 [00:34<00:17,  3.19it/s]




| feature extraction | test | pill |:  67%|██ | 112/167 [00:35<00:17,  3.19it/s]




| feature extraction | test | pill |:  68%|██ | 113/167 [00:35<00:16,  3.19it/s]




| feature extraction | test | pill |:  68%|██ | 114/167 [00:35<00:16,  3.19it/s]




| feature extraction | test | pill |:  69%|██ | 115/167 [00:36<00:16,  3.19it/s]




| feature extraction | test | pill |:  69%|██ | 116/167 [00:36<00:15,  3.19it/s]




| feature extraction | test | pill |:  70%|██ | 117/167 [00:36<00:15,  3.19it/s]




| feature extraction | test | pill |:  71%|██ | 118/167 [00:37<00:15,  3.19it/s]




| feature extraction | test | pill |:  71%|██▏| 119/167 [00:37<00:15,  3.19it/s]




| feature extraction | test | pill |:  72%|██▏| 120/167 [00:37<00:14,  3.18it/s]




| feature extraction | test | pill |:  72%|██▏| 121/167 [00:38<00:14,  3.19it/s]




| feature extraction | test | pill |:  73%|██▏| 122/167 [00:38<00:14,  3.19it/s]




| feature extraction | test | pill |:  74%|██▏| 123/167 [00:38<00:13,  3.19it/s]




| feature extraction | test | pill |:  74%|██▏| 124/167 [00:39<00:13,  3.19it/s]




| feature extraction | test | pill |:  75%|██▏| 125/167 [00:39<00:13,  3.19it/s]




| feature extraction | test | pill |:  75%|██▎| 126/167 [00:39<00:12,  3.19it/s]




| feature extraction | test | pill |:  76%|██▎| 127/167 [00:39<00:12,  3.19it/s]




| feature extraction | test | pill |:  77%|██▎| 128/167 [00:40<00:12,  3.19it/s]




| feature extraction | test | pill |:  77%|██▎| 129/167 [00:40<00:11,  3.19it/s]




| feature extraction | test | pill |:  78%|██▎| 130/167 [00:40<00:11,  3.19it/s]




| feature extraction | test | pill |:  78%|██▎| 131/167 [00:41<00:11,  3.19it/s]




| feature extraction | test | pill |:  79%|██▎| 132/167 [00:41<00:10,  3.19it/s]




| feature extraction | test | pill |:  80%|██▍| 133/167 [00:41<00:10,  3.18it/s]




| feature extraction | test | pill |:  80%|██▍| 134/167 [00:42<00:10,  3.18it/s]




| feature extraction | test | pill |:  81%|██▍| 135/167 [00:42<00:10,  3.18it/s]




| feature extraction | test | pill |:  81%|██▍| 136/167 [00:42<00:09,  3.18it/s]




| feature extraction | test | pill |:  82%|██▍| 137/167 [00:43<00:09,  3.18it/s]




| feature extraction | test | pill |:  83%|██▍| 138/167 [00:43<00:09,  3.18it/s]




| feature extraction | test | pill |:  83%|██▍| 139/167 [00:43<00:08,  3.17it/s]




| feature extraction | test | pill |:  84%|██▌| 140/167 [00:44<00:08,  3.11it/s]




| feature extraction | test | pill |:  84%|██▌| 141/167 [00:44<00:08,  3.13it/s]




| feature extraction | test | pill |:  85%|██▌| 142/167 [00:44<00:07,  3.15it/s]




| feature extraction | test | pill |:  86%|██▌| 143/167 [00:45<00:07,  3.15it/s]




| feature extraction | test | pill |:  86%|██▌| 144/167 [00:45<00:07,  3.16it/s]




| feature extraction | test | pill |:  87%|██▌| 145/167 [00:45<00:06,  3.17it/s]




| feature extraction | test | pill |:  87%|██▌| 146/167 [00:45<00:06,  3.17it/s]




| feature extraction | test | pill |:  88%|██▋| 147/167 [00:46<00:06,  3.17it/s]




| feature extraction | test | pill |:  89%|██▋| 148/167 [00:46<00:05,  3.18it/s]




| feature extraction | test | pill |:  89%|██▋| 149/167 [00:46<00:05,  3.18it/s]




| feature extraction | test | pill |:  90%|██▋| 150/167 [00:47<00:05,  3.18it/s]




| feature extraction | test | pill |:  90%|██▋| 151/167 [00:47<00:05,  3.18it/s]




| feature extraction | test | pill |:  91%|██▋| 152/167 [00:47<00:04,  3.18it/s]




| feature extraction | test | pill |:  92%|██▋| 153/167 [00:48<00:04,  3.16it/s]




| feature extraction | test | pill |:  92%|██▊| 154/167 [00:48<00:04,  3.17it/s]




| feature extraction | test | pill |:  93%|██▊| 155/167 [00:48<00:03,  3.17it/s]




| feature extraction | test | pill |:  93%|██▊| 156/167 [00:49<00:03,  3.18it/s]




| feature extraction | test | pill |:  94%|██▊| 157/167 [00:49<00:03,  3.17it/s]




| feature extraction | test | pill |:  95%|██▊| 158/167 [00:49<00:02,  3.17it/s]




| feature extraction | test | pill |:  95%|██▊| 159/167 [00:50<00:02,  3.18it/s]




| feature extraction | test | pill |:  96%|██▊| 160/167 [00:50<00:02,  3.18it/s]




| feature extraction | test | pill |:  96%|██▉| 161/167 [00:50<00:01,  3.18it/s]




| feature extraction | test | pill |:  97%|██▉| 162/167 [00:51<00:01,  3.18it/s]




| feature extraction | test | pill |:  98%|██▉| 163/167 [00:51<00:01,  3.18it/s]




| feature extraction | test | pill |:  98%|██▉| 164/167 [00:51<00:00,  3.19it/s]




| feature extraction | test | pill |:  99%|██▉| 165/167 [00:51<00:00,  3.20it/s]




| feature extraction | test | pill |:  99%|██▉| 166/167 [00:52<00:00,  3.20it/s]




| feature extraction | test | pill |: 100%|███| 167/167 [00:52<00:00,  3.18it/s]
max_score:3.1396737098693848 min_score:0.3636907935142517
F1 image:0.9466192170818505 threshold:3.1396737098693848
F1 pixel:0.6862127233336787 threshold:3.1396737098693848





  0%|                                                   | 0/500 [00:00<?, ?it/s]




  0%|                                           | 1/500 [00:00<02:08,  3.88it/s]




  0%|▏                                          | 2/500 [00:00<02:08,  3.88it/s]




  1%|▎                                          | 3/500 [00:00<02:08,  3.86it/s]




  1%|▎                                          | 4/500 [00:01<02:09,  3.83it/s]




  1%|▍                                          | 5/500 [00:01<02:09,  3.83it/s]




  1%|▌                                          | 6/500 [00:01<02:08,  3.83it/s]




  1%|▌                                          | 7/500 [00:01<02:08,  3.84it/s]




  2%|▋                                          | 8/500 [00:02<02:08,  3.83it/s]




  2%|▊                                          | 9/500 [00:02<02:08,  3.82it/s]




  2%|▊                                         | 10/500 [00:02<02:08,  3.82it/s]




  2%|▉                                         | 11/500 [00:02<02:09,  3.78it/s]




  2%|█                                         | 12/500 [00:03<02:09,  3.77it/s]




  3%|█                                         | 13/500 [00:03<02:08,  3.78it/s]




  3%|█▏                                        | 14/500 [00:03<02:08,  3.78it/s]




  3%|█▎                                        | 15/500 [00:03<02:08,  3.78it/s]




  3%|█▎                                        | 16/500 [00:04<02:10,  3.70it/s]




  3%|█▍                                        | 17/500 [00:04<02:13,  3.62it/s]




  4%|█▌                                        | 18/500 [00:04<02:13,  3.60it/s]




  4%|█▌                                        | 19/500 [00:05<02:12,  3.64it/s]




  4%|█▋                                        | 20/500 [00:05<02:11,  3.65it/s]




  4%|█▊                                        | 21/500 [00:05<02:09,  3.69it/s]




  4%|█▊                                        | 22/500 [00:05<02:08,  3.73it/s]




  5%|█▉                                        | 23/500 [00:06<02:08,  3.71it/s]




  5%|██                                        | 24/500 [00:06<02:08,  3.71it/s]




  5%|██                                        | 25/500 [00:06<02:06,  3.74it/s]




  5%|██▏                                       | 26/500 [00:06<02:05,  3.77it/s]




  5%|██▎                                       | 27/500 [00:07<02:05,  3.78it/s]




  6%|██▎                                       | 28/500 [00:07<02:04,  3.80it/s]




  6%|██▍                                       | 29/500 [00:07<02:03,  3.82it/s]




  6%|██▌                                       | 30/500 [00:07<02:02,  3.83it/s]




  6%|██▌                                       | 31/500 [00:08<02:02,  3.82it/s]




  6%|██▋                                       | 32/500 [00:08<02:02,  3.81it/s]




  7%|██▊                                       | 33/500 [00:08<02:02,  3.81it/s]




  7%|██▊                                       | 34/500 [00:09<02:02,  3.80it/s]




  7%|██▉                                       | 35/500 [00:09<02:03,  3.77it/s]




  7%|███                                       | 36/500 [00:09<02:02,  3.79it/s]




  7%|███                                       | 37/500 [00:09<02:01,  3.80it/s]




  8%|███▏                                      | 38/500 [00:10<02:01,  3.82it/s]




  8%|███▎                                      | 39/500 [00:10<02:00,  3.81it/s]




  8%|███▎                                      | 40/500 [00:10<02:00,  3.81it/s]




  8%|███▍                                      | 41/500 [00:10<02:01,  3.78it/s]




  8%|███▌                                      | 42/500 [00:11<02:05,  3.65it/s]




  9%|███▌                                      | 43/500 [00:11<02:04,  3.66it/s]




  9%|███▋                                      | 44/500 [00:11<02:03,  3.70it/s]




  9%|███▊                                      | 45/500 [00:12<02:06,  3.58it/s]




  9%|███▊                                      | 46/500 [00:12<02:09,  3.51it/s]




  9%|███▉                                      | 47/500 [00:12<02:11,  3.44it/s]




 10%|████                                      | 48/500 [00:12<02:08,  3.52it/s]




 10%|████                                      | 49/500 [00:13<02:07,  3.54it/s]




 10%|████▏                                     | 50/500 [00:13<02:05,  3.58it/s]




 10%|████▎                                     | 51/500 [00:13<02:02,  3.66it/s]




 10%|████▎                                     | 52/500 [00:13<02:00,  3.71it/s]




 11%|████▍                                     | 53/500 [00:14<02:00,  3.72it/s]




 11%|████▌                                     | 54/500 [00:14<01:58,  3.76it/s]




 11%|████▌                                     | 55/500 [00:14<02:02,  3.64it/s]




 11%|████▋                                     | 56/500 [00:15<02:01,  3.67it/s]




 11%|████▊                                     | 57/500 [00:15<02:01,  3.65it/s]




 12%|████▊                                     | 58/500 [00:15<02:00,  3.68it/s]




 12%|████▉                                     | 59/500 [00:15<01:58,  3.72it/s]




 12%|█████                                     | 60/500 [00:16<01:58,  3.72it/s]




 12%|█████                                     | 61/500 [00:16<01:58,  3.72it/s]




 12%|█████▏                                    | 62/500 [00:16<01:57,  3.74it/s]




 13%|█████▎                                    | 63/500 [00:16<01:56,  3.76it/s]




 13%|█████▍                                    | 64/500 [00:17<01:56,  3.74it/s]




 13%|█████▍                                    | 65/500 [00:17<01:58,  3.67it/s]




 13%|█████▌                                    | 66/500 [00:17<01:56,  3.72it/s]




 13%|█████▋                                    | 67/500 [00:17<01:55,  3.74it/s]




 14%|█████▋                                    | 68/500 [00:18<01:54,  3.77it/s]




 14%|█████▊                                    | 69/500 [00:18<01:54,  3.78it/s]




 14%|█████▉                                    | 70/500 [00:18<01:53,  3.79it/s]




 14%|█████▉                                    | 71/500 [00:19<01:53,  3.76it/s]




 14%|██████                                    | 72/500 [00:19<01:54,  3.74it/s]




 15%|██████▏                                   | 73/500 [00:19<01:55,  3.68it/s]




 15%|██████▏                                   | 74/500 [00:19<01:54,  3.71it/s]




 15%|██████▎                                   | 75/500 [00:20<01:54,  3.71it/s]




 15%|██████▍                                   | 76/500 [00:20<01:54,  3.71it/s]




 15%|██████▍                                   | 77/500 [00:20<01:54,  3.69it/s]




 16%|██████▌                                   | 78/500 [00:20<01:52,  3.75it/s]




 16%|██████▋                                   | 79/500 [00:21<01:51,  3.77it/s]




 16%|██████▋                                   | 80/500 [00:21<01:52,  3.74it/s]




 16%|██████▊                                   | 81/500 [00:21<01:53,  3.70it/s]




 16%|██████▉                                   | 82/500 [00:21<01:51,  3.75it/s]




 17%|██████▉                                   | 83/500 [00:22<01:50,  3.78it/s]




 17%|███████                                   | 84/500 [00:22<01:50,  3.76it/s]




 17%|███████▏                                  | 85/500 [00:22<01:51,  3.71it/s]




 17%|███████▏                                  | 86/500 [00:23<01:51,  3.71it/s]




 17%|███████▎                                  | 87/500 [00:23<01:54,  3.59it/s]




 18%|███████▍                                  | 88/500 [00:23<01:53,  3.62it/s]




 18%|███████▍                                  | 89/500 [00:23<01:52,  3.66it/s]




 18%|███████▌                                  | 90/500 [00:24<01:51,  3.67it/s]




 18%|███████▋                                  | 91/500 [00:24<01:52,  3.62it/s]




 18%|███████▋                                  | 92/500 [00:24<01:51,  3.65it/s]




 19%|███████▊                                  | 93/500 [00:25<01:59,  3.40it/s]




 19%|███████▉                                  | 94/500 [00:25<02:01,  3.35it/s]




 19%|███████▉                                  | 95/500 [00:25<01:58,  3.43it/s]




 19%|████████                                  | 96/500 [00:25<01:54,  3.54it/s]




 19%|████████▏                                 | 97/500 [00:26<01:52,  3.58it/s]




 20%|████████▏                                 | 98/500 [00:26<01:51,  3.60it/s]




 20%|████████▎                                 | 99/500 [00:26<01:49,  3.65it/s]




 20%|████████▏                                | 100/500 [00:26<01:48,  3.69it/s]




 20%|████████▎                                | 101/500 [00:27<01:47,  3.71it/s]




 20%|████████▎                                | 102/500 [00:27<01:46,  3.72it/s]




 21%|████████▍                                | 103/500 [00:27<01:45,  3.76it/s]




 21%|████████▌                                | 104/500 [00:28<01:45,  3.76it/s]




 21%|████████▌                                | 105/500 [00:28<01:45,  3.75it/s]




 21%|████████▋                                | 106/500 [00:28<01:45,  3.75it/s]




 21%|████████▊                                | 107/500 [00:28<01:44,  3.75it/s]




 22%|████████▊                                | 108/500 [00:29<01:44,  3.75it/s]




 22%|████████▉                                | 109/500 [00:29<01:44,  3.74it/s]




 22%|█████████                                | 110/500 [00:29<01:43,  3.75it/s]




 22%|█████████                                | 111/500 [00:29<01:43,  3.75it/s]




 22%|█████████▏                               | 112/500 [00:30<01:43,  3.76it/s]




 23%|█████████▎                               | 113/500 [00:30<01:43,  3.74it/s]




 23%|█████████▎                               | 114/500 [00:30<01:44,  3.71it/s]




 23%|█████████▍                               | 115/500 [00:30<01:43,  3.74it/s]




 23%|█████████▌                               | 116/500 [00:31<01:42,  3.76it/s]




 23%|█████████▌                               | 117/500 [00:31<01:42,  3.74it/s]




 24%|█████████▋                               | 118/500 [00:31<01:43,  3.69it/s]




 24%|█████████▊                               | 119/500 [00:32<01:43,  3.68it/s]




 24%|█████████▊                               | 120/500 [00:32<01:42,  3.72it/s]




 24%|█████████▉                               | 121/500 [00:32<01:42,  3.71it/s]




 24%|██████████                               | 122/500 [00:32<01:44,  3.63it/s]




 25%|██████████                               | 123/500 [00:33<01:42,  3.68it/s]




 25%|██████████▏                              | 124/500 [00:33<01:42,  3.66it/s]




 25%|██████████▎                              | 125/500 [00:33<01:41,  3.71it/s]




 25%|██████████▎                              | 126/500 [00:33<01:39,  3.74it/s]




 25%|██████████▍                              | 127/500 [00:34<01:40,  3.71it/s]




 26%|██████████▍                              | 128/500 [00:34<01:40,  3.70it/s]




 26%|██████████▌                              | 129/500 [00:34<01:40,  3.70it/s]




 26%|██████████▋                              | 130/500 [00:35<01:40,  3.68it/s]




 26%|██████████▋                              | 131/500 [00:35<01:42,  3.61it/s]




 26%|██████████▊                              | 132/500 [00:35<01:41,  3.62it/s]




 27%|██████████▉                              | 133/500 [00:35<01:39,  3.69it/s]




 27%|██████████▉                              | 134/500 [00:36<01:38,  3.73it/s]




 27%|███████████                              | 135/500 [00:36<01:38,  3.70it/s]




 27%|███████████▏                             | 136/500 [00:36<01:37,  3.73it/s]




 27%|███████████▏                             | 137/500 [00:36<01:36,  3.77it/s]




 28%|███████████▎                             | 138/500 [00:37<01:36,  3.77it/s]




 28%|███████████▍                             | 139/500 [00:37<01:36,  3.73it/s]




 28%|███████████▍                             | 140/500 [00:37<01:36,  3.74it/s]




 28%|███████████▌                             | 141/500 [00:38<01:36,  3.73it/s]




 28%|███████████▋                             | 142/500 [00:38<01:39,  3.59it/s]




 29%|███████████▋                             | 143/500 [00:38<01:39,  3.59it/s]




 29%|███████████▊                             | 144/500 [00:38<01:38,  3.61it/s]




 29%|███████████▉                             | 145/500 [00:39<01:37,  3.64it/s]




 29%|███████████▉                             | 146/500 [00:39<01:36,  3.67it/s]




 29%|████████████                             | 147/500 [00:39<01:35,  3.68it/s]




 30%|████████████▏                            | 148/500 [00:39<01:35,  3.70it/s]




 30%|████████████▏                            | 149/500 [00:40<01:34,  3.71it/s]




 30%|████████████▎                            | 150/500 [00:40<01:34,  3.72it/s]




 30%|████████████▍                            | 151/500 [00:40<01:33,  3.73it/s]




 30%|████████████▍                            | 152/500 [00:41<01:33,  3.71it/s]




 31%|████████████▌                            | 153/500 [00:41<01:34,  3.66it/s]




 31%|████████████▋                            | 154/500 [00:41<01:33,  3.69it/s]




 31%|████████████▋                            | 155/500 [00:41<01:33,  3.70it/s]




 31%|████████████▊                            | 156/500 [00:42<01:34,  3.65it/s]




 31%|████████████▊                            | 157/500 [00:42<01:33,  3.67it/s]




 32%|████████████▉                            | 158/500 [00:42<01:33,  3.65it/s]




 32%|█████████████                            | 159/500 [00:42<01:34,  3.62it/s]




 32%|█████████████                            | 160/500 [00:43<01:32,  3.66it/s]




 32%|█████████████▏                           | 161/500 [00:43<01:33,  3.64it/s]




 32%|█████████████▎                           | 162/500 [00:43<01:32,  3.66it/s]




 33%|█████████████▎                           | 163/500 [00:44<01:32,  3.65it/s]




 33%|█████████████▍                           | 164/500 [00:44<01:32,  3.64it/s]




 33%|█████████████▌                           | 165/500 [00:44<01:31,  3.65it/s]




 33%|█████████████▌                           | 166/500 [00:44<01:31,  3.66it/s]




 33%|█████████████▋                           | 167/500 [00:45<01:30,  3.68it/s]




 34%|█████████████▊                           | 168/500 [00:45<01:29,  3.70it/s]




 34%|█████████████▊                           | 169/500 [00:45<01:30,  3.65it/s]




 34%|█████████████▉                           | 170/500 [00:45<01:29,  3.68it/s]




 34%|██████████████                           | 171/500 [00:46<01:29,  3.67it/s]




 34%|██████████████                           | 172/500 [00:46<01:31,  3.59it/s]




 35%|██████████████▏                          | 173/500 [00:46<01:30,  3.60it/s]




 35%|██████████████▎                          | 174/500 [00:47<01:30,  3.61it/s]




 35%|██████████████▎                          | 175/500 [00:47<01:30,  3.61it/s]




 35%|██████████████▍                          | 176/500 [00:47<01:28,  3.65it/s]




 35%|██████████████▌                          | 177/500 [00:47<01:29,  3.62it/s]




 36%|██████████████▌                          | 178/500 [00:48<01:29,  3.60it/s]




 36%|██████████████▋                          | 179/500 [00:48<01:29,  3.57it/s]




 36%|██████████████▊                          | 180/500 [00:48<01:28,  3.60it/s]




 36%|██████████████▊                          | 181/500 [00:49<01:28,  3.59it/s]




 36%|██████████████▉                          | 182/500 [00:49<01:28,  3.59it/s]




 37%|███████████████                          | 183/500 [00:49<01:27,  3.64it/s]['pill', 0.9383524277141297, 0.9759503913797475, 0.9276695867103399]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 7/10 for screw






| feature extraction | train | screw |:   0%|            | 0/10 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:






| feature extraction | train | screw |:  10%|▍   | 1/10 [00:00<00:05,  1.65it/s]





| feature extraction | train | screw |:  20%|▊   | 2/10 [00:01<00:04,  1.65it/s]





| feature extraction | train | screw |:  30%|█▏  | 3/10 [00:01<00:04,  1.64it/s]





| feature extraction | train | screw |:  40%|█▌  | 4/10 [00:02<00:03,  1.64it/s]





| feature extraction | train | screw |:  50%|██  | 5/10 [00:03<00:03,  1.58it/s]





| feature extraction | train | screw |:  60%|██▍ | 6/10 [00:03<00:02,  1.58it/s]





| feature extraction | train | screw |:  70%|██▊ | 7/10 [00:04<00:01,  1.61it/s]





| feature extraction | train | screw |:  80%|███▏| 8/10 [00:04<00:01,  1.61it/s]





| feature extraction | train | screw |:  90%|███▌| 9/10 [00:05<00:00,  1.63it/s]





| feature extraction | train | screw |: 100%|███| 10/10 [00:06<00:00,  1.61it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [32768, 384].
2022-04-22 18:11:48	Train ends, total 137.72s
Saving model...
2022-04-22 18:11:48	Save model in ./output/coreset_resnet18_10/screw.pdparams
2022-04-22 18:11:48	Starting eval model...






| feature extraction | test | screw |:   0%|            | 0/160 [00:00<?, ?it/s]





| feature extraction | test | screw |:   1%|    | 1/160 [00:00<01:02,  2.53it/s]





| feature extraction | test | screw |:   1%|    | 2/160 [00:00<01:01,  2.58it/s]





| feature extraction | test | screw |:   2%|    | 3/160 [00:01<00:59,  2.62it/s]





| feature extraction | test | screw |:   2%|    | 4/160 [00:01<00:58,  2.65it/s]





| feature extraction | test | screw |:   3%|▏   | 5/160 [00:01<00:58,  2.67it/s]





| feature extraction | test | screw |:   4%|▏   | 6/160 [00:02<00:57,  2.68it/s]





| feature extraction | test | screw |:   4%|▏   | 7/160 [00:02<00:56,  2.69it/s]





| feature extraction | test | screw |:   5%|▏   | 8/160 [00:02<00:56,  2.69it/s]





| feature extraction | test | screw |:   6%|▏   | 9/160 [00:03<00:55,  2.70it/s]





| feature extraction | test | screw |:   6%|▏  | 10/160 [00:03<00:55,  2.70it/s]





| feature extraction | test | screw |:   7%|▏  | 11/160 [00:04<00:55,  2.71it/s]





| feature extraction | test | screw |:   8%|▏  | 12/160 [00:04<00:54,  2.71it/s]





| feature extraction | test | screw |:   8%|▏  | 13/160 [00:04<00:54,  2.71it/s]





| feature extraction | test | screw |:   9%|▎  | 14/160 [00:05<00:53,  2.71it/s]





| feature extraction | test | screw |:   9%|▎  | 15/160 [00:05<00:53,  2.71it/s]





| feature extraction | test | screw |:  10%|▎  | 16/160 [00:05<00:53,  2.71it/s]





| feature extraction | test | screw |:  11%|▎  | 17/160 [00:06<00:52,  2.71it/s]





| feature extraction | test | screw |:  11%|▎  | 18/160 [00:06<00:52,  2.71it/s]





| feature extraction | test | screw |:  12%|▎  | 19/160 [00:07<00:52,  2.71it/s]





| feature extraction | test | screw |:  12%|▍  | 20/160 [00:07<00:51,  2.71it/s]





| feature extraction | test | screw |:  13%|▍  | 21/160 [00:07<00:51,  2.71it/s]





| feature extraction | test | screw |:  14%|▍  | 22/160 [00:08<00:50,  2.71it/s]





| feature extraction | test | screw |:  14%|▍  | 23/160 [00:08<00:50,  2.71it/s]





| feature extraction | test | screw |:  15%|▍  | 24/160 [00:08<00:50,  2.71it/s]





| feature extraction | test | screw |:  16%|▍  | 25/160 [00:09<00:49,  2.71it/s]





| feature extraction | test | screw |:  16%|▍  | 26/160 [00:09<00:49,  2.71it/s]





| feature extraction | test | screw |:  17%|▌  | 27/160 [00:09<00:49,  2.71it/s]





| feature extraction | test | screw |:  18%|▌  | 28/160 [00:10<00:48,  2.71it/s]





| feature extraction | test | screw |:  18%|▌  | 29/160 [00:10<00:48,  2.71it/s]





| feature extraction | test | screw |:  19%|▌  | 30/160 [00:11<00:48,  2.71it/s]





| feature extraction | test | screw |:  19%|▌  | 31/160 [00:11<00:47,  2.71it/s]





| feature extraction | test | screw |:  20%|▌  | 32/160 [00:11<00:47,  2.71it/s]





| feature extraction | test | screw |:  21%|▌  | 33/160 [00:12<00:46,  2.70it/s]





| feature extraction | test | screw |:  21%|▋  | 34/160 [00:12<00:46,  2.70it/s]





| feature extraction | test | screw |:  22%|▋  | 35/160 [00:12<00:46,  2.70it/s]





| feature extraction | test | screw |:  22%|▋  | 36/160 [00:13<00:45,  2.70it/s]





| feature extraction | test | screw |:  23%|▋  | 37/160 [00:13<00:45,  2.70it/s]





| feature extraction | test | screw |:  24%|▋  | 38/160 [00:14<00:45,  2.69it/s]





| feature extraction | test | screw |:  24%|▋  | 39/160 [00:14<00:45,  2.69it/s]





| feature extraction | test | screw |:  25%|▊  | 40/160 [00:14<00:45,  2.64it/s]





| feature extraction | test | screw |:  26%|▊  | 41/160 [00:15<00:44,  2.65it/s]





| feature extraction | test | screw |:  26%|▊  | 42/160 [00:15<00:44,  2.66it/s]





| feature extraction | test | screw |:  27%|▊  | 43/160 [00:15<00:43,  2.67it/s]





| feature extraction | test | screw |:  28%|▊  | 44/160 [00:16<00:43,  2.68it/s]





| feature extraction | test | screw |:  28%|▊  | 45/160 [00:16<00:42,  2.68it/s]





| feature extraction | test | screw |:  29%|▊  | 46/160 [00:17<00:42,  2.69it/s]





| feature extraction | test | screw |:  29%|▉  | 47/160 [00:17<00:42,  2.69it/s]





| feature extraction | test | screw |:  30%|▉  | 48/160 [00:17<00:41,  2.69it/s]





| feature extraction | test | screw |:  31%|▉  | 49/160 [00:18<00:41,  2.69it/s]





| feature extraction | test | screw |:  31%|▉  | 50/160 [00:18<00:40,  2.69it/s]





| feature extraction | test | screw |:  32%|▉  | 51/160 [00:18<00:40,  2.69it/s]





| feature extraction | test | screw |:  32%|▉  | 52/160 [00:19<00:40,  2.69it/s]





| feature extraction | test | screw |:  33%|▉  | 53/160 [00:19<00:39,  2.69it/s]





| feature extraction | test | screw |:  34%|█  | 54/160 [00:20<00:39,  2.69it/s]





| feature extraction | test | screw |:  34%|█  | 55/160 [00:20<00:39,  2.69it/s]





| feature extraction | test | screw |:  35%|█  | 56/160 [00:20<00:38,  2.69it/s]





| feature extraction | test | screw |:  36%|█  | 57/160 [00:21<00:38,  2.69it/s]





| feature extraction | test | screw |:  36%|█  | 58/160 [00:21<00:37,  2.69it/s]





| feature extraction | test | screw |:  37%|█  | 59/160 [00:21<00:37,  2.70it/s]





| feature extraction | test | screw |:  38%|█▏ | 60/160 [00:22<00:37,  2.70it/s]





| feature extraction | test | screw |:  38%|█▏ | 61/160 [00:22<00:36,  2.70it/s]





| feature extraction | test | screw |:  39%|█▏ | 62/160 [00:23<00:36,  2.70it/s]





| feature extraction | test | screw |:  39%|█▏ | 63/160 [00:23<00:35,  2.70it/s]





| feature extraction | test | screw |:  40%|█▏ | 64/160 [00:23<00:35,  2.70it/s]





| feature extraction | test | screw |:  41%|█▏ | 65/160 [00:24<00:35,  2.70it/s]





| feature extraction | test | screw |:  41%|█▏ | 66/160 [00:24<00:34,  2.70it/s]





| feature extraction | test | screw |:  42%|█▎ | 67/160 [00:24<00:34,  2.70it/s]





| feature extraction | test | screw |:  42%|█▎ | 68/160 [00:25<00:34,  2.70it/s]





| feature extraction | test | screw |:  43%|█▎ | 69/160 [00:25<00:33,  2.68it/s]





| feature extraction | test | screw |:  44%|█▎ | 70/160 [00:25<00:33,  2.68it/s]





| feature extraction | test | screw |:  44%|█▎ | 71/160 [00:26<00:33,  2.68it/s]





| feature extraction | test | screw |:  45%|█▎ | 72/160 [00:26<00:32,  2.69it/s]





| feature extraction | test | screw |:  46%|█▎ | 73/160 [00:27<00:32,  2.69it/s]





| feature extraction | test | screw |:  46%|█▍ | 74/160 [00:27<00:32,  2.66it/s]





| feature extraction | test | screw |:  47%|█▍ | 75/160 [00:27<00:31,  2.68it/s]





| feature extraction | test | screw |:  48%|█▍ | 76/160 [00:28<00:31,  2.68it/s]





| feature extraction | test | screw |:  48%|█▍ | 77/160 [00:28<00:30,  2.69it/s]





| feature extraction | test | screw |:  49%|█▍ | 78/160 [00:28<00:30,  2.69it/s]





| feature extraction | test | screw |:  49%|█▍ | 79/160 [00:29<00:30,  2.69it/s]





| feature extraction | test | screw |:  50%|█▌ | 80/160 [00:29<00:29,  2.69it/s]





| feature extraction | test | screw |:  51%|█▌ | 81/160 [00:30<00:29,  2.69it/s]





| feature extraction | test | screw |:  51%|█▌ | 82/160 [00:30<00:28,  2.69it/s]





| feature extraction | test | screw |:  52%|█▌ | 83/160 [00:30<00:28,  2.70it/s]





| feature extraction | test | screw |:  52%|█▌ | 84/160 [00:31<00:28,  2.69it/s]





| feature extraction | test | screw |:  53%|█▌ | 85/160 [00:31<00:27,  2.70it/s]





| feature extraction | test | screw |:  54%|█▌ | 86/160 [00:31<00:27,  2.69it/s]





| feature extraction | test | screw |:  54%|█▋ | 87/160 [00:32<00:27,  2.69it/s]





| feature extraction | test | screw |:  55%|█▋ | 88/160 [00:32<00:26,  2.69it/s]





| feature extraction | test | screw |:  56%|█▋ | 89/160 [00:33<00:26,  2.69it/s]





| feature extraction | test | screw |:  56%|█▋ | 90/160 [00:33<00:25,  2.69it/s]





| feature extraction | test | screw |:  57%|█▋ | 91/160 [00:33<00:25,  2.70it/s]





| feature extraction | test | screw |:  57%|█▋ | 92/160 [00:34<00:25,  2.69it/s]





| feature extraction | test | screw |:  58%|█▋ | 93/160 [00:34<00:24,  2.69it/s]





| feature extraction | test | screw |:  59%|█▊ | 94/160 [00:34<00:24,  2.69it/s]





| feature extraction | test | screw |:  59%|█▊ | 95/160 [00:35<00:24,  2.69it/s]





| feature extraction | test | screw |:  60%|█▊ | 96/160 [00:35<00:23,  2.69it/s]





| feature extraction | test | screw |:  61%|█▊ | 97/160 [00:36<00:23,  2.69it/s]





| feature extraction | test | screw |:  61%|█▊ | 98/160 [00:36<00:23,  2.69it/s]





| feature extraction | test | screw |:  62%|█▊ | 99/160 [00:36<00:22,  2.69it/s]





| feature extraction | test | screw |:  62%|█▎| 100/160 [00:37<00:22,  2.69it/s]





| feature extraction | test | screw |:  63%|█▎| 101/160 [00:37<00:21,  2.69it/s]





| feature extraction | test | screw |:  64%|█▎| 102/160 [00:37<00:21,  2.69it/s]





| feature extraction | test | screw |:  64%|█▎| 103/160 [00:38<00:21,  2.69it/s]





| feature extraction | test | screw |:  65%|█▎| 104/160 [00:38<00:20,  2.69it/s]





| feature extraction | test | screw |:  66%|█▎| 105/160 [00:38<00:20,  2.69it/s]





| feature extraction | test | screw |:  66%|█▎| 106/160 [00:39<00:20,  2.69it/s]





| feature extraction | test | screw |:  67%|█▎| 107/160 [00:39<00:19,  2.69it/s]





| feature extraction | test | screw |:  68%|█▎| 108/160 [00:40<00:19,  2.69it/s]





| feature extraction | test | screw |:  68%|█▎| 109/160 [00:40<00:18,  2.69it/s]





| feature extraction | test | screw |:  69%|█▍| 110/160 [00:40<00:18,  2.69it/s]





| feature extraction | test | screw |:  69%|█▍| 111/160 [00:41<00:18,  2.70it/s]





| feature extraction | test | screw |:  70%|█▍| 112/160 [00:41<00:17,  2.70it/s]





| feature extraction | test | screw |:  71%|█▍| 113/160 [00:41<00:17,  2.70it/s]





| feature extraction | test | screw |:  71%|█▍| 114/160 [00:42<00:17,  2.70it/s]





| feature extraction | test | screw |:  72%|█▍| 115/160 [00:42<00:16,  2.69it/s]





| feature extraction | test | screw |:  72%|█▍| 116/160 [00:43<00:16,  2.69it/s]





| feature extraction | test | screw |:  73%|█▍| 117/160 [00:43<00:15,  2.69it/s]





| feature extraction | test | screw |:  74%|█▍| 118/160 [00:43<00:15,  2.69it/s]





| feature extraction | test | screw |:  74%|█▍| 119/160 [00:44<00:15,  2.69it/s]





| feature extraction | test | screw |:  75%|█▌| 120/160 [00:44<00:14,  2.69it/s]





| feature extraction | test | screw |:  76%|█▌| 121/160 [00:44<00:14,  2.69it/s]





| feature extraction | test | screw |:  76%|█▌| 122/160 [00:45<00:14,  2.69it/s]





| feature extraction | test | screw |:  77%|█▌| 123/160 [00:45<00:13,  2.69it/s]





| feature extraction | test | screw |:  78%|█▌| 124/160 [00:46<00:13,  2.69it/s]





| feature extraction | test | screw |:  78%|█▌| 125/160 [00:46<00:13,  2.67it/s]





| feature extraction | test | screw |:  79%|█▌| 126/160 [00:46<00:12,  2.64it/s]





| feature extraction | test | screw |:  79%|█▌| 127/160 [00:47<00:12,  2.66it/s]





| feature extraction | test | screw |:  80%|█▌| 128/160 [00:47<00:11,  2.67it/s]





| feature extraction | test | screw |:  81%|█▌| 129/160 [00:47<00:11,  2.68it/s]





| feature extraction | test | screw |:  81%|█▋| 130/160 [00:48<00:11,  2.69it/s]





| feature extraction | test | screw |:  82%|█▋| 131/160 [00:48<00:10,  2.69it/s]





| feature extraction | test | screw |:  82%|█▋| 132/160 [00:49<00:10,  2.69it/s]





| feature extraction | test | screw |:  83%|█▋| 133/160 [00:49<00:10,  2.69it/s]





| feature extraction | test | screw |:  84%|█▋| 134/160 [00:49<00:09,  2.69it/s]





| feature extraction | test | screw |:  84%|█▋| 135/160 [00:50<00:09,  2.70it/s]





| feature extraction | test | screw |:  85%|█▋| 136/160 [00:50<00:08,  2.70it/s]





| feature extraction | test | screw |:  86%|█▋| 137/160 [00:50<00:08,  2.70it/s]





| feature extraction | test | screw |:  86%|█▋| 138/160 [00:51<00:08,  2.70it/s]





| feature extraction | test | screw |:  87%|█▋| 139/160 [00:51<00:07,  2.70it/s]





| feature extraction | test | screw |:  88%|█▊| 140/160 [00:52<00:07,  2.70it/s]





| feature extraction | test | screw |:  88%|█▊| 141/160 [00:52<00:07,  2.70it/s]





| feature extraction | test | screw |:  89%|█▊| 142/160 [00:52<00:06,  2.70it/s]





| feature extraction | test | screw |:  89%|█▊| 143/160 [00:53<00:06,  2.70it/s]





| feature extraction | test | screw |:  90%|█▊| 144/160 [00:53<00:05,  2.70it/s]





| feature extraction | test | screw |:  91%|█▊| 145/160 [00:53<00:05,  2.71it/s]





| feature extraction | test | screw |:  91%|█▊| 146/160 [00:54<00:05,  2.70it/s]





| feature extraction | test | screw |:  92%|█▊| 147/160 [00:54<00:04,  2.71it/s]





| feature extraction | test | screw |:  92%|█▊| 148/160 [00:54<00:04,  2.70it/s]





| feature extraction | test | screw |:  93%|█▊| 149/160 [00:55<00:04,  2.70it/s]





| feature extraction | test | screw |:  94%|█▉| 150/160 [00:55<00:03,  2.70it/s]





| feature extraction | test | screw |:  94%|█▉| 151/160 [00:56<00:03,  2.70it/s]





| feature extraction | test | screw |:  95%|█▉| 152/160 [00:56<00:02,  2.70it/s]





| feature extraction | test | screw |:  96%|█▉| 153/160 [00:56<00:02,  2.69it/s]





| feature extraction | test | screw |:  96%|█▉| 154/160 [00:57<00:02,  2.69it/s]





| feature extraction | test | screw |:  97%|█▉| 155/160 [00:57<00:01,  2.69it/s]





| feature extraction | test | screw |:  98%|█▉| 156/160 [00:57<00:01,  2.69it/s]





| feature extraction | test | screw |:  98%|█▉| 157/160 [00:58<00:01,  2.69it/s]





| feature extraction | test | screw |:  99%|█▉| 158/160 [00:58<00:00,  2.70it/s]





| feature extraction | test | screw |:  99%|█▉| 159/160 [00:59<00:00,  2.70it/s]





| feature extraction | test | screw |: 100%|██| 160/160 [00:59<00:00,  2.69it/s]
max_score:2.510528564453125 min_score:0.3908054530620575
F1 image:0.9328063241106719 threshold:2.510528564453125
F1 pixel:0.36326570712776934 threshold:2.510528564453125






  0%|                                                   | 0/500 [00:00<?, ?it/s]





  0%|                                           | 1/500 [00:00<01:53,  4.42it/s]





  0%|▏                                          | 2/500 [00:00<01:52,  4.43it/s]





  1%|▎                                          | 3/500 [00:00<01:51,  4.44it/s]





  1%|▎                                          | 4/500 [00:00<01:51,  4.45it/s]





  1%|▍                                          | 5/500 [00:01<01:53,  4.37it/s]





  1%|▌                                          | 6/500 [00:01<01:53,  4.37it/s]





  1%|▌                                          | 7/500 [00:01<01:54,  4.32it/s]





  2%|▋                                          | 8/500 [00:01<01:53,  4.33it/s]





  2%|▊                                          | 9/500 [00:02<01:51,  4.39it/s]





  2%|▊                                         | 10/500 [00:02<01:50,  4.42it/s]





  2%|▉                                         | 11/500 [00:02<01:50,  4.44it/s]





  2%|█                                         | 12/500 [00:02<01:49,  4.45it/s]





  3%|█                                         | 13/500 [00:02<01:48,  4.47it/s]





  3%|█▏                                        | 14/500 [00:03<01:48,  4.48it/s]





  3%|█▎                                        | 15/500 [00:03<01:47,  4.49it/s]





  3%|█▎                                        | 16/500 [00:03<01:47,  4.49it/s]





  3%|█▍                                        | 17/500 [00:03<01:47,  4.50it/s]





  4%|█▌                                        | 18/500 [00:04<01:47,  4.50it/s]





  4%|█▌                                        | 19/500 [00:04<01:46,  4.50it/s]





  4%|█▋                                        | 20/500 [00:04<01:46,  4.50it/s]





  4%|█▊                                        | 21/500 [00:04<01:46,  4.50it/s]





  4%|█▊                                        | 22/500 [00:04<01:46,  4.49it/s]





  5%|█▉                                        | 23/500 [00:05<01:46,  4.48it/s]





  5%|██                                        | 24/500 [00:05<01:46,  4.47it/s]





  5%|██                                        | 25/500 [00:05<01:46,  4.47it/s]





  5%|██▏                                       | 26/500 [00:05<01:46,  4.46it/s]





  5%|██▎                                       | 27/500 [00:06<01:45,  4.47it/s]





  6%|██▎                                       | 28/500 [00:06<01:45,  4.46it/s]





  6%|██▍                                       | 29/500 [00:06<01:45,  4.47it/s]





  6%|██▌                                       | 30/500 [00:06<01:45,  4.47it/s]





  6%|██▌                                       | 31/500 [00:06<01:44,  4.48it/s]





  6%|██▋                                       | 32/500 [00:07<01:44,  4.48it/s]





  7%|██▊                                       | 33/500 [00:07<01:44,  4.48it/s]





  7%|██▊                                       | 34/500 [00:07<01:43,  4.48it/s]





  7%|██▉                                       | 35/500 [00:07<01:43,  4.49it/s]





  7%|███                                       | 36/500 [00:08<01:43,  4.49it/s]





  7%|███                                       | 37/500 [00:08<01:42,  4.50it/s]





  8%|███▏                                      | 38/500 [00:08<01:42,  4.49it/s]





  8%|███▎                                      | 39/500 [00:08<01:43,  4.47it/s]





  8%|███▎                                      | 40/500 [00:08<01:43,  4.46it/s]





  8%|███▍                                      | 41/500 [00:09<01:43,  4.45it/s]





  8%|███▌                                      | 42/500 [00:09<01:43,  4.44it/s]





  9%|███▌                                      | 43/500 [00:09<01:42,  4.45it/s]





  9%|███▋                                      | 44/500 [00:09<01:42,  4.45it/s]





  9%|███▊                                      | 45/500 [00:10<01:42,  4.45it/s]





  9%|███▊                                      | 46/500 [00:10<01:42,  4.45it/s]





  9%|███▉                                      | 47/500 [00:10<01:42,  4.44it/s]





 10%|████                                      | 48/500 [00:10<01:41,  4.43it/s]





 10%|████                                      | 49/500 [00:10<01:41,  4.43it/s]





 10%|████▏                                     | 50/500 [00:11<01:41,  4.42it/s]





 10%|████▎                                     | 51/500 [00:11<01:41,  4.42it/s]





 10%|████▎                                     | 52/500 [00:11<01:43,  4.32it/s]





 11%|████▍                                     | 53/500 [00:11<01:44,  4.27it/s]





 11%|████▌                                     | 54/500 [00:12<01:44,  4.27it/s]





 11%|████▌                                     | 55/500 [00:12<01:43,  4.31it/s]





 11%|████▋                                     | 56/500 [00:12<01:42,  4.34it/s]





 11%|████▊                                     | 57/500 [00:12<01:44,  4.24it/s]





 12%|████▊                                     | 58/500 [00:13<01:44,  4.23it/s]





 12%|████▉                                     | 59/500 [00:13<01:43,  4.27it/s]





 12%|█████                                     | 60/500 [00:13<01:41,  4.32it/s]





 12%|█████                                     | 61/500 [00:13<01:40,  4.35it/s]





 12%|█████▏                                    | 62/500 [00:14<01:39,  4.38it/s]





 13%|█████▎                                    | 63/500 [00:14<01:39,  4.39it/s]





 13%|█████▍                                    | 64/500 [00:14<01:38,  4.41it/s]





 13%|█████▍                                    | 65/500 [00:14<01:38,  4.40it/s]





 13%|█████▌                                    | 66/500 [00:14<01:38,  4.42it/s]





 13%|█████▋                                    | 67/500 [00:15<01:38,  4.41it/s]





 14%|█████▋                                    | 68/500 [00:15<01:37,  4.42it/s]





 14%|█████▊                                    | 69/500 [00:15<01:37,  4.40it/s]





 14%|█████▉                                    | 70/500 [00:15<01:37,  4.42it/s]





 14%|█████▉                                    | 71/500 [00:16<01:36,  4.42it/s]





 14%|██████                                    | 72/500 [00:16<01:36,  4.44it/s]





 15%|██████▏                                   | 73/500 [00:16<01:36,  4.43it/s]





 15%|██████▏                                   | 74/500 [00:16<01:35,  4.44it/s]





 15%|██████▎                                   | 75/500 [00:16<01:35,  4.44it/s]





 15%|██████▍                                   | 76/500 [00:17<01:35,  4.45it/s]





 15%|██████▍                                   | 77/500 [00:17<01:35,  4.45it/s]





 16%|██████▌                                   | 78/500 [00:17<01:34,  4.45it/s]





 16%|██████▋                                   | 79/500 [00:17<01:34,  4.45it/s]





 16%|██████▋                                   | 80/500 [00:18<01:34,  4.45it/s]





 16%|██████▊                                   | 81/500 [00:18<01:34,  4.45it/s]





 16%|██████▉                                   | 82/500 [00:18<01:34,  4.45it/s]





 17%|██████▉                                   | 83/500 [00:18<01:34,  4.43it/s]





 17%|███████                                   | 84/500 [00:18<01:33,  4.44it/s]





 17%|███████▏                                  | 85/500 [00:19<01:33,  4.43it/s]





 17%|███████▏                                  | 86/500 [00:19<01:33,  4.44it/s]





 17%|███████▎                                  | 87/500 [00:19<01:33,  4.43it/s]





 18%|███████▍                                  | 88/500 [00:19<01:32,  4.44it/s]





 18%|███████▍                                  | 89/500 [00:20<01:32,  4.43it/s]





 18%|███████▌                                  | 90/500 [00:20<01:32,  4.44it/s]





 18%|███████▋                                  | 91/500 [00:20<01:32,  4.43it/s]





 18%|███████▋                                  | 92/500 [00:20<01:32,  4.43it/s]





 19%|███████▊                                  | 93/500 [00:21<01:31,  4.43it/s]





 19%|███████▉                                  | 94/500 [00:21<01:31,  4.43it/s]





 19%|███████▉                                  | 95/500 [00:21<01:31,  4.42it/s]





 19%|████████                                  | 96/500 [00:21<01:31,  4.42it/s]





 19%|████████▏                                 | 97/500 [00:21<01:30,  4.43it/s]





 20%|████████▏                                 | 98/500 [00:22<01:32,  4.36it/s]





 20%|████████▎                                 | 99/500 [00:22<01:32,  4.33it/s]





 20%|████████▏                                | 100/500 [00:22<01:33,  4.27it/s]





 20%|████████▎                                | 101/500 [00:22<01:32,  4.29it/s]





 20%|████████▎                                | 102/500 [00:23<01:31,  4.35it/s]





 21%|████████▍                                | 103/500 [00:23<01:30,  4.37it/s]





 21%|████████▌                                | 104/500 [00:23<01:30,  4.40it/s]





 21%|████████▌                                | 105/500 [00:23<01:29,  4.40it/s]





 21%|████████▋                                | 106/500 [00:23<01:29,  4.43it/s]





 21%|████████▊                                | 107/500 [00:24<01:28,  4.42it/s]





 22%|████████▊                                | 108/500 [00:24<01:28,  4.44it/s]





 22%|████████▉                                | 109/500 [00:24<01:28,  4.43it/s]





 22%|█████████                                | 110/500 [00:24<01:27,  4.44it/s]





 22%|█████████                                | 111/500 [00:25<01:27,  4.43it/s]





 22%|█████████▏                               | 112/500 [00:25<01:27,  4.44it/s]





 23%|█████████▎                               | 113/500 [00:25<01:27,  4.42it/s]





 23%|█████████▎                               | 114/500 [00:25<01:27,  4.43it/s]





 23%|█████████▍                               | 115/500 [00:26<01:26,  4.43it/s]





 23%|█████████▌                               | 116/500 [00:26<01:26,  4.44it/s]





 23%|█████████▌                               | 117/500 [00:26<01:26,  4.41it/s]





 24%|█████████▋                               | 118/500 [00:26<01:26,  4.43it/s]





 24%|█████████▊                               | 119/500 [00:26<01:26,  4.42it/s]





 24%|█████████▊                               | 120/500 [00:27<01:25,  4.43it/s]





 24%|█████████▉                               | 121/500 [00:27<01:25,  4.43it/s]





 24%|██████████                               | 122/500 [00:27<01:25,  4.44it/s]





 25%|██████████                               | 123/500 [00:27<01:25,  4.43it/s]





 25%|██████████▏                              | 124/500 [00:28<01:24,  4.44it/s]





 25%|██████████▎                              | 125/500 [00:28<01:24,  4.43it/s]





 25%|██████████▎                              | 126/500 [00:28<01:25,  4.40it/s]





 25%|██████████▍                              | 127/500 [00:28<01:24,  4.39it/s]





 26%|██████████▍                              | 128/500 [00:28<01:24,  4.42it/s]





 26%|██████████▌                              | 129/500 [00:29<01:24,  4.40it/s]





 26%|██████████▋                              | 130/500 [00:29<01:23,  4.42it/s]





 26%|██████████▋                              | 131/500 [00:29<01:23,  4.42it/s]





 26%|██████████▊                              | 132/500 [00:29<01:23,  4.43it/s]





 27%|██████████▉                              | 133/500 [00:30<01:22,  4.43it/s]





 27%|██████████▉                              | 134/500 [00:30<01:22,  4.44it/s]





 27%|███████████                              | 135/500 [00:30<01:22,  4.43it/s]





 27%|███████████▏                             | 136/500 [00:30<01:21,  4.45it/s]





 27%|███████████▏                             | 137/500 [00:30<01:21,  4.43it/s]





 28%|███████████▎                             | 138/500 [00:31<01:21,  4.43it/s]





 28%|███████████▍                             | 139/500 [00:31<01:21,  4.41it/s]





 28%|███████████▍                             | 140/500 [00:31<01:21,  4.42it/s]





 28%|███████████▌                             | 141/500 [00:31<01:21,  4.40it/s]





 28%|███████████▋                             | 142/500 [00:32<01:21,  4.41it/s]





 29%|███████████▋                             | 143/500 [00:32<01:20,  4.41it/s]





 29%|███████████▊                             | 144/500 [00:32<01:20,  4.42it/s]





 29%|███████████▉                             | 145/500 [00:32<01:20,  4.42it/s]





 29%|███████████▉                             | 146/500 [00:33<01:19,  4.43it/s]





 29%|████████████                             | 147/500 [00:33<01:19,  4.42it/s]





 30%|████████████▏                            | 148/500 [00:33<01:19,  4.44it/s]





 30%|████████████▏                            | 149/500 [00:33<01:19,  4.43it/s]





 30%|████████████▎                            | 150/500 [00:33<01:18,  4.44it/s]





 30%|████████████▍                            | 151/500 [00:34<01:18,  4.42it/s]





 30%|████████████▍                            | 152/500 [00:34<01:18,  4.44it/s]





 31%|████████████▌                            | 153/500 [00:34<01:18,  4.43it/s]





 31%|████████████▋                            | 154/500 [00:34<01:17,  4.44it/s]





 31%|████████████▋                            | 155/500 [00:35<01:17,  4.43it/s]





 31%|████████████▊                            | 156/500 [00:35<01:17,  4.44it/s]





 31%|████████████▊                            | 157/500 [00:35<01:17,  4.43it/s]





 32%|████████████▉                            | 158/500 [00:35<01:17,  4.44it/s]





 32%|█████████████                            | 159/500 [00:35<01:16,  4.43it/s]





 32%|█████████████                            | 160/500 [00:36<01:16,  4.45it/s]





 32%|█████████████▏                           | 161/500 [00:36<01:16,  4.44it/s]





 32%|█████████████▎                           | 162/500 [00:36<01:16,  4.45it/s]





 33%|█████████████▎                           | 163/500 [00:36<01:16,  4.43it/s]





 33%|█████████████▍                           | 164/500 [00:37<01:15,  4.44it/s]





 33%|█████████████▌                           | 165/500 [00:37<01:15,  4.43it/s]





 33%|█████████████▌                           | 166/500 [00:37<01:15,  4.44it/s]





 33%|█████████████▋                           | 167/500 [00:37<01:15,  4.42it/s]





 34%|█████████████▊                           | 168/500 [00:37<01:14,  4.44it/s]





 34%|█████████████▊                           | 169/500 [00:38<01:14,  4.43it/s]





 34%|█████████████▉                           | 170/500 [00:38<01:14,  4.44it/s]





 34%|██████████████                           | 171/500 [00:38<01:14,  4.43it/s]





 34%|██████████████                           | 172/500 [00:38<01:13,  4.43it/s]





 35%|██████████████▏                          | 173/500 [00:39<01:14,  4.42it/s]





 35%|██████████████▎                          | 174/500 [00:39<01:13,  4.44it/s]





 35%|██████████████▎                          | 175/500 [00:39<01:13,  4.43it/s]





 35%|██████████████▍                          | 176/500 [00:39<01:13,  4.43it/s]





 35%|██████████████▌                          | 177/500 [00:40<01:13,  4.41it/s]





 36%|██████████████▌                          | 178/500 [00:40<01:12,  4.42it/s]





 36%|██████████████▋                          | 179/500 [00:40<01:12,  4.42it/s]





 36%|██████████████▊                          | 180/500 [00:40<01:12,  4.43it/s]





 36%|██████████████▊                          | 181/500 [00:40<01:12,  4.43it/s]





 36%|██████████████▉                          | 182/500 [00:41<01:11,  4.43it/s]





 37%|███████████████                          | 183/500 [00:41<01:11,  4.42it/s]





 37%|███████████████                          | 184/500 [00:41<01:11,  4.43it/s]





 37%|███████████████▏                         | 185/500 [00:41<01:11,  4.41it/s]





 37%|███████████████▎                         | 186/500 [00:42<01:10,  4.43it/s]





 37%|███████████████▎                         | 187/500 [00:42<01:10,  4.41it/s]





 38%|███████████████▍                         | 188/500 [00:42<01:10,  4.42it/s]





 38%|███████████████▍                         | 189/500 [00:42<01:10,  4.41it/s]





 38%|███████████████▌                         | 190/500 [00:42<01:12,  4.28it/s]





 38%|███████████████▋                         | 191/500 [00:43<01:12,  4.25it/s]





 38%|███████████████▋                         | 192/500 [00:43<01:13,  4.20it/s]





 39%|███████████████▊                         | 193/500 [00:43<01:13,  4.19it/s]





 39%|███████████████▉                         | 194/500 [00:43<01:11,  4.26it/s]





 39%|███████████████▉                         | 195/500 [00:44<01:10,  4.30it/s]





 39%|████████████████                         | 196/500 [00:44<01:09,  4.35it/s]





 39%|████████████████▏                        | 197/500 [00:44<01:09,  4.37it/s]





 40%|████████████████▏                        | 198/500 [00:44<01:08,  4.39it/s]





 40%|████████████████▎                        | 199/500 [00:45<01:08,  4.38it/s]





 40%|████████████████▍                        | 200/500 [00:45<01:08,  4.39it/s]





 40%|████████████████▍                        | 201/500 [00:45<01:08,  4.37it/s]





 40%|████████████████▌                        | 202/500 [00:45<01:08,  4.38it/s]





 41%|████████████████▋                        | 203/500 [00:45<01:08,  4.36it/s]





 41%|████████████████▋                        | 204/500 [00:46<01:07,  4.38it/s]





 41%|████████████████▊                        | 205/500 [00:46<01:07,  4.36it/s]





 41%|████████████████▉                        | 206/500 [00:46<01:06,  4.39it/s]





 41%|████████████████▉                        | 207/500 [00:46<01:06,  4.40it/s]





 42%|█████████████████                        | 208/500 [00:47<01:06,  4.42it/s]





 42%|█████████████████▏                       | 209/500 [00:47<01:05,  4.41it/s]





 42%|█████████████████▏                       | 210/500 [00:47<01:05,  4.42it/s]





 42%|█████████████████▎                       | 211/500 [00:47<01:05,  4.42it/s]





 42%|█████████████████▍                       | 212/500 [00:48<01:04,  4.44it/s]





 43%|█████████████████▍                       | 213/500 [00:48<01:04,  4.43it/s]





 43%|█████████████████▌                       | 214/500 [00:48<01:04,  4.45it/s]





 43%|█████████████████▋                       | 215/500 [00:48<01:04,  4.43it/s]





 43%|█████████████████▋                       | 216/500 [00:48<01:04,  4.42it/s]





 43%|█████████████████▊                       | 217/500 [00:49<01:04,  4.41it/s]





 44%|█████████████████▉                       | 218/500 [00:49<01:03,  4.43it/s]





 44%|█████████████████▉                       | 219/500 [00:49<01:03,  4.42it/s]





 44%|██████████████████                       | 220/500 [00:49<01:03,  4.44it/s]





 44%|██████████████████                       | 221/500 [00:50<01:02,  4.43it/s]





 44%|██████████████████▏                      | 222/500 [00:50<01:02,  4.44it/s]





 45%|██████████████████▎                      | 223/500 [00:50<01:02,  4.42it/s]





 45%|██████████████████▎                      | 224/500 [00:50<01:02,  4.43it/s]['screw', 0.9385119901619184, 0.9939371216750871, 0.971480938298412]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 8/10 for toothbrush







| feature extraction | train | toothbrush |:   0%|        | 0/2 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:







| feature extraction | train | toothbrush |:  50%|▌| 1/2 [00:01<00:01,  1.58s/it]






| feature extraction | train | toothbrush |: 100%|█| 2/2 [00:02<00:00,  1.46s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [6144, 384].
2022-04-22 18:13:58	Train ends, total 12.39s
Saving model...
2022-04-22 18:13:58	Save model in ./output/coreset_resnet18_10/toothbrush.pdparams
2022-04-22 18:13:58	Starting eval model...







| feature extraction | test | toothbrush |:   0%|        | 0/42 [00:00<?, ?it/s]






| feature extraction | test | toothbrush |:   2%| | 1/42 [00:00<00:10,  3.77it/s]






| feature extraction | test | toothbrush |:   5%| | 2/42 [00:00<00:10,  3.95it/s]






| feature extraction | test | toothbrush |:   7%| | 3/42 [00:00<00:09,  4.11it/s]






| feature extraction | test | toothbrush |:  10%| | 4/42 [00:00<00:08,  4.45it/s]






| feature extraction | test | toothbrush |:  12%| | 5/42 [00:01<00:07,  4.74it/s]






| feature extraction | test | toothbrush |:  14%|▏| 6/42 [00:01<00:07,  5.02it/s]






| feature extraction | test | toothbrush |:  17%|▏| 7/42 [00:01<00:06,  5.48it/s]






| feature extraction | test | toothbrush |:  19%|▏| 8/42 [00:01<00:05,  5.89it/s]






| feature extraction | test | toothbrush |:  21%|▏| 9/42 [00:01<00:05,  6.20it/s]






| feature extraction | test | toothbrush |:  24%|▏| 10/42 [00:01<00:04,  6.46it/s]






| feature extraction | test | toothbrush |:  26%|▎| 11/42 [00:01<00:04,  6.66it/s]






| feature extraction | test | toothbrush |:  29%|▎| 12/42 [00:02<00:04,  6.80it/s]






| feature extraction | test | toothbrush |:  31%|▎| 13/42 [00:02<00:04,  6.92it/s]






| feature extraction | test | toothbrush |:  33%|▎| 14/42 [00:02<00:03,  7.01it/s]






| feature extraction | test | toothbrush |:  36%|▎| 15/42 [00:02<00:03,  7.06it/s]






| feature extraction | test | toothbrush |:  38%|▍| 16/42 [00:02<00:03,  7.08it/s]






| feature extraction | test | toothbrush |:  40%|▍| 17/42 [00:02<00:03,  7.05it/s]






| feature extraction | test | toothbrush |:  43%|▍| 18/42 [00:02<00:03,  6.97it/s]






| feature extraction | test | toothbrush |:  45%|▍| 19/42 [00:03<00:03,  6.97it/s]






| feature extraction | test | toothbrush |:  48%|▍| 20/42 [00:03<00:03,  7.03it/s]






| feature extraction | test | toothbrush |:  50%|▌| 21/42 [00:03<00:02,  7.04it/s]






| feature extraction | test | toothbrush |:  52%|▌| 22/42 [00:03<00:02,  7.00it/s]






| feature extraction | test | toothbrush |:  55%|▌| 23/42 [00:03<00:02,  7.00it/s]






| feature extraction | test | toothbrush |:  57%|▌| 24/42 [00:03<00:02,  7.06it/s]






| feature extraction | test | toothbrush |:  60%|▌| 25/42 [00:03<00:02,  7.09it/s]






| feature extraction | test | toothbrush |:  62%|▌| 26/42 [00:04<00:02,  7.09it/s]






| feature extraction | test | toothbrush |:  64%|▋| 27/42 [00:04<00:02,  7.14it/s]






| feature extraction | test | toothbrush |:  67%|▋| 28/42 [00:04<00:01,  7.16it/s]






| feature extraction | test | toothbrush |:  69%|▋| 29/42 [00:04<00:01,  7.17it/s]






| feature extraction | test | toothbrush |:  71%|▋| 30/42 [00:04<00:01,  7.19it/s]






| feature extraction | test | toothbrush |:  74%|▋| 31/42 [00:04<00:01,  7.21it/s]






| feature extraction | test | toothbrush |:  76%|▊| 32/42 [00:04<00:01,  7.20it/s]






| feature extraction | test | toothbrush |:  79%|▊| 33/42 [00:05<00:01,  7.21it/s]






| feature extraction | test | toothbrush |:  81%|▊| 34/42 [00:05<00:01,  7.13it/s]






| feature extraction | test | toothbrush |:  83%|▊| 35/42 [00:05<00:00,  7.05it/s]






| feature extraction | test | toothbrush |:  86%|▊| 36/42 [00:05<00:00,  7.01it/s]






| feature extraction | test | toothbrush |:  88%|▉| 37/42 [00:05<00:00,  6.98it/s]






| feature extraction | test | toothbrush |:  90%|▉| 38/42 [00:05<00:00,  6.97it/s]






| feature extraction | test | toothbrush |:  93%|▉| 39/42 [00:05<00:00,  7.10it/s]






| feature extraction | test | toothbrush |:  95%|▉| 40/42 [00:06<00:00,  7.20it/s]






| feature extraction | test | toothbrush |:  98%|▉| 41/42 [00:06<00:00,  7.28it/s]






| feature extraction | test | toothbrush |: 100%|█| 42/42 [00:06<00:00,  6.68it/s]
max_score:4.206387519836426 min_score:0.3471667170524597
F1 image:0.967741935483871 threshold:4.206387519836426
F1 pixel:0.5710897149780017 threshold:4.206387519836426







  0%|                                                   | 0/500 [00:00<?, ?it/s]






  0%|▏                                          | 2/500 [00:00<00:28, 17.18it/s]






  1%|▎                                          | 4/500 [00:00<00:28, 17.21it/s]






  1%|▌                                          | 6/500 [00:00<00:28, 17.24it/s]






  2%|▋                                          | 8/500 [00:00<00:28, 17.31it/s]






  2%|▊                                         | 10/500 [00:00<00:28, 17.31it/s]






  2%|█                                         | 12/500 [00:00<00:28, 17.33it/s]






  3%|█▏                                        | 14/500 [00:00<00:27, 17.37it/s]






  3%|█▎                                        | 16/500 [00:00<00:27, 17.39it/s]






  4%|█▌                                        | 18/500 [00:01<00:27, 17.39it/s]






  4%|█▋                                        | 20/500 [00:01<00:27, 17.38it/s]






  4%|█▊                                        | 22/500 [00:01<00:27, 17.39it/s]






  5%|██                                        | 24/500 [00:01<00:27, 17.39it/s]






  5%|██▏                                       | 26/500 [00:01<00:27, 17.40it/s]






  6%|██▎                                       | 28/500 [00:01<00:27, 17.38it/s]






  6%|██▌                                       | 30/500 [00:01<00:27, 17.39it/s]






  6%|██▋                                       | 32/500 [00:01<00:27, 17.31it/s]






  7%|██▊                                       | 34/500 [00:01<00:26, 17.33it/s]






  7%|███                                       | 36/500 [00:02<00:26, 17.31it/s]






  8%|███▏                                      | 38/500 [00:02<00:26, 17.29it/s]






  8%|███▎                                      | 40/500 [00:02<00:26, 17.24it/s]






  8%|███▌                                      | 42/500 [00:02<00:26, 17.25it/s]






  9%|███▋                                      | 44/500 [00:02<00:26, 17.30it/s]






  9%|███▊                                      | 46/500 [00:02<00:26, 17.27it/s]






 10%|████                                      | 48/500 [00:02<00:26, 17.28it/s]






 10%|████▏                                     | 50/500 [00:02<00:26, 17.27it/s]






 10%|████▎                                     | 52/500 [00:03<00:25, 17.27it/s]






 11%|████▌                                     | 54/500 [00:03<00:25, 17.25it/s]






 11%|████▋                                     | 56/500 [00:03<00:25, 17.31it/s]






 12%|████▊                                     | 58/500 [00:03<00:25, 17.32it/s]






 12%|█████                                     | 60/500 [00:03<00:25, 17.28it/s]






 12%|█████▏                                    | 62/500 [00:03<00:25, 17.23it/s]






 13%|█████▍                                    | 64/500 [00:03<00:25, 17.18it/s]






 13%|█████▌                                    | 66/500 [00:03<00:25, 17.18it/s]






 14%|█████▋                                    | 68/500 [00:03<00:25, 17.23it/s]






 14%|█████▉                                    | 70/500 [00:04<00:25, 16.89it/s]






 14%|██████                                    | 72/500 [00:04<00:26, 16.36it/s]






 15%|██████▏                                   | 74/500 [00:04<00:26, 16.33it/s]






 15%|██████▍                                   | 76/500 [00:04<00:26, 16.30it/s]






 16%|██████▌                                   | 78/500 [00:04<00:26, 15.92it/s]






 16%|██████▋                                   | 80/500 [00:04<00:25, 16.32it/s]






 16%|██████▉                                   | 82/500 [00:04<00:25, 16.56it/s]






 17%|███████                                   | 84/500 [00:04<00:24, 16.81it/s]






 17%|███████▏                                  | 86/500 [00:05<00:24, 16.81it/s]






 18%|███████▍                                  | 88/500 [00:05<00:25, 16.05it/s]






 18%|███████▌                                  | 90/500 [00:05<00:25, 16.08it/s]






 18%|███████▋                                  | 92/500 [00:05<00:25, 16.11it/s]






 19%|███████▉                                  | 94/500 [00:05<00:25, 15.80it/s]






 19%|████████                                  | 96/500 [00:05<00:24, 16.21it/s]






 20%|████████▏                                 | 98/500 [00:05<00:24, 16.50it/s]






 20%|████████▏                                | 100/500 [00:05<00:23, 16.74it/s]






 20%|████████▎                                | 102/500 [00:06<00:23, 16.91it/s]






 21%|████████▌                                | 104/500 [00:06<00:23, 16.96it/s]






 21%|████████▋                                | 106/500 [00:06<00:23, 17.03it/s]






 22%|████████▊                                | 108/500 [00:06<00:22, 17.11it/s]






 22%|█████████                                | 110/500 [00:06<00:22, 17.16it/s]






 22%|█████████▏                               | 112/500 [00:06<00:22, 17.17it/s]






 23%|█████████▎                               | 114/500 [00:06<00:22, 17.19it/s]






 23%|█████████▌                               | 116/500 [00:06<00:22, 17.15it/s]






 24%|█████████▋                               | 118/500 [00:06<00:22, 17.15it/s]






 24%|█████████▊                               | 120/500 [00:07<00:22, 17.20it/s]






 24%|██████████                               | 122/500 [00:07<00:21, 17.22it/s]






 25%|██████████▏                              | 124/500 [00:07<00:21, 17.22it/s]






 25%|██████████▎                              | 126/500 [00:07<00:21, 17.21it/s]






 26%|██████████▍                              | 128/500 [00:07<00:21, 17.20it/s]






 26%|██████████▋                              | 130/500 [00:07<00:21, 17.22it/s]






 26%|██████████▊                              | 132/500 [00:07<00:21, 17.22it/s]






 27%|██████████▉                              | 134/500 [00:07<00:21, 17.22it/s]






 27%|███████████▏                             | 136/500 [00:07<00:21, 17.24it/s]






 28%|███████████▎                             | 138/500 [00:08<00:20, 17.25it/s]






 28%|███████████▍                             | 140/500 [00:08<00:20, 17.27it/s]






 28%|███████████▋                             | 142/500 [00:08<00:20, 17.27it/s]






 29%|███████████▊                             | 144/500 [00:08<00:20, 17.32it/s]






 29%|███████████▉                             | 146/500 [00:08<00:20, 17.34it/s]






 30%|████████████▏                            | 148/500 [00:08<00:20, 17.35it/s]






 30%|████████████▎                            | 150/500 [00:08<00:20, 17.34it/s]






 30%|████████████▍                            | 152/500 [00:08<00:20, 17.39it/s]






 31%|████████████▋                            | 154/500 [00:09<00:19, 17.38it/s]






 31%|████████████▊                            | 156/500 [00:09<00:19, 17.36it/s]






 32%|████████████▉                            | 158/500 [00:09<00:19, 17.37it/s]






 32%|█████████████                            | 160/500 [00:09<00:19, 17.36it/s]






 32%|█████████████▎                           | 162/500 [00:09<00:19, 17.35it/s]






 33%|█████████████▍                           | 164/500 [00:09<00:19, 17.36it/s]






 33%|█████████████▌                           | 166/500 [00:09<00:19, 17.37it/s]






 34%|█████████████▊                           | 168/500 [00:09<00:19, 17.36it/s]






 34%|█████████████▉                           | 170/500 [00:09<00:19, 17.34it/s]






 34%|██████████████                           | 172/500 [00:10<00:18, 17.32it/s]






 35%|██████████████▎                          | 174/500 [00:10<00:18, 17.31it/s]






 35%|██████████████▍                          | 176/500 [00:10<00:18, 17.30it/s]






 36%|██████████████▌                          | 178/500 [00:10<00:18, 17.28it/s]['toothbrush', 0.9361111111111111, 0.9909759812213892, 0.9179740042649924]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 9/10 for transistor








| feature extraction | train | transistor |:   0%|        | 0/7 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:








| feature extraction | train | transistor |:  14%|▏| 1/7 [00:01<00:10,  1.69s/it]







| feature extraction | train | transistor |:  29%|▎| 2/7 [00:03<00:08,  1.70s/it]







| feature extraction | train | transistor |:  43%|▍| 3/7 [00:05<00:06,  1.71s/it]







| feature extraction | train | transistor |:  57%|▌| 4/7 [00:06<00:05,  1.70s/it]







| feature extraction | train | transistor |:  71%|▋| 5/7 [00:08<00:03,  1.69s/it]







| feature extraction | train | transistor |:  86%|▊| 6/7 [00:10<00:01,  1.68s/it]






 36%|██████████████▌                          | 178/500 [00:21<00:18, 17.28it/s]







| feature extraction | train | transistor |: 100%|█| 7/7 [00:11<00:00,  1.61s/it]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [21811, 384].
2022-04-22 18:15:32	Train ends, total 75.72s
Saving model...
2022-04-22 18:15:32	Save model in ./output/coreset_resnet18_10/transistor.pdparams
2022-04-22 18:15:32	Starting eval model...








| feature extraction | test | transistor |:   0%|       | 0/100 [00:00<?, ?it/s]







| feature extraction | test | transistor |:   1%| | 1/100 [00:00<00:31,  3.10it/s]







| feature extraction | test | transistor |:   2%| | 2/100 [00:00<00:29,  3.29it/s]







| feature extraction | test | transistor |:   3%| | 3/100 [00:00<00:28,  3.42it/s]







| feature extraction | test | transistor |:   4%| | 4/100 [00:01<00:27,  3.53it/s]







| feature extraction | test | transistor |:   5%| | 5/100 [00:01<00:26,  3.62it/s]







| feature extraction | test | transistor |:   6%| | 6/100 [00:01<00:25,  3.68it/s]







| feature extraction | test | transistor |:   7%| | 7/100 [00:01<00:24,  3.72it/s]







| feature extraction | test | transistor |:   8%| | 8/100 [00:02<00:24,  3.75it/s]







| feature extraction | test | transistor |:   9%| | 9/100 [00:02<00:24,  3.77it/s]







| feature extraction | test | transistor |:  10%| | 10/100 [00:02<00:23,  3.79it/s]







| feature extraction | test | transistor |:  11%| | 11/100 [00:02<00:23,  3.80it/s]







| feature extraction | test | transistor |:  12%| | 12/100 [00:03<00:23,  3.81it/s]







| feature extraction | test | transistor |:  13%|▏| 13/100 [00:03<00:22,  3.81it/s]







| feature extraction | test | transistor |:  14%|▏| 14/100 [00:03<00:22,  3.78it/s]







| feature extraction | test | transistor |:  15%|▏| 15/100 [00:03<00:22,  3.80it/s]







| feature extraction | test | transistor |:  16%|▏| 16/100 [00:04<00:22,  3.81it/s]







| feature extraction | test | transistor |:  17%|▏| 17/100 [00:04<00:21,  3.82it/s]







| feature extraction | test | transistor |:  18%|▏| 18/100 [00:04<00:21,  3.83it/s]







| feature extraction | test | transistor |:  19%|▏| 19/100 [00:05<00:21,  3.83it/s]







| feature extraction | test | transistor |:  20%|▏| 20/100 [00:05<00:20,  3.83it/s]







| feature extraction | test | transistor |:  21%|▏| 21/100 [00:05<00:20,  3.83it/s]







| feature extraction | test | transistor |:  22%|▏| 22/100 [00:05<00:20,  3.83it/s]







| feature extraction | test | transistor |:  23%|▏| 23/100 [00:06<00:20,  3.83it/s]







| feature extraction | test | transistor |:  24%|▏| 24/100 [00:06<00:19,  3.82it/s]







| feature extraction | test | transistor |:  25%|▎| 25/100 [00:06<00:19,  3.83it/s]







| feature extraction | test | transistor |:  26%|▎| 26/100 [00:06<00:19,  3.83it/s]







| feature extraction | test | transistor |:  27%|▎| 27/100 [00:07<00:19,  3.83it/s]







| feature extraction | test | transistor |:  28%|▎| 28/100 [00:07<00:18,  3.83it/s]







| feature extraction | test | transistor |:  29%|▎| 29/100 [00:07<00:18,  3.83it/s]







| feature extraction | test | transistor |:  30%|▎| 30/100 [00:07<00:18,  3.83it/s]







| feature extraction | test | transistor |:  31%|▎| 31/100 [00:08<00:18,  3.82it/s]







| feature extraction | test | transistor |:  32%|▎| 32/100 [00:08<00:17,  3.82it/s]







| feature extraction | test | transistor |:  33%|▎| 33/100 [00:08<00:17,  3.82it/s]







| feature extraction | test | transistor |:  34%|▎| 34/100 [00:08<00:17,  3.82it/s]







| feature extraction | test | transistor |:  35%|▎| 35/100 [00:09<00:17,  3.82it/s]







| feature extraction | test | transistor |:  36%|▎| 36/100 [00:09<00:16,  3.82it/s]







| feature extraction | test | transistor |:  37%|▎| 37/100 [00:09<00:16,  3.82it/s]







| feature extraction | test | transistor |:  38%|▍| 38/100 [00:10<00:16,  3.82it/s]







| feature extraction | test | transistor |:  39%|▍| 39/100 [00:10<00:15,  3.82it/s]







| feature extraction | test | transistor |:  40%|▍| 40/100 [00:10<00:15,  3.83it/s]







| feature extraction | test | transistor |:  41%|▍| 41/100 [00:10<00:15,  3.81it/s]







| feature extraction | test | transistor |:  42%|▍| 42/100 [00:11<00:15,  3.81it/s]







| feature extraction | test | transistor |:  43%|▍| 43/100 [00:11<00:15,  3.69it/s]







| feature extraction | test | transistor |:  44%|▍| 44/100 [00:11<00:15,  3.70it/s]







| feature extraction | test | transistor |:  45%|▍| 45/100 [00:11<00:14,  3.74it/s]







| feature extraction | test | transistor |:  46%|▍| 46/100 [00:12<00:14,  3.77it/s]







| feature extraction | test | transistor |:  47%|▍| 47/100 [00:12<00:14,  3.79it/s]







| feature extraction | test | transistor |:  48%|▍| 48/100 [00:12<00:13,  3.80it/s]







| feature extraction | test | transistor |:  49%|▍| 49/100 [00:12<00:13,  3.81it/s]







| feature extraction | test | transistor |:  50%|▌| 50/100 [00:13<00:13,  3.81it/s]







| feature extraction | test | transistor |:  51%|▌| 51/100 [00:13<00:12,  3.82it/s]







| feature extraction | test | transistor |:  52%|▌| 52/100 [00:13<00:12,  3.82it/s]







| feature extraction | test | transistor |:  53%|▌| 53/100 [00:13<00:12,  3.82it/s]







| feature extraction | test | transistor |:  54%|▌| 54/100 [00:14<00:12,  3.82it/s]







| feature extraction | test | transistor |:  55%|▌| 55/100 [00:14<00:11,  3.82it/s]







| feature extraction | test | transistor |:  56%|▌| 56/100 [00:14<00:11,  3.82it/s]







| feature extraction | test | transistor |:  57%|▌| 57/100 [00:15<00:11,  3.82it/s]







| feature extraction | test | transistor |:  58%|▌| 58/100 [00:15<00:10,  3.82it/s]







| feature extraction | test | transistor |:  59%|▌| 59/100 [00:15<00:10,  3.82it/s]







| feature extraction | test | transistor |:  60%|▌| 60/100 [00:15<00:10,  3.82it/s]







| feature extraction | test | transistor |:  61%|▌| 61/100 [00:16<00:10,  3.82it/s]







| feature extraction | test | transistor |:  62%|▌| 62/100 [00:16<00:09,  3.82it/s]







| feature extraction | test | transistor |:  63%|▋| 63/100 [00:16<00:09,  3.82it/s]







| feature extraction | test | transistor |:  64%|▋| 64/100 [00:16<00:09,  3.83it/s]







| feature extraction | test | transistor |:  65%|▋| 65/100 [00:17<00:09,  3.83it/s]







| feature extraction | test | transistor |:  66%|▋| 66/100 [00:17<00:08,  3.83it/s]







| feature extraction | test | transistor |:  67%|▋| 67/100 [00:17<00:08,  3.84it/s]







| feature extraction | test | transistor |:  68%|▋| 68/100 [00:17<00:08,  3.84it/s]







| feature extraction | test | transistor |:  69%|▋| 69/100 [00:18<00:08,  3.84it/s]







| feature extraction | test | transistor |:  70%|▋| 70/100 [00:18<00:07,  3.84it/s]







| feature extraction | test | transistor |:  71%|▋| 71/100 [00:18<00:07,  3.84it/s]







| feature extraction | test | transistor |:  72%|▋| 72/100 [00:18<00:07,  3.84it/s]







| feature extraction | test | transistor |:  73%|▋| 73/100 [00:19<00:07,  3.84it/s]







| feature extraction | test | transistor |:  74%|▋| 74/100 [00:19<00:06,  3.84it/s]







| feature extraction | test | transistor |:  75%|▊| 75/100 [00:19<00:06,  3.83it/s]







| feature extraction | test | transistor |:  76%|▊| 76/100 [00:19<00:06,  3.83it/s]







| feature extraction | test | transistor |:  77%|▊| 77/100 [00:20<00:06,  3.83it/s]







| feature extraction | test | transistor |:  78%|▊| 78/100 [00:20<00:05,  3.82it/s]







| feature extraction | test | transistor |:  79%|▊| 79/100 [00:20<00:05,  3.81it/s]







| feature extraction | test | transistor |:  80%|▊| 80/100 [00:21<00:05,  3.81it/s]







| feature extraction | test | transistor |:  81%|▊| 81/100 [00:21<00:04,  3.80it/s]







| feature extraction | test | transistor |:  82%|▊| 82/100 [00:21<00:04,  3.81it/s]







| feature extraction | test | transistor |:  83%|▊| 83/100 [00:21<00:04,  3.81it/s]







| feature extraction | test | transistor |:  84%|▊| 84/100 [00:22<00:04,  3.82it/s]







| feature extraction | test | transistor |:  85%|▊| 85/100 [00:22<00:03,  3.82it/s]







| feature extraction | test | transistor |:  86%|▊| 86/100 [00:22<00:03,  3.82it/s]







| feature extraction | test | transistor |:  87%|▊| 87/100 [00:22<00:03,  3.81it/s]







| feature extraction | test | transistor |:  88%|▉| 88/100 [00:23<00:03,  3.80it/s]







| feature extraction | test | transistor |:  89%|▉| 89/100 [00:23<00:02,  3.81it/s]







| feature extraction | test | transistor |:  90%|▉| 90/100 [00:23<00:02,  3.81it/s]







| feature extraction | test | transistor |:  91%|▉| 91/100 [00:23<00:02,  3.81it/s]







| feature extraction | test | transistor |:  92%|▉| 92/100 [00:24<00:02,  3.81it/s]







| feature extraction | test | transistor |:  93%|▉| 93/100 [00:24<00:01,  3.81it/s]







| feature extraction | test | transistor |:  94%|▉| 94/100 [00:24<00:01,  3.82it/s]







| feature extraction | test | transistor |:  95%|▉| 95/100 [00:24<00:01,  3.82it/s]







| feature extraction | test | transistor |:  96%|▉| 96/100 [00:25<00:01,  3.83it/s]







| feature extraction | test | transistor |:  97%|▉| 97/100 [00:25<00:00,  3.84it/s]







| feature extraction | test | transistor |:  98%|▉| 98/100 [00:25<00:00,  3.86it/s]







| feature extraction | test | transistor |:  99%|▉| 99/100 [00:25<00:00,  3.87it/s]







| feature extraction | test | transistor |: 100%|█| 100/100 [00:26<00:00,  3.81it/s]
max_score:3.9322619438171387 min_score:0.6137608289718628
F1 image:0.9620253164556962 threshold:3.9322619438171387
F1 pixel:0.5781923383878691 threshold:3.9322619438171387








  0%|                                                   | 0/500 [00:00<?, ?it/s]







  0%|                                           | 1/500 [00:00<01:19,  6.26it/s]







  0%|▏                                          | 2/500 [00:00<01:19,  6.29it/s]







  1%|▎                                          | 3/500 [00:00<01:19,  6.28it/s]







  1%|▎                                          | 4/500 [00:00<01:19,  6.26it/s]







  1%|▍                                          | 5/500 [00:00<01:18,  6.27it/s]







  1%|▌                                          | 6/500 [00:00<01:19,  6.18it/s]







  1%|▌                                          | 7/500 [00:01<01:19,  6.21it/s]







  2%|▋                                          | 8/500 [00:01<01:18,  6.30it/s]







  2%|▊                                          | 9/500 [00:01<01:19,  6.15it/s]







  2%|▊                                         | 10/500 [00:01<01:22,  5.95it/s]







  2%|▉                                         | 11/500 [00:01<01:22,  5.95it/s]







  2%|█                                         | 12/500 [00:01<01:22,  5.90it/s]







  3%|█                                         | 13/500 [00:02<01:22,  5.88it/s]







  3%|█▏                                        | 14/500 [00:02<01:21,  5.96it/s]







  3%|█▎                                        | 15/500 [00:02<01:20,  6.04it/s]







  3%|█▎                                        | 16/500 [00:02<01:19,  6.07it/s]







  3%|█▍                                        | 17/500 [00:02<01:18,  6.15it/s]







  4%|█▌                                        | 18/500 [00:02<01:17,  6.23it/s]







  4%|█▌                                        | 19/500 [00:03<01:16,  6.25it/s]







  4%|█▋                                        | 20/500 [00:03<01:16,  6.30it/s]







  4%|█▊                                        | 21/500 [00:03<01:16,  6.25it/s]







  4%|█▊                                        | 22/500 [00:03<01:15,  6.33it/s]







  5%|█▉                                        | 23/500 [00:03<01:15,  6.29it/s]







  5%|██                                        | 24/500 [00:03<01:15,  6.28it/s]







  5%|██                                        | 25/500 [00:04<01:16,  6.21it/s]







  5%|██▏                                       | 26/500 [00:04<01:16,  6.23it/s]







  5%|██▎                                       | 27/500 [00:04<01:15,  6.26it/s]







  6%|██▎                                       | 28/500 [00:04<01:15,  6.24it/s]







  6%|██▍                                       | 29/500 [00:04<01:17,  6.11it/s]







  6%|██▌                                       | 30/500 [00:04<01:16,  6.12it/s]







  6%|██▌                                       | 31/500 [00:05<01:17,  6.03it/s]







  6%|██▋                                       | 32/500 [00:05<01:16,  6.12it/s]







  7%|██▊                                       | 33/500 [00:05<01:16,  6.13it/s]







  7%|██▊                                       | 34/500 [00:05<01:15,  6.18it/s]







  7%|██▉                                       | 35/500 [00:05<01:14,  6.22it/s]







  7%|███                                       | 36/500 [00:05<01:13,  6.29it/s]







  7%|███                                       | 37/500 [00:05<01:13,  6.33it/s]







  8%|███▏                                      | 38/500 [00:06<01:12,  6.37it/s]







  8%|███▎                                      | 39/500 [00:06<01:12,  6.39it/s]







  8%|███▎                                      | 40/500 [00:06<01:11,  6.41it/s]







  8%|███▍                                      | 41/500 [00:06<01:12,  6.37it/s]







  8%|███▌                                      | 42/500 [00:06<01:11,  6.40it/s]







  9%|███▌                                      | 43/500 [00:06<01:11,  6.39it/s]







  9%|███▋                                      | 44/500 [00:07<01:11,  6.38it/s]







  9%|███▊                                      | 45/500 [00:07<01:11,  6.37it/s]







  9%|███▊                                      | 46/500 [00:07<01:10,  6.42it/s]







  9%|███▉                                      | 47/500 [00:07<01:10,  6.41it/s]







 10%|████                                      | 48/500 [00:07<01:10,  6.44it/s]







 10%|████                                      | 49/500 [00:07<01:10,  6.42it/s]







 10%|████▏                                     | 50/500 [00:08<01:10,  6.41it/s]







 10%|████▎                                     | 51/500 [00:08<01:10,  6.36it/s]







 10%|████▎                                     | 52/500 [00:08<01:10,  6.37it/s]







 11%|████▍                                     | 53/500 [00:08<01:10,  6.33it/s]







 11%|████▌                                     | 54/500 [00:08<01:11,  6.27it/s]







 11%|████▌                                     | 55/500 [00:08<01:10,  6.30it/s]







 11%|████▋                                     | 56/500 [00:08<01:09,  6.36it/s]







 11%|████▊                                     | 57/500 [00:09<01:09,  6.36it/s]







 12%|████▊                                     | 58/500 [00:09<01:09,  6.39it/s]







 12%|████▉                                     | 59/500 [00:09<01:08,  6.41it/s]







 12%|█████                                     | 60/500 [00:09<01:08,  6.44it/s]







 12%|█████                                     | 61/500 [00:09<01:08,  6.44it/s]







 12%|█████▏                                    | 62/500 [00:09<01:07,  6.47it/s]







 13%|█████▎                                    | 63/500 [00:10<01:07,  6.46it/s]







 13%|█████▍                                    | 64/500 [00:10<01:07,  6.46it/s]







 13%|█████▍                                    | 65/500 [00:10<01:07,  6.45it/s]







 13%|█████▌                                    | 66/500 [00:10<01:07,  6.46it/s]







 13%|█████▋                                    | 67/500 [00:10<01:07,  6.42it/s]







 14%|█████▋                                    | 68/500 [00:10<01:07,  6.44it/s]







 14%|█████▊                                    | 69/500 [00:10<01:07,  6.42it/s]







 14%|█████▉                                    | 70/500 [00:11<01:06,  6.44it/s]







 14%|█████▉                                    | 71/500 [00:11<01:06,  6.44it/s]







 14%|██████                                    | 72/500 [00:11<01:06,  6.47it/s]







 15%|██████▏                                   | 73/500 [00:11<01:05,  6.48it/s]







 15%|██████▏                                   | 74/500 [00:11<01:05,  6.49it/s]







 15%|██████▎                                   | 75/500 [00:11<01:06,  6.39it/s]







 15%|██████▍                                   | 76/500 [00:12<01:05,  6.43it/s]







 15%|██████▍                                   | 77/500 [00:12<01:05,  6.43it/s]







 16%|██████▌                                   | 78/500 [00:12<01:05,  6.45it/s]







 16%|██████▋                                   | 79/500 [00:12<01:05,  6.42it/s]







 16%|██████▋                                   | 80/500 [00:12<01:05,  6.45it/s]







 16%|██████▊                                   | 81/500 [00:12<01:04,  6.46it/s]







 16%|██████▉                                   | 82/500 [00:13<01:05,  6.42it/s]







 17%|██████▉                                   | 83/500 [00:13<01:05,  6.40it/s]







 17%|███████                                   | 84/500 [00:13<01:04,  6.40it/s]







 17%|███████▏                                  | 85/500 [00:13<01:04,  6.42it/s]







 17%|███████▏                                  | 86/500 [00:13<01:04,  6.41it/s]







 17%|███████▎                                  | 87/500 [00:13<01:05,  6.31it/s]







 18%|███████▍                                  | 88/500 [00:13<01:05,  6.33it/s]







 18%|███████▍                                  | 89/500 [00:14<01:04,  6.36it/s]







 18%|███████▌                                  | 90/500 [00:14<01:03,  6.42it/s]







 18%|███████▋                                  | 91/500 [00:14<01:04,  6.31it/s]







 18%|███████▋                                  | 92/500 [00:14<01:05,  6.27it/s]







 19%|███████▊                                  | 93/500 [00:14<01:06,  6.15it/s]







 19%|███████▉                                  | 94/500 [00:14<01:07,  5.98it/s]







 19%|███████▉                                  | 95/500 [00:15<01:06,  6.09it/s]







 19%|████████                                  | 96/500 [00:15<01:04,  6.22it/s]







 19%|████████▏                                 | 97/500 [00:15<01:06,  6.10it/s]







 20%|████████▏                                 | 98/500 [00:15<01:04,  6.24it/s]







 20%|████████▎                                 | 99/500 [00:15<01:05,  6.10it/s]







 20%|████████▏                                | 100/500 [00:15<01:05,  6.08it/s]







 20%|████████▎                                | 101/500 [00:16<01:08,  5.87it/s]







 20%|████████▎                                | 102/500 [00:16<01:05,  6.04it/s]







 21%|████████▍                                | 103/500 [00:16<01:04,  6.11it/s]







 21%|████████▌                                | 104/500 [00:16<01:03,  6.23it/s]







 21%|████████▌                                | 105/500 [00:16<01:03,  6.24it/s]







 21%|████████▋                                | 106/500 [00:16<01:02,  6.30it/s]







 21%|████████▊                                | 107/500 [00:17<01:02,  6.31it/s]







 22%|████████▊                                | 108/500 [00:17<01:01,  6.37it/s]







 22%|████████▉                                | 109/500 [00:17<01:01,  6.39it/s]







 22%|█████████                                | 110/500 [00:17<01:00,  6.44it/s]







 22%|█████████                                | 111/500 [00:17<01:00,  6.42it/s]







 22%|█████████▏                               | 112/500 [00:17<01:00,  6.46it/s]







 23%|█████████▎                               | 113/500 [00:17<01:00,  6.44it/s]







 23%|█████████▎                               | 114/500 [00:18<00:59,  6.47it/s]







 23%|█████████▍                               | 115/500 [00:18<00:59,  6.46it/s]







 23%|█████████▌                               | 116/500 [00:18<00:59,  6.49it/s]







 23%|█████████▌                               | 117/500 [00:18<01:01,  6.27it/s]







 24%|█████████▋                               | 118/500 [00:18<01:02,  6.08it/s]







 24%|█████████▊                               | 119/500 [00:18<01:02,  6.12it/s]







 24%|█████████▊                               | 120/500 [00:19<01:01,  6.21it/s]







 24%|█████████▉                               | 121/500 [00:19<01:01,  6.18it/s]







 24%|██████████                               | 122/500 [00:19<01:00,  6.24it/s]







 25%|██████████                               | 123/500 [00:19<01:01,  6.15it/s]







 25%|██████████▏                              | 124/500 [00:19<01:00,  6.22it/s]







 25%|██████████▎                              | 125/500 [00:19<00:59,  6.26it/s]







 25%|██████████▎                              | 126/500 [00:20<01:00,  6.22it/s]







 25%|██████████▍                              | 127/500 [00:20<01:00,  6.19it/s]







 26%|██████████▍                              | 128/500 [00:20<00:59,  6.26it/s]







 26%|██████████▌                              | 129/500 [00:20<00:59,  6.23it/s]







 26%|██████████▋                              | 130/500 [00:20<00:59,  6.24it/s]







 26%|██████████▋                              | 131/500 [00:20<00:59,  6.23it/s]







 26%|██████████▊                              | 132/500 [00:21<00:58,  6.25it/s]







 27%|██████████▉                              | 133/500 [00:21<00:58,  6.30it/s]







 27%|██████████▉                              | 134/500 [00:21<00:57,  6.34it/s]







 27%|███████████                              | 135/500 [00:21<00:57,  6.35it/s]







 27%|███████████▏                             | 136/500 [00:21<00:57,  6.34it/s]







 27%|███████████▏                             | 137/500 [00:21<00:57,  6.35it/s]







 28%|███████████▎                             | 138/500 [00:21<00:56,  6.40it/s]







 28%|███████████▍                             | 139/500 [00:22<00:56,  6.38it/s]







 28%|███████████▍                             | 140/500 [00:22<00:56,  6.34it/s]







 28%|███████████▌                             | 141/500 [00:22<00:58,  6.13it/s]







 28%|███████████▋                             | 142/500 [00:22<00:58,  6.10it/s]







 29%|███████████▋                             | 143/500 [00:22<00:59,  6.01it/s]







 29%|███████████▊                             | 144/500 [00:22<00:59,  5.99it/s]







 29%|███████████▉                             | 145/500 [00:23<00:57,  6.12it/s]







 29%|███████████▉                             | 146/500 [00:23<00:56,  6.23it/s]







 29%|████████████                             | 147/500 [00:23<00:57,  6.09it/s]







 30%|████████████▏                            | 148/500 [00:23<01:01,  5.76it/s]







 30%|████████████▏                            | 149/500 [00:23<00:59,  5.94it/s]







 30%|████████████▎                            | 150/500 [00:23<00:57,  6.11it/s]







 30%|████████████▍                            | 151/500 [00:24<00:56,  6.20it/s]







 30%|████████████▍                            | 152/500 [00:24<00:55,  6.29it/s]







 31%|████████████▌                            | 153/500 [00:24<00:54,  6.31it/s]







 31%|████████████▋                            | 154/500 [00:24<00:54,  6.35it/s]







 31%|████████████▋                            | 155/500 [00:24<00:54,  6.33it/s]







 31%|████████████▊                            | 156/500 [00:24<00:54,  6.35it/s]







 31%|████████████▊                            | 157/500 [00:25<00:54,  6.33it/s]







 32%|████████████▉                            | 158/500 [00:25<00:53,  6.38it/s]







 32%|█████████████                            | 159/500 [00:25<00:53,  6.36it/s]







 32%|█████████████                            | 160/500 [00:25<00:53,  6.37it/s]







 32%|█████████████▏                           | 161/500 [00:25<00:53,  6.38it/s]







 32%|█████████████▎                           | 162/500 [00:25<00:52,  6.39it/s]







 33%|█████████████▎                           | 163/500 [00:25<00:53,  6.34it/s]







 33%|█████████████▍                           | 164/500 [00:26<00:52,  6.34it/s]







 33%|█████████████▌                           | 165/500 [00:26<00:52,  6.33it/s]







 33%|█████████████▌                           | 166/500 [00:26<00:52,  6.35it/s]







 33%|█████████████▋                           | 167/500 [00:26<00:52,  6.33it/s]







 34%|█████████████▊                           | 168/500 [00:26<00:52,  6.37it/s]







 34%|█████████████▊                           | 169/500 [00:26<00:52,  6.30it/s]







 34%|█████████████▉                           | 170/500 [00:27<00:51,  6.35it/s]







 34%|██████████████                           | 171/500 [00:27<00:51,  6.35it/s]







 34%|██████████████                           | 172/500 [00:27<00:51,  6.36it/s]







 35%|██████████████▏                          | 173/500 [00:27<00:51,  6.38it/s]







 35%|██████████████▎                          | 174/500 [00:27<00:51,  6.38it/s]







 35%|██████████████▎                          | 175/500 [00:27<00:51,  6.34it/s]







 35%|██████████████▍                          | 176/500 [00:28<00:50,  6.36it/s]







 35%|██████████████▌                          | 177/500 [00:28<00:50,  6.34it/s]







 36%|██████████████▌                          | 178/500 [00:28<00:50,  6.36it/s]







 36%|██████████████▋                          | 179/500 [00:28<00:50,  6.34it/s]







 36%|██████████████▊                          | 180/500 [00:28<00:50,  6.32it/s]







 36%|██████████████▊                          | 181/500 [00:28<00:50,  6.31it/s]







 36%|██████████████▉                          | 182/500 [00:28<00:50,  6.30it/s]







 37%|███████████████                          | 183/500 [00:29<00:50,  6.30it/s]







 37%|███████████████                          | 184/500 [00:29<00:49,  6.34it/s]







 37%|███████████████▏                         | 185/500 [00:29<00:50,  6.28it/s]







 37%|███████████████▎                         | 186/500 [00:29<00:49,  6.32it/s]







 37%|███████████████▎                         | 187/500 [00:29<00:50,  6.22it/s]







 38%|███████████████▍                         | 188/500 [00:29<00:49,  6.27it/s]







 38%|███████████████▍                         | 189/500 [00:30<00:49,  6.24it/s]







 38%|███████████████▌                         | 190/500 [00:30<00:49,  6.26it/s]







 38%|███████████████▋                         | 191/500 [00:30<00:51,  5.99it/s]







 38%|███████████████▋                         | 192/500 [00:30<00:50,  6.08it/s]







 39%|███████████████▊                         | 193/500 [00:30<00:50,  6.12it/s]







 39%|███████████████▉                         | 194/500 [00:30<00:49,  6.15it/s]







 39%|███████████████▉                         | 195/500 [00:31<00:49,  6.15it/s]







 39%|████████████████                         | 196/500 [00:31<00:48,  6.27it/s]







 39%|████████████████▏                        | 197/500 [00:31<00:48,  6.29it/s]







 40%|████████████████▏                        | 198/500 [00:31<00:47,  6.31it/s]







 40%|████████████████▎                        | 199/500 [00:31<00:47,  6.31it/s]







 40%|████████████████▍                        | 200/500 [00:31<00:47,  6.33it/s]







 40%|████████████████▍                        | 201/500 [00:32<00:47,  6.25it/s]







 40%|████████████████▌                        | 202/500 [00:32<00:47,  6.31it/s]







 41%|████████████████▋                        | 203/500 [00:32<00:46,  6.34it/s]







 41%|████████████████▋                        | 204/500 [00:32<00:46,  6.36it/s]







 41%|████████████████▊                        | 205/500 [00:32<00:46,  6.33it/s]







 41%|████████████████▉                        | 206/500 [00:32<00:46,  6.33it/s]







 41%|████████████████▉                        | 207/500 [00:32<00:46,  6.29it/s]







 42%|█████████████████                        | 208/500 [00:33<00:46,  6.32it/s]







 42%|█████████████████▏                       | 209/500 [00:33<00:45,  6.33it/s]







 42%|█████████████████▏                       | 210/500 [00:33<00:45,  6.35it/s]







 42%|█████████████████▎                       | 211/500 [00:33<00:45,  6.36it/s]







 42%|█████████████████▍                       | 212/500 [00:33<00:45,  6.38it/s]







 43%|█████████████████▍                       | 213/500 [00:33<00:45,  6.36it/s]







 43%|█████████████████▌                       | 214/500 [00:34<00:45,  6.35it/s]







 43%|█████████████████▋                       | 215/500 [00:34<00:45,  6.29it/s]







 43%|█████████████████▋                       | 216/500 [00:34<00:44,  6.33it/s]







 43%|█████████████████▊                       | 217/500 [00:34<00:44,  6.35it/s]







 44%|█████████████████▉                       | 218/500 [00:34<00:44,  6.32it/s]







 44%|█████████████████▉                       | 219/500 [00:34<00:44,  6.32it/s]







 44%|██████████████████                       | 220/500 [00:35<00:45,  6.18it/s]







 44%|██████████████████                       | 221/500 [00:35<00:44,  6.23it/s]







 44%|██████████████████▏                      | 222/500 [00:35<00:44,  6.31it/s]







 45%|██████████████████▎                      | 223/500 [00:35<00:44,  6.28it/s]







 45%|██████████████████▎                      | 224/500 [00:35<00:43,  6.32it/s]







 45%|██████████████████▍                      | 225/500 [00:35<00:43,  6.32it/s]







 45%|██████████████████▌                      | 226/500 [00:35<00:43,  6.35it/s]







 45%|██████████████████▌                      | 227/500 [00:36<00:43,  6.29it/s]







 46%|██████████████████▋                      | 228/500 [00:36<00:42,  6.35it/s]







 46%|██████████████████▊                      | 229/500 [00:36<00:42,  6.32it/s]







 46%|██████████████████▊                      | 230/500 [00:36<00:43,  6.27it/s]







 46%|██████████████████▉                      | 231/500 [00:36<00:42,  6.26it/s]







 46%|███████████████████                      | 232/500 [00:36<00:42,  6.30it/s]







 47%|███████████████████                      | 233/500 [00:37<00:42,  6.24it/s]







 47%|███████████████████▏                     | 234/500 [00:37<00:42,  6.30it/s]







 47%|███████████████████▎                     | 235/500 [00:37<00:42,  6.28it/s]







 47%|███████████████████▎                     | 236/500 [00:37<00:42,  6.23it/s]







 47%|███████████████████▍                     | 237/500 [00:37<00:41,  6.27it/s]







 48%|███████████████████▌                     | 238/500 [00:37<00:41,  6.34it/s]







 48%|███████████████████▌                     | 239/500 [00:38<00:42,  6.21it/s]







 48%|███████████████████▋                     | 240/500 [00:38<00:42,  6.15it/s]







 48%|███████████████████▊                     | 241/500 [00:38<00:42,  6.14it/s]







 48%|███████████████████▊                     | 242/500 [00:38<00:41,  6.15it/s]







 49%|███████████████████▉                     | 243/500 [00:38<00:42,  6.05it/s]







 49%|████████████████████                     | 244/500 [00:38<00:44,  5.71it/s]







 49%|████████████████████                     | 245/500 [00:39<00:43,  5.88it/s]







 49%|████████████████████▏                    | 246/500 [00:39<00:41,  6.05it/s]







 49%|████████████████████▎                    | 247/500 [00:39<00:41,  6.15it/s]







 50%|████████████████████▎                    | 248/500 [00:39<00:40,  6.20it/s]







 50%|████████████████████▍                    | 249/500 [00:39<00:40,  6.27it/s]







 50%|████████████████████▌                    | 250/500 [00:39<00:39,  6.29it/s]







 50%|████████████████████▌                    | 251/500 [00:40<00:39,  6.29it/s]







 50%|████████████████████▋                    | 252/500 [00:40<00:39,  6.34it/s]







 51%|████████████████████▋                    | 253/500 [00:40<00:38,  6.35it/s]







 51%|████████████████████▊                    | 254/500 [00:40<00:39,  6.23it/s]







 51%|████████████████████▉                    | 255/500 [00:40<00:39,  6.17it/s]







 51%|████████████████████▉                    | 256/500 [00:40<00:39,  6.26it/s]







 51%|█████████████████████                    | 257/500 [00:40<00:38,  6.29it/s]







 52%|█████████████████████▏                   | 258/500 [00:41<00:38,  6.35it/s]







 52%|█████████████████████▏                   | 259/500 [00:41<00:37,  6.36it/s]







 52%|█████████████████████▎                   | 260/500 [00:41<00:37,  6.39it/s]







 52%|█████████████████████▍                   | 261/500 [00:41<00:37,  6.31it/s]







 52%|█████████████████████▍                   | 262/500 [00:41<00:37,  6.36it/s]







 53%|█████████████████████▌                   | 263/500 [00:41<00:37,  6.29it/s]







 53%|█████████████████████▋                   | 264/500 [00:42<00:37,  6.28it/s]







 53%|█████████████████████▋                   | 265/500 [00:42<00:37,  6.29it/s]







 53%|█████████████████████▊                   | 266/500 [00:42<00:36,  6.37it/s]







 53%|█████████████████████▉                   | 267/500 [00:42<00:37,  6.29it/s]







 54%|█████████████████████▉                   | 268/500 [00:42<00:36,  6.32it/s]







 54%|██████████████████████                   | 269/500 [00:42<00:36,  6.31it/s]







 54%|██████████████████████▏                  | 270/500 [00:43<00:36,  6.37it/s]







 54%|██████████████████████▏                  | 271/500 [00:43<00:36,  6.34it/s]







 54%|██████████████████████▎                  | 272/500 [00:43<00:36,  6.22it/s]







 55%|██████████████████████▍                  | 273/500 [00:43<00:36,  6.28it/s]







 55%|██████████████████████▍                  | 274/500 [00:43<00:36,  6.21it/s]







 55%|██████████████████████▌                  | 275/500 [00:43<00:39,  5.75it/s]







 55%|██████████████████████▋                  | 276/500 [00:44<00:38,  5.80it/s]







 55%|██████████████████████▋                  | 277/500 [00:44<00:37,  5.99it/s]







 56%|██████████████████████▊                  | 278/500 [00:44<00:36,  6.12it/s]







 56%|██████████████████████▉                  | 279/500 [00:44<00:35,  6.24it/s]







 56%|██████████████████████▉                  | 280/500 [00:44<00:35,  6.23it/s]







 56%|███████████████████████                  | 281/500 [00:44<00:34,  6.27it/s]







 56%|███████████████████████                  | 282/500 [00:44<00:34,  6.30it/s]







 57%|███████████████████████▏                 | 283/500 [00:45<00:34,  6.29it/s]







 57%|███████████████████████▎                 | 284/500 [00:45<00:34,  6.25it/s]







 57%|███████████████████████▎                 | 285/500 [00:45<00:34,  6.32it/s]







 57%|███████████████████████▍                 | 286/500 [00:45<00:33,  6.33it/s]







 57%|███████████████████████▌                 | 287/500 [00:45<00:33,  6.34it/s]







 58%|███████████████████████▌                 | 288/500 [00:45<00:34,  6.09it/s]







 58%|███████████████████████▋                 | 289/500 [00:46<00:34,  6.06it/s]







 58%|███████████████████████▊                 | 290/500 [00:46<00:34,  6.16it/s]







 58%|███████████████████████▊                 | 291/500 [00:46<00:33,  6.25it/s]







 58%|███████████████████████▉                 | 292/500 [00:46<00:33,  6.25it/s]







 59%|████████████████████████                 | 293/500 [00:46<00:32,  6.28it/s]







 59%|████████████████████████                 | 294/500 [00:46<00:32,  6.31it/s]







 59%|████████████████████████▏                | 295/500 [00:47<00:32,  6.32it/s]







 59%|████████████████████████▎                | 296/500 [00:47<00:32,  6.35it/s]







 59%|████████████████████████▎                | 297/500 [00:47<00:31,  6.40it/s]







 60%|████████████████████████▍                | 298/500 [00:47<00:31,  6.41it/s]







 60%|████████████████████████▌                | 299/500 [00:47<00:31,  6.38it/s]







 60%|████████████████████████▌                | 300/500 [00:47<00:31,  6.39it/s]







 60%|████████████████████████▋                | 301/500 [00:47<00:31,  6.35it/s]







 60%|████████████████████████▊                | 302/500 [00:48<00:31,  6.32it/s]







 61%|████████████████████████▊                | 303/500 [00:48<00:31,  6.34it/s]







 61%|████████████████████████▉                | 304/500 [00:48<00:30,  6.38it/s]







 61%|█████████████████████████                | 305/500 [00:48<00:30,  6.40it/s]







 61%|█████████████████████████                | 306/500 [00:48<00:30,  6.40it/s]







 61%|█████████████████████████▏               | 307/500 [00:48<00:30,  6.34it/s]







 62%|█████████████████████████▎               | 308/500 [00:49<00:30,  6.32it/s]







 62%|█████████████████████████▎               | 309/500 [00:49<00:30,  6.32it/s]







 62%|█████████████████████████▍               | 310/500 [00:49<00:29,  6.34it/s]







 62%|█████████████████████████▌               | 311/500 [00:49<00:29,  6.34it/s]







 62%|█████████████████████████▌               | 312/500 [00:49<00:29,  6.36it/s]







 63%|█████████████████████████▋               | 313/500 [00:49<00:29,  6.40it/s]







 63%|█████████████████████████▋               | 314/500 [00:50<00:28,  6.42it/s]







 63%|█████████████████████████▊               | 315/500 [00:50<00:28,  6.44it/s]







 63%|█████████████████████████▉               | 316/500 [00:50<00:28,  6.44it/s]







 63%|█████████████████████████▉               | 317/500 [00:50<00:28,  6.46it/s]







 64%|██████████████████████████               | 318/500 [00:50<00:28,  6.37it/s]







 64%|██████████████████████████▏              | 319/500 [00:50<00:28,  6.36it/s]







 64%|██████████████████████████▏              | 320/500 [00:50<00:28,  6.35it/s]







 64%|██████████████████████████▎              | 321/500 [00:51<00:28,  6.38it/s]







 64%|██████████████████████████▍              | 322/500 [00:51<00:27,  6.37it/s]







 65%|██████████████████████████▍              | 323/500 [00:51<00:27,  6.39it/s]







 65%|██████████████████████████▌              | 324/500 [00:51<00:27,  6.39it/s]







 65%|██████████████████████████▋              | 325/500 [00:51<00:27,  6.40it/s]







 65%|██████████████████████████▋              | 326/500 [00:51<00:27,  6.36it/s]







 65%|██████████████████████████▊              | 327/500 [00:52<00:27,  6.34it/s]







 66%|██████████████████████████▉              | 328/500 [00:52<00:27,  6.34it/s]







 66%|██████████████████████████▉              | 329/500 [00:52<00:26,  6.35it/s]







 66%|███████████████████████████              | 330/500 [00:52<00:27,  6.28it/s]







 66%|███████████████████████████▏             | 331/500 [00:52<00:27,  6.25it/s]







 66%|███████████████████████████▏             | 332/500 [00:52<00:26,  6.29it/s]







 67%|███████████████████████████▎             | 333/500 [00:53<00:26,  6.34it/s]







 67%|███████████████████████████▍             | 334/500 [00:53<00:26,  6.32it/s]







 67%|███████████████████████████▍             | 335/500 [00:53<00:26,  6.34it/s]







 67%|███████████████████████████▌             | 336/500 [00:53<00:25,  6.36it/s]







 67%|███████████████████████████▋             | 337/500 [00:53<00:26,  6.20it/s]







 68%|███████████████████████████▋             | 338/500 [00:53<00:25,  6.24it/s]







 68%|███████████████████████████▊             | 339/500 [00:53<00:25,  6.29it/s]







 68%|███████████████████████████▉             | 340/500 [00:54<00:25,  6.33it/s]







 68%|███████████████████████████▉             | 341/500 [00:54<00:25,  6.15it/s]







 68%|████████████████████████████             | 342/500 [00:54<00:25,  6.17it/s]







 69%|████████████████████████████▏            | 343/500 [00:54<00:25,  6.15it/s]







 69%|████████████████████████████▏            | 344/500 [00:54<00:25,  6.18it/s]







 69%|████████████████████████████▎            | 345/500 [00:54<00:24,  6.24it/s]







 69%|████████████████████████████▎            | 346/500 [00:55<00:24,  6.19it/s]







 69%|████████████████████████████▍            | 347/500 [00:55<00:25,  6.08it/s]







 70%|████████████████████████████▌            | 348/500 [00:55<00:25,  5.86it/s]







 70%|████████████████████████████▌            | 349/500 [00:55<00:25,  5.99it/s]







 70%|████████████████████████████▋            | 350/500 [00:55<00:24,  6.07it/s]







 70%|████████████████████████████▊            | 351/500 [00:55<00:24,  6.07it/s]







 70%|████████████████████████████▊            | 352/500 [00:56<00:24,  5.95it/s]







 71%|████████████████████████████▉            | 353/500 [00:56<00:24,  5.91it/s]







 71%|█████████████████████████████            | 354/500 [00:56<00:24,  6.03it/s]







 71%|█████████████████████████████            | 355/500 [00:56<00:23,  6.06it/s]







 71%|█████████████████████████████▏           | 356/500 [00:56<00:23,  6.06it/s]







 71%|█████████████████████████████▎           | 357/500 [00:56<00:23,  6.03it/s]







 72%|█████████████████████████████▎           | 358/500 [00:57<00:24,  5.89it/s]







 72%|█████████████████████████████▍           | 359/500 [00:57<00:23,  5.93it/s]







 72%|█████████████████████████████▌           | 360/500 [00:57<00:23,  5.97it/s]







 72%|█████████████████████████████▌           | 361/500 [00:57<00:23,  5.95it/s]







 72%|█████████████████████████████▋           | 362/500 [00:57<00:23,  5.99it/s]







 73%|█████████████████████████████▊           | 363/500 [00:57<00:22,  6.00it/s]







 73%|█████████████████████████████▊           | 364/500 [00:58<00:22,  5.93it/s]







 73%|█████████████████████████████▉           | 365/500 [00:58<00:22,  5.99it/s]







 73%|██████████████████████████████           | 366/500 [00:58<00:22,  6.00it/s]







 73%|██████████████████████████████           | 367/500 [00:58<00:22,  5.95it/s]







 74%|██████████████████████████████▏          | 368/500 [00:58<00:22,  5.90it/s]







 74%|██████████████████████████████▎          | 369/500 [00:58<00:22,  5.90it/s]







 74%|██████████████████████████████▎          | 370/500 [00:59<00:21,  5.98it/s]







 74%|██████████████████████████████▍          | 371/500 [00:59<00:21,  6.04it/s]







 74%|██████████████████████████████▌          | 372/500 [00:59<00:21,  6.07it/s]







 75%|██████████████████████████████▌          | 373/500 [00:59<00:20,  6.08it/s]







 75%|██████████████████████████████▋          | 374/500 [00:59<00:20,  6.01it/s]







 75%|██████████████████████████████▊          | 375/500 [00:59<00:20,  6.01it/s]







 75%|██████████████████████████████▊          | 376/500 [01:00<00:20,  6.10it/s]







 75%|██████████████████████████████▉          | 377/500 [01:00<00:19,  6.18it/s]







 76%|██████████████████████████████▉          | 378/500 [01:00<00:19,  6.20it/s]







 76%|███████████████████████████████          | 379/500 [01:00<00:19,  6.24it/s]







 76%|███████████████████████████████▏         | 380/500 [01:00<00:19,  6.13it/s]







 76%|███████████████████████████████▏         | 381/500 [01:00<00:19,  6.04it/s]







 76%|███████████████████████████████▎         | 382/500 [01:01<00:19,  6.04it/s]







 77%|███████████████████████████████▍         | 383/500 [01:01<00:19,  6.13it/s]







 77%|███████████████████████████████▍         | 384/500 [01:01<00:18,  6.18it/s]







 77%|███████████████████████████████▌         | 385/500 [01:01<00:18,  6.24it/s]







 77%|███████████████████████████████▋         | 386/500 [01:01<00:18,  6.30it/s]







 77%|███████████████████████████████▋         | 387/500 [01:01<00:17,  6.29it/s]







 78%|███████████████████████████████▊         | 388/500 [01:02<00:17,  6.22it/s]







 78%|███████████████████████████████▉         | 389/500 [01:02<00:17,  6.29it/s]







 78%|███████████████████████████████▉         | 390/500 [01:02<00:17,  6.32it/s]







 78%|████████████████████████████████         | 391/500 [01:02<00:17,  6.37it/s]







 78%|████████████████████████████████▏        | 392/500 [01:02<00:16,  6.37it/s]







 79%|████████████████████████████████▏        | 393/500 [01:02<00:16,  6.35it/s]







 79%|████████████████████████████████▎        | 394/500 [01:02<00:16,  6.34it/s]







 79%|████████████████████████████████▍        | 395/500 [01:03<00:16,  6.36it/s]







 79%|████████████████████████████████▍        | 396/500 [01:03<00:16,  6.36it/s]







 79%|████████████████████████████████▌        | 397/500 [01:03<00:16,  6.38it/s]







 80%|████████████████████████████████▋        | 398/500 [01:03<00:15,  6.39it/s]







 80%|████████████████████████████████▋        | 399/500 [01:03<00:15,  6.41it/s]







 80%|████████████████████████████████▊        | 400/500 [01:03<00:16,  6.20it/s]







 80%|████████████████████████████████▉        | 401/500 [01:04<00:16,  6.15it/s]







 80%|████████████████████████████████▉        | 402/500 [01:04<00:16,  6.08it/s]







 81%|█████████████████████████████████        | 403/500 [01:04<00:16,  6.04it/s]







 81%|█████████████████████████████████▏       | 404/500 [01:04<00:15,  6.06it/s]







 81%|█████████████████████████████████▏       | 405/500 [01:04<00:15,  6.09it/s]







 81%|█████████████████████████████████▎       | 406/500 [01:04<00:15,  5.93it/s]







 81%|█████████████████████████████████▎       | 407/500 [01:05<00:15,  6.02it/s]







 82%|█████████████████████████████████▍       | 408/500 [01:05<00:15,  6.11it/s]







 82%|█████████████████████████████████▌       | 409/500 [01:05<00:14,  6.22it/s]







 82%|█████████████████████████████████▌       | 410/500 [01:05<00:14,  6.26it/s]







 82%|█████████████████████████████████▋       | 411/500 [01:05<00:14,  6.31it/s]







 82%|█████████████████████████████████▊       | 412/500 [01:05<00:14,  6.20it/s]







 83%|█████████████████████████████████▊       | 413/500 [01:06<00:13,  6.24it/s]







 83%|█████████████████████████████████▉       | 414/500 [01:06<00:13,  6.20it/s]







 83%|██████████████████████████████████       | 415/500 [01:06<00:13,  6.29it/s]







 83%|██████████████████████████████████       | 416/500 [01:06<00:13,  6.32it/s]







 83%|██████████████████████████████████▏      | 417/500 [01:06<00:13,  6.28it/s]







 84%|██████████████████████████████████▎      | 418/500 [01:06<00:13,  6.21it/s]







 84%|██████████████████████████████████▎      | 419/500 [01:07<00:12,  6.29it/s]







 84%|██████████████████████████████████▍      | 420/500 [01:07<00:12,  6.31it/s]







 84%|██████████████████████████████████▌      | 421/500 [01:07<00:12,  6.34it/s]







 84%|██████████████████████████████████▌      | 422/500 [01:07<00:12,  6.29it/s]







 85%|██████████████████████████████████▋      | 423/500 [01:07<00:12,  6.23it/s]







 85%|██████████████████████████████████▊      | 424/500 [01:07<00:12,  6.24it/s]







 85%|██████████████████████████████████▊      | 425/500 [01:07<00:12,  6.19it/s]







 85%|██████████████████████████████████▉      | 426/500 [01:08<00:12,  6.11it/s]







 85%|███████████████████████████████████      | 427/500 [01:08<00:11,  6.11it/s]







 86%|███████████████████████████████████      | 428/500 [01:08<00:12,  5.95it/s]







 86%|███████████████████████████████████▏     | 429/500 [01:08<00:11,  5.94it/s]







 86%|███████████████████████████████████▎     | 430/500 [01:08<00:11,  5.96it/s]







 86%|███████████████████████████████████▎     | 431/500 [01:08<00:11,  5.95it/s]







 86%|███████████████████████████████████▍     | 432/500 [01:09<00:11,  5.96it/s]







 87%|███████████████████████████████████▌     | 433/500 [01:09<00:11,  6.01it/s]







 87%|███████████████████████████████████▌     | 434/500 [01:09<00:11,  5.98it/s]







 87%|███████████████████████████████████▋     | 435/500 [01:09<00:10,  5.96it/s]







 87%|███████████████████████████████████▊     | 436/500 [01:09<00:10,  5.93it/s]







 87%|███████████████████████████████████▊     | 437/500 [01:10<00:10,  5.95it/s]







 88%|███████████████████████████████████▉     | 438/500 [01:10<00:10,  5.99it/s]







 88%|███████████████████████████████████▉     | 439/500 [01:10<00:09,  6.10it/s]







 88%|████████████████████████████████████     | 440/500 [01:10<00:09,  6.13it/s]







 88%|████████████████████████████████████▏    | 441/500 [01:10<00:09,  6.13it/s]







 88%|████████████████████████████████████▏    | 442/500 [01:10<00:09,  6.16it/s]







 89%|████████████████████████████████████▎    | 443/500 [01:10<00:09,  6.18it/s]







 89%|████████████████████████████████████▍    | 444/500 [01:11<00:09,  6.22it/s]







 89%|████████████████████████████████████▍    | 445/500 [01:11<00:08,  6.25it/s]







 89%|████████████████████████████████████▌    | 446/500 [01:11<00:08,  6.26it/s]







 89%|████████████████████████████████████▋    | 447/500 [01:11<00:08,  6.29it/s]







 90%|████████████████████████████████████▋    | 448/500 [01:11<00:08,  6.30it/s]







 90%|████████████████████████████████████▊    | 449/500 [01:11<00:08,  6.25it/s]







 90%|████████████████████████████████████▉    | 450/500 [01:12<00:08,  6.22it/s]['transistor', 0.9904166666666667, 0.9555857343695694, 0.9158343354598812]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Training model 10/10 for zipper









| feature extraction | train | zipper |:   0%|            | 0/8 [00:00<?, ?it/s]/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/paddle/tensor/creation.py:130: DeprecationWarning: `np.object` is a deprecated alias for the builtin `object`. To silence this warning, use `object` by itself. Doing this will not modify any behavior and is safe. 
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  if data.dtype == np.object:









| feature extraction | train | zipper |:  12%|▌   | 1/8 [00:00<00:04,  1.58it/s]








| feature extraction | train | zipper |:  25%|█   | 2/8 [00:01<00:03,  1.59it/s]








| feature extraction | train | zipper |:  38%|█▌  | 3/8 [00:01<00:03,  1.60it/s]








| feature extraction | train | zipper |:  50%|██  | 4/8 [00:02<00:02,  1.61it/s]








| feature extraction | train | zipper |:  62%|██▌ | 5/8 [00:03<00:01,  1.62it/s]








| feature extraction | train | zipper |:  75%|███ | 6/8 [00:03<00:01,  1.60it/s]








| feature extraction | train | zipper |:  88%|███▌| 7/8 [00:04<00:00,  1.61it/s]








| feature extraction | train | zipper |: 100%|████| 8/8 [00:04<00:00,  1.71it/s]
Creating CoreSet Sampler via k-Center Greedy
Getting the coreset from the main embedding.
Assigning the coreset as the memory bank with shape [24576, 384].
2022-04-22 18:18:40	Train ends, total 85.30s
Saving model...
2022-04-22 18:18:41	Save model in ./output/coreset_resnet18_10/zipper.pdparams
2022-04-22 18:18:41	Starting eval model...









| feature extraction | test | zipper |:   0%|           | 0/151 [00:00<?, ?it/s]








| feature extraction | test | zipper |:   1%|   | 1/151 [00:00<00:48,  3.08it/s]








| feature extraction | test | zipper |:   1%|   | 2/151 [00:00<00:46,  3.19it/s]








| feature extraction | test | zipper |:   2%|   | 3/151 [00:00<00:45,  3.27it/s]








| feature extraction | test | zipper |:   3%|   | 4/151 [00:01<00:44,  3.33it/s]








| feature extraction | test | zipper |:   3%|   | 5/151 [00:01<00:43,  3.37it/s]








| feature extraction | test | zipper |:   4%|   | 6/151 [00:01<00:42,  3.41it/s]








| feature extraction | test | zipper |:   5%|▏  | 7/151 [00:02<00:41,  3.43it/s]








| feature extraction | test | zipper |:   5%|▏  | 8/151 [00:02<00:41,  3.45it/s]








| feature extraction | test | zipper |:   6%|▏  | 9/151 [00:02<00:41,  3.44it/s]








| feature extraction | test | zipper |:   7%|▏ | 10/151 [00:02<00:40,  3.46it/s]








| feature extraction | test | zipper |:   7%|▏ | 11/151 [00:03<00:40,  3.46it/s]








| feature extraction | test | zipper |:   8%|▏ | 12/151 [00:03<00:40,  3.47it/s]








| feature extraction | test | zipper |:   9%|▏ | 13/151 [00:03<00:39,  3.47it/s]








| feature extraction | test | zipper |:   9%|▏ | 14/151 [00:04<00:39,  3.48it/s]








| feature extraction | test | zipper |:  10%|▏ | 15/151 [00:04<00:39,  3.48it/s]








| feature extraction | test | zipper |:  11%|▏ | 16/151 [00:04<00:38,  3.48it/s]








| feature extraction | test | zipper |:  11%|▏ | 17/151 [00:04<00:38,  3.48it/s]








| feature extraction | test | zipper |:  12%|▏ | 18/151 [00:05<00:38,  3.48it/s]








| feature extraction | test | zipper |:  13%|▎ | 19/151 [00:05<00:37,  3.48it/s]








| feature extraction | test | zipper |:  13%|▎ | 20/151 [00:05<00:37,  3.49it/s]








| feature extraction | test | zipper |:  14%|▎ | 21/151 [00:06<00:37,  3.49it/s]








| feature extraction | test | zipper |:  15%|▎ | 22/151 [00:06<00:37,  3.48it/s]








| feature extraction | test | zipper |:  15%|▎ | 23/151 [00:06<00:36,  3.48it/s]








| feature extraction | test | zipper |:  16%|▎ | 24/151 [00:06<00:36,  3.49it/s]








| feature extraction | test | zipper |:  17%|▎ | 25/151 [00:07<00:36,  3.48it/s]








| feature extraction | test | zipper |:  17%|▎ | 26/151 [00:07<00:35,  3.48it/s]








| feature extraction | test | zipper |:  18%|▎ | 27/151 [00:07<00:35,  3.49it/s]








| feature extraction | test | zipper |:  19%|▎ | 28/151 [00:08<00:35,  3.49it/s]








| feature extraction | test | zipper |:  19%|▍ | 29/151 [00:08<00:35,  3.47it/s]








| feature extraction | test | zipper |:  20%|▍ | 30/151 [00:08<00:34,  3.48it/s]








| feature extraction | test | zipper |:  21%|▍ | 31/151 [00:08<00:34,  3.48it/s]








| feature extraction | test | zipper |:  21%|▍ | 32/151 [00:09<00:34,  3.49it/s]








| feature extraction | test | zipper |:  22%|▍ | 33/151 [00:09<00:33,  3.48it/s]








| feature extraction | test | zipper |:  23%|▍ | 34/151 [00:09<00:33,  3.49it/s]








| feature extraction | test | zipper |:  23%|▍ | 35/151 [00:10<00:33,  3.49it/s]








| feature extraction | test | zipper |:  24%|▍ | 36/151 [00:10<00:32,  3.49it/s]








| feature extraction | test | zipper |:  25%|▍ | 37/151 [00:10<00:32,  3.48it/s]








| feature extraction | test | zipper |:  25%|▌ | 38/151 [00:10<00:32,  3.48it/s]








| feature extraction | test | zipper |:  26%|▌ | 39/151 [00:11<00:32,  3.40it/s]








| feature extraction | test | zipper |:  26%|▌ | 40/151 [00:11<00:33,  3.33it/s]








| feature extraction | test | zipper |:  27%|▌ | 41/151 [00:11<00:33,  3.24it/s]








| feature extraction | test | zipper |:  28%|▌ | 42/151 [00:12<00:32,  3.31it/s]








| feature extraction | test | zipper |:  28%|▌ | 43/151 [00:12<00:32,  3.35it/s]








| feature extraction | test | zipper |:  29%|▌ | 44/151 [00:12<00:31,  3.39it/s]








| feature extraction | test | zipper |:  30%|▌ | 45/151 [00:13<00:31,  3.41it/s]








| feature extraction | test | zipper |:  30%|▌ | 46/151 [00:13<00:30,  3.43it/s]








| feature extraction | test | zipper |:  31%|▌ | 47/151 [00:13<00:30,  3.44it/s]








| feature extraction | test | zipper |:  32%|▋ | 48/151 [00:13<00:29,  3.46it/s]








| feature extraction | test | zipper |:  32%|▋ | 49/151 [00:14<00:29,  3.46it/s]








| feature extraction | test | zipper |:  33%|▋ | 50/151 [00:14<00:29,  3.47it/s]








| feature extraction | test | zipper |:  34%|▋ | 51/151 [00:14<00:28,  3.47it/s]








| feature extraction | test | zipper |:  34%|▋ | 52/151 [00:15<00:28,  3.47it/s]








| feature extraction | test | zipper |:  35%|▋ | 53/151 [00:15<00:28,  3.47it/s]








| feature extraction | test | zipper |:  36%|▋ | 54/151 [00:15<00:27,  3.48it/s]








| feature extraction | test | zipper |:  36%|▋ | 55/151 [00:15<00:27,  3.48it/s]








| feature extraction | test | zipper |:  37%|▋ | 56/151 [00:16<00:27,  3.48it/s]








| feature extraction | test | zipper |:  38%|▊ | 57/151 [00:16<00:27,  3.48it/s]








| feature extraction | test | zipper |:  38%|▊ | 58/151 [00:16<00:26,  3.48it/s]








| feature extraction | test | zipper |:  39%|▊ | 59/151 [00:17<00:26,  3.48it/s]








| feature extraction | test | zipper |:  40%|▊ | 60/151 [00:17<00:26,  3.48it/s]








| feature extraction | test | zipper |:  40%|▊ | 61/151 [00:17<00:25,  3.48it/s]








| feature extraction | test | zipper |:  41%|▊ | 62/151 [00:17<00:25,  3.48it/s]








| feature extraction | test | zipper |:  42%|▊ | 63/151 [00:18<00:25,  3.48it/s]








| feature extraction | test | zipper |:  42%|▊ | 64/151 [00:18<00:24,  3.48it/s]








| feature extraction | test | zipper |:  43%|▊ | 65/151 [00:18<00:24,  3.49it/s]








| feature extraction | test | zipper |:  44%|▊ | 66/151 [00:19<00:24,  3.49it/s]








| feature extraction | test | zipper |:  44%|▉ | 67/151 [00:19<00:24,  3.49it/s]








| feature extraction | test | zipper |:  45%|▉ | 68/151 [00:19<00:23,  3.50it/s]








| feature extraction | test | zipper |:  46%|▉ | 69/151 [00:19<00:23,  3.50it/s]








| feature extraction | test | zipper |:  46%|▉ | 70/151 [00:20<00:23,  3.50it/s]








| feature extraction | test | zipper |:  47%|▉ | 71/151 [00:20<00:22,  3.49it/s]








| feature extraction | test | zipper |:  48%|▉ | 72/151 [00:20<00:22,  3.49it/s]








| feature extraction | test | zipper |:  48%|▉ | 73/151 [00:21<00:22,  3.49it/s]








| feature extraction | test | zipper |:  49%|▉ | 74/151 [00:21<00:22,  3.49it/s]








| feature extraction | test | zipper |:  50%|▉ | 75/151 [00:21<00:21,  3.50it/s]








| feature extraction | test | zipper |:  50%|█ | 76/151 [00:21<00:21,  3.50it/s]








| feature extraction | test | zipper |:  51%|█ | 77/151 [00:22<00:21,  3.50it/s]








| feature extraction | test | zipper |:  52%|█ | 78/151 [00:22<00:20,  3.50it/s]








| feature extraction | test | zipper |:  52%|█ | 79/151 [00:22<00:20,  3.49it/s]








| feature extraction | test | zipper |:  53%|█ | 80/151 [00:23<00:20,  3.49it/s]








| feature extraction | test | zipper |:  54%|█ | 81/151 [00:23<00:20,  3.49it/s]








| feature extraction | test | zipper |:  54%|█ | 82/151 [00:23<00:19,  3.49it/s]








| feature extraction | test | zipper |:  55%|█ | 83/151 [00:23<00:19,  3.49it/s]








| feature extraction | test | zipper |:  56%|█ | 84/151 [00:24<00:19,  3.48it/s]








| feature extraction | test | zipper |:  56%|█▏| 85/151 [00:24<00:18,  3.48it/s]








| feature extraction | test | zipper |:  57%|█▏| 86/151 [00:24<00:18,  3.48it/s]








| feature extraction | test | zipper |:  58%|█▏| 87/151 [00:25<00:18,  3.49it/s]








| feature extraction | test | zipper |:  58%|█▏| 88/151 [00:25<00:18,  3.49it/s]








| feature extraction | test | zipper |:  59%|█▏| 89/151 [00:25<00:17,  3.49it/s]








| feature extraction | test | zipper |:  60%|█▏| 90/151 [00:25<00:17,  3.49it/s]








| feature extraction | test | zipper |:  60%|█▏| 91/151 [00:26<00:17,  3.49it/s]








| feature extraction | test | zipper |:  61%|█▏| 92/151 [00:26<00:16,  3.49it/s]








| feature extraction | test | zipper |:  62%|█▏| 93/151 [00:26<00:16,  3.50it/s]








| feature extraction | test | zipper |:  62%|█▏| 94/151 [00:27<00:16,  3.50it/s]








| feature extraction | test | zipper |:  63%|█▎| 95/151 [00:27<00:15,  3.50it/s]








| feature extraction | test | zipper |:  64%|█▎| 96/151 [00:27<00:15,  3.50it/s]








| feature extraction | test | zipper |:  64%|█▎| 97/151 [00:27<00:15,  3.50it/s]








| feature extraction | test | zipper |:  65%|█▎| 98/151 [00:28<00:15,  3.49it/s]








| feature extraction | test | zipper |:  66%|█▎| 99/151 [00:28<00:14,  3.48it/s]








| feature extraction | test | zipper |:  66%|▋| 100/151 [00:28<00:14,  3.49it/s]








| feature extraction | test | zipper |:  67%|▋| 101/151 [00:29<00:14,  3.48it/s]








| feature extraction | test | zipper |:  68%|▋| 102/151 [00:29<00:14,  3.49it/s]








| feature extraction | test | zipper |:  68%|▋| 103/151 [00:29<00:13,  3.48it/s]








| feature extraction | test | zipper |:  69%|▋| 104/151 [00:29<00:13,  3.49it/s]








| feature extraction | test | zipper |:  70%|▋| 105/151 [00:30<00:13,  3.49it/s]








| feature extraction | test | zipper |:  70%|▋| 106/151 [00:30<00:12,  3.49it/s]








| feature extraction | test | zipper |:  71%|▋| 107/151 [00:30<00:12,  3.49it/s]








| feature extraction | test | zipper |:  72%|▋| 108/151 [00:31<00:12,  3.49it/s]








| feature extraction | test | zipper |:  72%|▋| 109/151 [00:31<00:12,  3.48it/s]








| feature extraction | test | zipper |:  73%|▋| 110/151 [00:31<00:11,  3.49it/s]








| feature extraction | test | zipper |:  74%|▋| 111/151 [00:31<00:11,  3.48it/s]








| feature extraction | test | zipper |:  74%|▋| 112/151 [00:32<00:11,  3.48it/s]








| feature extraction | test | zipper |:  75%|▋| 113/151 [00:32<00:11,  3.42it/s]








| feature extraction | test | zipper |:  75%|▊| 114/151 [00:32<00:10,  3.43it/s]








| feature extraction | test | zipper |:  76%|▊| 115/151 [00:33<00:10,  3.44it/s]








| feature extraction | test | zipper |:  77%|▊| 116/151 [00:33<00:10,  3.45it/s]








| feature extraction | test | zipper |:  77%|▊| 117/151 [00:33<00:09,  3.45it/s]








| feature extraction | test | zipper |:  78%|▊| 118/151 [00:34<00:09,  3.46it/s]








| feature extraction | test | zipper |:  79%|▊| 119/151 [00:34<00:09,  3.47it/s]








| feature extraction | test | zipper |:  79%|▊| 120/151 [00:34<00:08,  3.47it/s]








| feature extraction | test | zipper |:  80%|▊| 121/151 [00:34<00:08,  3.47it/s]








| feature extraction | test | zipper |:  81%|▊| 122/151 [00:35<00:08,  3.47it/s]








| feature extraction | test | zipper |:  81%|▊| 123/151 [00:35<00:08,  3.47it/s]








| feature extraction | test | zipper |:  82%|▊| 124/151 [00:35<00:07,  3.48it/s]








| feature extraction | test | zipper |:  83%|▊| 125/151 [00:36<00:07,  3.48it/s]








| feature extraction | test | zipper |:  83%|▊| 126/151 [00:36<00:07,  3.47it/s]








| feature extraction | test | zipper |:  84%|▊| 127/151 [00:36<00:06,  3.47it/s]








| feature extraction | test | zipper |:  85%|▊| 128/151 [00:36<00:06,  3.48it/s]








| feature extraction | test | zipper |:  85%|▊| 129/151 [00:37<00:06,  3.48it/s]








| feature extraction | test | zipper |:  86%|▊| 130/151 [00:37<00:06,  3.48it/s]








| feature extraction | test | zipper |:  87%|▊| 131/151 [00:37<00:05,  3.48it/s]








| feature extraction | test | zipper |:  87%|▊| 132/151 [00:38<00:05,  3.49it/s]








| feature extraction | test | zipper |:  88%|▉| 133/151 [00:38<00:05,  3.48it/s]








| feature extraction | test | zipper |:  89%|▉| 134/151 [00:38<00:04,  3.49it/s]








| feature extraction | test | zipper |:  89%|▉| 135/151 [00:38<00:04,  3.49it/s]








| feature extraction | test | zipper |:  90%|▉| 136/151 [00:39<00:04,  3.49it/s]








| feature extraction | test | zipper |:  91%|▉| 137/151 [00:39<00:04,  3.48it/s]








| feature extraction | test | zipper |:  91%|▉| 138/151 [00:39<00:03,  3.49it/s]








| feature extraction | test | zipper |:  92%|▉| 139/151 [00:40<00:03,  3.49it/s]








| feature extraction | test | zipper |:  93%|▉| 140/151 [00:40<00:03,  3.49it/s]








| feature extraction | test | zipper |:  93%|▉| 141/151 [00:40<00:02,  3.49it/s]








| feature extraction | test | zipper |:  94%|▉| 142/151 [00:40<00:02,  3.49it/s]








| feature extraction | test | zipper |:  95%|▉| 143/151 [00:41<00:02,  3.49it/s]








| feature extraction | test | zipper |:  95%|▉| 144/151 [00:41<00:02,  3.50it/s]








| feature extraction | test | zipper |:  96%|▉| 145/151 [00:41<00:01,  3.49it/s]








| feature extraction | test | zipper |:  97%|▉| 146/151 [00:42<00:01,  3.49it/s]








| feature extraction | test | zipper |:  97%|▉| 147/151 [00:42<00:01,  3.48it/s]








| feature extraction | test | zipper |:  98%|▉| 148/151 [00:42<00:00,  3.49it/s]








| feature extraction | test | zipper |:  99%|▉| 149/151 [00:42<00:00,  3.50it/s]








| feature extraction | test | zipper |:  99%|▉| 150/151 [00:43<00:00,  3.50it/s]








| feature extraction | test | zipper |: 100%|█| 151/151 [00:43<00:00,  3.47it/s]
max_score:3.3583900928497314 min_score:0.24154578149318695
F1 image:0.9874476987447698 threshold:3.3583900928497314
F1 pixel:0.5939681321492527 threshold:3.3583900928497314









  0%|                                                   | 0/500 [00:00<?, ?it/s]








  0%|                                           | 1/500 [00:00<01:58,  4.22it/s]








  0%|▏                                          | 2/500 [00:00<01:56,  4.28it/s]








  1%|▎                                          | 3/500 [00:00<01:54,  4.34it/s]








  1%|▎                                          | 4/500 [00:00<01:53,  4.38it/s]








  1%|▍                                          | 5/500 [00:01<01:52,  4.41it/s]








  1%|▌                                          | 6/500 [00:01<01:51,  4.42it/s]








  1%|▌                                          | 7/500 [00:01<01:51,  4.44it/s]








  2%|▋                                          | 8/500 [00:01<01:50,  4.45it/s]








  2%|▊                                          | 9/500 [00:02<01:50,  4.45it/s]








  2%|▊                                         | 10/500 [00:02<01:50,  4.44it/s]








  2%|▉                                         | 11/500 [00:02<01:50,  4.43it/s]








  2%|█                                         | 12/500 [00:02<01:50,  4.42it/s]








  3%|█                                         | 13/500 [00:02<01:53,  4.30it/s]








  3%|█▏                                        | 14/500 [00:03<01:55,  4.23it/s]








  3%|█▎                                        | 15/500 [00:03<01:54,  4.24it/s]








  3%|█▎                                        | 16/500 [00:03<01:53,  4.28it/s]








  3%|█▍                                        | 17/500 [00:03<01:51,  4.34it/s]








  4%|█▌                                        | 18/500 [00:04<01:50,  4.37it/s]








  4%|█▌                                        | 19/500 [00:04<01:49,  4.40it/s]








  4%|█▋                                        | 20/500 [00:04<01:48,  4.42it/s]








  4%|█▊                                        | 21/500 [00:04<01:47,  4.44it/s]








  4%|█▊                                        | 22/500 [00:05<01:47,  4.44it/s]








  5%|█▉                                        | 23/500 [00:05<01:47,  4.43it/s]








  5%|██                                        | 24/500 [00:05<01:47,  4.44it/s]








  5%|██                                        | 25/500 [00:05<01:46,  4.45it/s]








  5%|██▏                                       | 26/500 [00:05<01:46,  4.44it/s]








  5%|██▎                                       | 27/500 [00:06<01:46,  4.45it/s]








  6%|██▎                                       | 28/500 [00:06<01:45,  4.45it/s]








  6%|██▍                                       | 29/500 [00:06<01:45,  4.46it/s]








  6%|██▌                                       | 30/500 [00:06<01:45,  4.46it/s]








  6%|██▌                                       | 31/500 [00:07<01:45,  4.46it/s]








  6%|██▋                                       | 32/500 [00:07<01:45,  4.42it/s]








  7%|██▊                                       | 33/500 [00:07<01:44,  4.45it/s]








  7%|██▊                                       | 34/500 [00:07<01:44,  4.45it/s]








  7%|██▉                                       | 35/500 [00:07<01:44,  4.45it/s]








  7%|███                                       | 36/500 [00:08<01:44,  4.46it/s]








  7%|███                                       | 37/500 [00:08<01:43,  4.46it/s]








  8%|███▏                                      | 38/500 [00:08<01:43,  4.47it/s]








  8%|███▎                                      | 39/500 [00:08<01:43,  4.47it/s]








  8%|███▎                                      | 40/500 [00:09<01:42,  4.47it/s]








  8%|███▍                                      | 41/500 [00:09<01:42,  4.47it/s]








  8%|███▌                                      | 42/500 [00:09<01:42,  4.46it/s]








  9%|███▌                                      | 43/500 [00:09<01:42,  4.46it/s]








  9%|███▋                                      | 44/500 [00:09<01:42,  4.45it/s]








  9%|███▊                                      | 45/500 [00:10<01:42,  4.46it/s]








  9%|███▊                                      | 46/500 [00:10<01:41,  4.46it/s]








  9%|███▉                                      | 47/500 [00:10<01:41,  4.46it/s]








 10%|████                                      | 48/500 [00:10<01:41,  4.45it/s]








 10%|████                                      | 49/500 [00:11<01:41,  4.46it/s]








 10%|████▏                                     | 50/500 [00:11<01:40,  4.46it/s]








 10%|████▎                                     | 51/500 [00:11<01:40,  4.47it/s]








 10%|████▎                                     | 52/500 [00:11<01:40,  4.47it/s]








 11%|████▍                                     | 53/500 [00:11<01:40,  4.46it/s]








 11%|████▌                                     | 54/500 [00:12<01:40,  4.44it/s]








 11%|████▌                                     | 55/500 [00:12<01:40,  4.43it/s]








 11%|████▋                                     | 56/500 [00:12<01:40,  4.43it/s]








 11%|████▊                                     | 57/500 [00:12<01:39,  4.43it/s]








 12%|████▊                                     | 58/500 [00:13<01:39,  4.44it/s]








 12%|████▉                                     | 59/500 [00:13<01:39,  4.44it/s]








 12%|█████                                     | 60/500 [00:13<01:39,  4.43it/s]








 12%|█████                                     | 61/500 [00:13<01:39,  4.43it/s]








 12%|█████▏                                    | 62/500 [00:13<01:38,  4.43it/s]








 13%|█████▎                                    | 63/500 [00:14<01:38,  4.44it/s]








 13%|█████▍                                    | 64/500 [00:14<01:38,  4.43it/s]








 13%|█████▍                                    | 65/500 [00:14<01:38,  4.44it/s]








 13%|█████▌                                    | 66/500 [00:14<01:37,  4.44it/s]








 13%|█████▋                                    | 67/500 [00:15<01:37,  4.44it/s]








 14%|█████▋                                    | 68/500 [00:15<01:37,  4.44it/s]








 14%|█████▊                                    | 69/500 [00:15<01:36,  4.45it/s]








 14%|█████▉                                    | 70/500 [00:15<01:36,  4.44it/s]








 14%|█████▉                                    | 71/500 [00:16<01:36,  4.44it/s]








 14%|██████                                    | 72/500 [00:16<01:36,  4.44it/s]








 15%|██████▏                                   | 73/500 [00:16<01:35,  4.46it/s]








 15%|██████▏                                   | 74/500 [00:16<01:35,  4.45it/s]








 15%|██████▎                                   | 75/500 [00:16<01:35,  4.47it/s]








 15%|██████▍                                   | 76/500 [00:17<01:34,  4.47it/s]








 15%|██████▍                                   | 77/500 [00:17<01:34,  4.48it/s]








 16%|██████▌                                   | 78/500 [00:17<01:34,  4.46it/s]








 16%|██████▋                                   | 79/500 [00:17<01:34,  4.47it/s]








 16%|██████▋                                   | 80/500 [00:18<01:33,  4.47it/s]








 16%|██████▊                                   | 81/500 [00:18<01:33,  4.47it/s]








 16%|██████▉                                   | 82/500 [00:18<01:33,  4.47it/s]








 17%|██████▉                                   | 83/500 [00:18<01:33,  4.47it/s]








 17%|███████                                   | 84/500 [00:18<01:33,  4.46it/s]








 17%|███████▏                                  | 85/500 [00:19<01:32,  4.47it/s]








 17%|███████▏                                  | 86/500 [00:19<01:32,  4.47it/s]








 17%|███████▎                                  | 87/500 [00:19<01:32,  4.47it/s]








 18%|███████▍                                  | 88/500 [00:19<01:32,  4.47it/s]








 18%|███████▍                                  | 89/500 [00:20<01:32,  4.46it/s]








 18%|███████▌                                  | 90/500 [00:20<01:31,  4.46it/s]








 18%|███████▋                                  | 91/500 [00:20<01:31,  4.46it/s]








 18%|███████▋                                  | 92/500 [00:20<01:31,  4.46it/s]








 19%|███████▊                                  | 93/500 [00:20<01:31,  4.45it/s]








 19%|███████▉                                  | 94/500 [00:21<01:31,  4.44it/s]








 19%|███████▉                                  | 95/500 [00:21<01:31,  4.44it/s]








 19%|████████                                  | 96/500 [00:21<01:32,  4.37it/s]








 19%|████████▏                                 | 97/500 [00:21<01:31,  4.40it/s]








 20%|████████▏                                 | 98/500 [00:22<01:31,  4.40it/s]








 20%|████████▎                                 | 99/500 [00:22<01:30,  4.41it/s]








 20%|████████▏                                | 100/500 [00:22<01:30,  4.42it/s]








 20%|████████▎                                | 101/500 [00:22<01:30,  4.42it/s]








 20%|████████▎                                | 102/500 [00:22<01:30,  4.42it/s]








 21%|████████▍                                | 103/500 [00:23<01:29,  4.42it/s]








 21%|████████▌                                | 104/500 [00:23<01:29,  4.41it/s]








 21%|████████▌                                | 105/500 [00:23<01:31,  4.33it/s]








 21%|████████▋                                | 106/500 [00:23<01:32,  4.25it/s]








 21%|████████▊                                | 107/500 [00:24<01:33,  4.21it/s]








 22%|████████▊                                | 108/500 [00:24<01:33,  4.19it/s]








 22%|████████▉                                | 109/500 [00:24<01:32,  4.25it/s]








 22%|█████████                                | 110/500 [00:24<01:30,  4.30it/s]








 22%|█████████                                | 111/500 [00:25<01:30,  4.32it/s]








 22%|█████████▏                               | 112/500 [00:25<01:29,  4.35it/s]








 23%|█████████▎                               | 113/500 [00:25<01:28,  4.36it/s]








 23%|█████████▎                               | 114/500 [00:25<01:28,  4.38it/s]








 23%|█████████▍                               | 115/500 [00:26<01:27,  4.38it/s]








 23%|█████████▌                               | 116/500 [00:26<01:27,  4.38it/s]








 23%|█████████▌                               | 117/500 [00:26<01:27,  4.37it/s]








 24%|█████████▋                               | 118/500 [00:26<01:27,  4.38it/s]








 24%|█████████▊                               | 119/500 [00:26<01:26,  4.39it/s]








 24%|█████████▊                               | 120/500 [00:27<01:26,  4.40it/s]








 24%|█████████▉                               | 121/500 [00:27<01:26,  4.40it/s]








 24%|██████████                               | 122/500 [00:27<01:25,  4.40it/s]








 25%|██████████                               | 123/500 [00:27<01:25,  4.40it/s]








 25%|██████████▏                              | 124/500 [00:28<01:25,  4.41it/s]








 25%|██████████▎                              | 125/500 [00:28<01:25,  4.40it/s]








 25%|██████████▎                              | 126/500 [00:28<01:24,  4.41it/s]








 25%|██████████▍                              | 127/500 [00:28<01:24,  4.41it/s]








 26%|██████████▍                              | 128/500 [00:28<01:24,  4.42it/s]








 26%|██████████▌                              | 129/500 [00:29<01:23,  4.42it/s]








 26%|██████████▋                              | 130/500 [00:29<01:23,  4.44it/s]








 26%|██████████▋                              | 131/500 [00:29<01:23,  4.43it/s]








 26%|██████████▊                              | 132/500 [00:29<01:22,  4.44it/s]








 27%|██████████▉                              | 133/500 [00:30<01:22,  4.44it/s]








 27%|██████████▉                              | 134/500 [00:30<01:22,  4.44it/s]








 27%|███████████                              | 135/500 [00:30<01:22,  4.44it/s]








 27%|███████████▏                             | 136/500 [00:30<01:21,  4.44it/s]








 27%|███████████▏                             | 137/500 [00:30<01:21,  4.43it/s]








 28%|███████████▎                             | 138/500 [00:31<01:21,  4.44it/s]








 28%|███████████▍                             | 139/500 [00:31<01:21,  4.43it/s]








 28%|███████████▍                             | 140/500 [00:31<01:21,  4.43it/s]








 28%|███████████▌                             | 141/500 [00:31<01:21,  4.41it/s]








 28%|███████████▋                             | 142/500 [00:32<01:21,  4.41it/s]








 29%|███████████▋                             | 143/500 [00:32<01:21,  4.41it/s]








 29%|███████████▊                             | 144/500 [00:32<01:20,  4.42it/s]








 29%|███████████▉                             | 145/500 [00:32<01:20,  4.41it/s]








 29%|███████████▉                             | 146/500 [00:33<01:20,  4.41it/s]








 29%|████████████                             | 147/500 [00:33<01:20,  4.41it/s]








 30%|████████████▏                            | 148/500 [00:33<01:19,  4.41it/s]








 30%|████████████▏                            | 149/500 [00:33<01:19,  4.40it/s]








 30%|████████████▎                            | 150/500 [00:33<01:19,  4.39it/s]








 30%|████████████▍                            | 151/500 [00:34<01:19,  4.38it/s]








 30%|████████████▍                            | 152/500 [00:34<01:19,  4.40it/s]








 31%|████████████▌                            | 153/500 [00:34<01:18,  4.40it/s]








 31%|████████████▋                            | 154/500 [00:34<01:18,  4.40it/s]








 31%|████████████▋                            | 155/500 [00:35<01:18,  4.40it/s]








 31%|████████████▊                            | 156/500 [00:35<01:18,  4.41it/s]








 31%|████████████▊                            | 157/500 [00:35<01:17,  4.40it/s]








 32%|████████████▉                            | 158/500 [00:35<01:17,  4.41it/s]








 32%|█████████████                            | 159/500 [00:35<01:17,  4.43it/s]








 32%|█████████████                            | 160/500 [00:36<01:16,  4.43it/s]








 32%|█████████████▏                           | 161/500 [00:36<01:16,  4.43it/s]








 32%|█████████████▎                           | 162/500 [00:36<01:16,  4.44it/s]








 33%|█████████████▎                           | 163/500 [00:36<01:15,  4.44it/s]








 33%|█████████████▍                           | 164/500 [00:37<01:15,  4.44it/s]








 33%|█████████████▌                           | 165/500 [00:37<01:15,  4.42it/s]








 33%|█████████████▌                           | 166/500 [00:37<01:15,  4.43it/s]








 33%|█████████████▋                           | 167/500 [00:37<01:15,  4.42it/s]








 34%|█████████████▊                           | 168/500 [00:38<01:15,  4.43it/s]








 34%|█████████████▊                           | 169/500 [00:38<01:15,  4.41it/s]








 34%|█████████████▉                           | 170/500 [00:38<01:14,  4.42it/s]








 34%|██████████████                           | 171/500 [00:38<01:14,  4.42it/s]








 34%|██████████████                           | 172/500 [00:38<01:13,  4.44it/s]








 35%|██████████████▏                          | 173/500 [00:39<01:13,  4.44it/s]








 35%|██████████████▎                          | 174/500 [00:39<01:13,  4.45it/s]








 35%|██████████████▎                          | 175/500 [00:39<01:12,  4.45it/s]








 35%|██████████████▍                          | 176/500 [00:39<01:12,  4.45it/s]








 35%|██████████████▌                          | 177/500 [00:40<01:12,  4.44it/s]








 36%|██████████████▌                          | 178/500 [00:40<01:12,  4.43it/s]








 36%|██████████████▋                          | 179/500 [00:40<01:12,  4.43it/s]








 36%|██████████████▊                          | 180/500 [00:40<01:12,  4.44it/s]








 36%|██████████████▊                          | 181/500 [00:40<01:12,  4.42it/s]








 36%|██████████████▉                          | 182/500 [00:41<01:11,  4.42it/s]








 37%|███████████████                          | 183/500 [00:41<01:11,  4.42it/s]








 37%|███████████████                          | 184/500 [00:41<01:11,  4.44it/s]








 37%|███████████████▏                         | 185/500 [00:41<01:11,  4.43it/s]








 37%|███████████████▎                         | 186/500 [00:42<01:10,  4.43it/s]








 37%|███████████████▎                         | 187/500 [00:42<01:11,  4.38it/s]








 38%|███████████████▍                         | 188/500 [00:42<01:11,  4.38it/s]








 38%|███████████████▍                         | 189/500 [00:42<01:11,  4.37it/s]








 38%|███████████████▌                         | 190/500 [00:42<01:10,  4.38it/s]








 38%|███████████████▋                         | 191/500 [00:43<01:10,  4.37it/s]








 38%|███████████████▋                         | 192/500 [00:43<01:10,  4.39it/s]








 39%|███████████████▊                         | 193/500 [00:43<01:10,  4.38it/s]








 39%|███████████████▉                         | 194/500 [00:43<01:09,  4.39it/s]








 39%|███████████████▉                         | 195/500 [00:44<01:09,  4.39it/s]








 39%|████████████████                         | 196/500 [00:44<01:09,  4.40it/s]








 39%|████████████████▏                        | 197/500 [00:44<01:09,  4.36it/s]








 40%|████████████████▏                        | 198/500 [00:44<01:09,  4.32it/s]








 40%|████████████████▎                        | 199/500 [00:45<01:11,  4.20it/s]








 40%|████████████████▍                        | 200/500 [00:45<01:12,  4.14it/s]








 40%|████████████████▍                        | 201/500 [00:45<01:11,  4.17it/s]








 40%|████████████████▌                        | 202/500 [00:45<01:10,  4.25it/s]








 41%|████████████████▋                        | 203/500 [00:46<01:09,  4.29it/s]








 41%|████████████████▋                        | 204/500 [00:46<01:08,  4.34it/s]








 41%|████████████████▊                        | 205/500 [00:46<01:08,  4.32it/s]








 41%|████████████████▉                        | 206/500 [00:46<01:07,  4.36it/s]








 41%|████████████████▉                        | 207/500 [00:46<01:06,  4.37it/s]








 42%|█████████████████                        | 208/500 [00:47<01:06,  4.40it/s]








 42%|█████████████████▏                       | 209/500 [00:47<01:06,  4.40it/s]








 42%|█████████████████▏                       | 210/500 [00:47<01:05,  4.42it/s]








 42%|█████████████████▎                       | 211/500 [00:47<01:05,  4.41it/s]








 42%|█████████████████▍                       | 212/500 [00:48<01:05,  4.43it/s]








 43%|█████████████████▍                       | 213/500 [00:48<01:04,  4.42it/s]








 43%|█████████████████▌                       | 214/500 [00:48<01:04,  4.43it/s]








 43%|█████████████████▋                       | 215/500 [00:48<01:04,  4.42it/s]








 43%|█████████████████▋                       | 216/500 [00:48<01:04,  4.43it/s]








 43%|█████████████████▊                       | 217/500 [00:49<01:03,  4.42it/s]








 44%|█████████████████▉                       | 218/500 [00:49<01:03,  4.45it/s]








 44%|█████████████████▉                       | 219/500 [00:49<01:03,  4.45it/s]








 44%|██████████████████                       | 220/500 [00:49<01:02,  4.46it/s]








 44%|██████████████████                       | 221/500 [00:50<01:02,  4.43it/s]








 44%|██████████████████▏                      | 222/500 [00:50<01:02,  4.45it/s]








 45%|██████████████████▎                      | 223/500 [00:50<01:02,  4.44it/s]








 45%|██████████████████▎                      | 224/500 [00:50<01:02,  4.44it/s]








 45%|██████████████████▍                      | 225/500 [00:50<01:02,  4.43it/s]








 45%|██████████████████▌                      | 226/500 [00:51<01:01,  4.46it/s]








 45%|██████████████████▌                      | 227/500 [00:51<01:01,  4.45it/s]








 46%|██████████████████▋                      | 228/500 [00:51<01:01,  4.46it/s]








 46%|██████████████████▊                      | 229/500 [00:51<01:01,  4.43it/s]








 46%|██████████████████▊                      | 230/500 [00:52<01:00,  4.43it/s]








 46%|██████████████████▉                      | 231/500 [00:52<01:01,  4.41it/s]








 46%|███████████████████                      | 232/500 [00:52<01:00,  4.42it/s]








 47%|███████████████████                      | 233/500 [00:52<01:00,  4.40it/s]








 47%|███████████████████▏                     | 234/500 [00:53<01:00,  4.40it/s]








 47%|███████████████████▎                     | 235/500 [00:53<01:00,  4.38it/s]








 47%|███████████████████▎                     | 236/500 [00:53<00:59,  4.40it/s]








 47%|███████████████████▍                     | 237/500 [00:53<00:59,  4.40it/s]








 48%|███████████████████▌                     | 238/500 [00:53<00:59,  4.41it/s]








 48%|███████████████████▌                     | 239/500 [00:54<00:59,  4.39it/s]








 48%|███████████████████▋                     | 240/500 [00:54<00:59,  4.40it/s]['zipper', 0.9711134453781513, 0.9870345126791479, 0.9549725048986681]
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/colors.py:101: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  ret = np.asscalar(ex)
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:425: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_min = np.asscalar(a_min.astype(scaled_dtype))
/opt/conda/envs/python35-paddle120-env/lib/python3.7/site-packages/matplotlib/image.py:426: DeprecationWarning: np.asscalar(a) is deprecated since NumPy v1.16, use a.item() instead
  a_max = np.asscalar(a_max.astype(scaled_dtype))
Evaluation result saved at./output/coreset_resnet18_10/objects_seed521.csv:
            Image_AUROC  Pixel_AUROC  PRO_score
category                                       
bottle         1.000000     0.981400   0.945257
cable          0.977699     0.984428   0.941403
capsule        0.979657     0.989979   0.942688
hazelnut       1.000000     0.988504   0.936284
metal_nut      0.993157     0.985884   0.938088
pill           0.938352     0.975950   0.927670
screw          0.938512     0.993937   0.971481
toothbrush     0.936111     0.990976   0.917974
transistor     0.990417     0.955586   0.915834
zipper         0.971113     0.987035   0.954973
===== Category OBJECTS Mean Performance ====
Image_AUROC    0.972502
Pixel_AUROC    0.983368
PRO_score      0.939165
dtype: float64